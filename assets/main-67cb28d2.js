var Xs=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Yr=(n,e,t)=>(Xs(n,e,"read from private field"),t?t.call(n):e.get(n)),ai=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Tn=(n,e,t,r)=>(Xs(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const to=globalThis,bs=to.ShadowRoot&&(to.ShadyCSS===void 0||to.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,vs=Symbol(),Qs=new WeakMap;let oc=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==vs)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(bs&&e===void 0){const r=t!==void 0&&t.length===1;r&&(e=Qs.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Qs.set(t,e))}return e}toString(){return this.cssText}};const oe=n=>new oc(typeof n=="string"?n:n+"",void 0,vs),be=(n,...e)=>{const t=n.length===1?n[0]:e.reduce((r,o,i)=>r+(s=>{if(s._$cssResult$===!0)return s.cssText;if(typeof s=="number")return s;throw Error("Value passed to 'css' function must be a 'css' function result: "+s+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+n[i+1],n[0]);return new oc(t,n,vs)},kd=(n,e)=>{if(bs)n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const r=document.createElement("style"),o=to.litNonce;o!==void 0&&r.setAttribute("nonce",o),r.textContent=t.cssText,n.appendChild(r)}},ea=bs?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return oe(t)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Ed,defineProperty:Md,getOwnPropertyDescriptor:Td,getOwnPropertyNames:Sd,getOwnPropertySymbols:Fd,getPrototypeOf:Pd}=Object,Nt=globalThis,ta=Nt.trustedTypes,Ad=ta?ta.emptyScript:"",li=Nt.reactiveElementPolyfillSupport,yr=(n,e)=>n,so={toAttribute(n,e){switch(e){case Boolean:n=n?Ad:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},Ds=(n,e)=>!Ed(n,e),na={attribute:!0,type:String,converter:so,reflect:!1,hasChanged:Ds};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Nt.litPropertyMetadata??(Nt.litPropertyMetadata=new WeakMap);class On extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=na){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),o=this.getPropertyDescriptor(e,r,t);o!==void 0&&Md(this.prototype,e,o)}}static getPropertyDescriptor(e,t,r){const{get:o,set:i}=Td(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return o==null?void 0:o.call(this)},set(s){const a=o==null?void 0:o.call(this);i.call(this,s),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??na}static _$Ei(){if(this.hasOwnProperty(yr("elementProperties")))return;const e=Pd(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(yr("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(yr("properties"))){const t=this.properties,r=[...Sd(t),...Fd(t)];for(const o of r)this.createProperty(o,t[o])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[r,o]of t)this.elementProperties.set(r,o)}this._$Eh=new Map;for(const[t,r]of this.elementProperties){const o=this._$Eu(t,r);o!==void 0&&this._$Eh.set(o,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const o of r)t.unshift(ea(o))}else e!==void 0&&t.push(ea(e));return t}static _$Eu(e,t){const r=t.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$Eg=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$ES??(this._$ES=[])).push(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$ES)==null||t.splice(this._$ES.indexOf(e)>>>0,1)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return kd(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)==null||e.forEach(t=>{var r;return(r=t.hostConnected)==null?void 0:r.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)==null||e.forEach(t=>{var r;return(r=t.hostDisconnected)==null?void 0:r.call(t)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$EO(e,t){var i;const r=this.constructor.elementProperties.get(e),o=this.constructor._$Eu(e,r);if(o!==void 0&&r.reflect===!0){const s=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:so).toAttribute(t,r.type);this._$Em=e,s==null?this.removeAttribute(o):this.setAttribute(o,s),this._$Em=null}}_$AK(e,t){var i;const r=this.constructor,o=r._$Eh.get(e);if(o!==void 0&&this._$Em!==o){const s=r.getPropertyOptions(o),a=typeof s.converter=="function"?{fromAttribute:s.converter}:((i=s.converter)==null?void 0:i.fromAttribute)!==void 0?s.converter:so;this._$Em=o,this[o]=a.fromAttribute(t,s.type),this._$Em=null}}requestUpdate(e,t,r,o=!1,i){if(e!==void 0){if(r??(r=this.constructor.getPropertyOptions(e)),!(r.hasChanged??Ds)(o?i:this[e],t))return;this.C(e,t,r)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(e,t,r){this._$AL.has(e)||this._$AL.set(e,t),r.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this._$Ep){for(const[i,s]of this._$Ep)this[i]=s;this._$Ep=void 0}const o=this.constructor.elementProperties;if(o.size>0)for(const[i,s]of o)s.wrapped!==!0||this._$AL.has(i)||this[i]===void 0||this.C(i,this[i],s)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(r=this._$ES)==null||r.forEach(o=>{var i;return(i=o.hostUpdate)==null?void 0:i.call(o)}),this.update(t)):this._$ET()}catch(o){throw e=!1,this._$ET(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$ES)==null||t.forEach(r=>{var o;return(o=r.hostUpdated)==null?void 0:o.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EO(t,this[t]))),this._$ET()}updated(e){}firstUpdated(e){}}On.elementStyles=[],On.shadowRootOptions={mode:"open"},On[yr("elementProperties")]=new Map,On[yr("finalized")]=new Map,li==null||li({ReactiveElement:On}),(Nt.reactiveElementVersions??(Nt.reactiveElementVersions=[])).push("2.0.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const br=globalThis,ao=br.trustedTypes,ra=ao?ao.createPolicy("lit-html",{createHTML:n=>n}):void 0,ic="$lit$",Pt=`lit$${(Math.random()+"").slice(9)}$`,sc="?"+Pt,Od=`<${sc}>`,fn=document,Cr=()=>fn.createComment(""),kr=n=>n===null||typeof n!="object"&&typeof n!="function",ac=Array.isArray,Id=n=>ac(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",ci=`[ 	
\f\r]`,sr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,oa=/-->/g,ia=/>/g,en=RegExp(`>|${ci}(?:([^\\s"'>=/]+)(${ci}*=${ci}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),sa=/'/g,aa=/"/g,lc=/^(?:script|style|textarea|title)$/i,$d=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),M=$d(1),Ht=Symbol.for("lit-noChange"),ne=Symbol.for("lit-nothing"),la=new WeakMap,nn=fn.createTreeWalker(fn,129);function cc(n,e){if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return ra!==void 0?ra.createHTML(e):e}const Nd=(n,e)=>{const t=n.length-1,r=[];let o,i=e===2?"<svg>":"",s=sr;for(let a=0;a<t;a++){const l=n[a];let c,u,d=-1,p=0;for(;p<l.length&&(s.lastIndex=p,u=s.exec(l),u!==null);)p=s.lastIndex,s===sr?u[1]==="!--"?s=oa:u[1]!==void 0?s=ia:u[2]!==void 0?(lc.test(u[2])&&(o=RegExp("</"+u[2],"g")),s=en):u[3]!==void 0&&(s=en):s===en?u[0]===">"?(s=o??sr,d=-1):u[1]===void 0?d=-2:(d=s.lastIndex-u[2].length,c=u[1],s=u[3]===void 0?en:u[3]==='"'?aa:sa):s===aa||s===sa?s=en:s===oa||s===ia?s=sr:(s=en,o=void 0);const h=s===en&&n[a+1].startsWith("/>")?" ":"";i+=s===sr?l+Od:d>=0?(r.push(c),l.slice(0,d)+ic+l.slice(d)+Pt+h):l+Pt+(d===-2?a:h)}return[cc(n,i+(n[t]||"<?>")+(e===2?"</svg>":"")),r]};class Er{constructor({strings:e,_$litType$:t},r){let o;this.parts=[];let i=0,s=0;const a=e.length-1,l=this.parts,[c,u]=Nd(e,t);if(this.el=Er.createElement(c,r),nn.currentNode=this.el.content,t===2){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(o=nn.nextNode())!==null&&l.length<a;){if(o.nodeType===1){if(o.hasAttributes())for(const d of o.getAttributeNames())if(d.endsWith(ic)){const p=u[s++],h=o.getAttribute(d).split(Pt),f=/([.?@])?(.*)/.exec(p);l.push({type:1,index:i,name:f[2],strings:h,ctor:f[1]==="."?Rd:f[1]==="?"?Bd:f[1]==="@"?_d:No}),o.removeAttribute(d)}else d.startsWith(Pt)&&(l.push({type:6,index:i}),o.removeAttribute(d));if(lc.test(o.tagName)){const d=o.textContent.split(Pt),p=d.length-1;if(p>0){o.textContent=ao?ao.emptyScript:"";for(let h=0;h<p;h++)o.append(d[h],Cr()),nn.nextNode(),l.push({type:2,index:++i});o.append(d[p],Cr())}}}else if(o.nodeType===8)if(o.data===sc)l.push({type:2,index:i});else{let d=-1;for(;(d=o.data.indexOf(Pt,d+1))!==-1;)l.push({type:7,index:i}),d+=Pt.length-1}i++}}static createElement(e,t){const r=fn.createElement("template");return r.innerHTML=e,r}}function Vn(n,e,t=n,r){var s,a;if(e===Ht)return e;let o=r!==void 0?(s=t._$Co)==null?void 0:s[r]:t._$Cl;const i=kr(e)?void 0:e._$litDirective$;return(o==null?void 0:o.constructor)!==i&&((a=o==null?void 0:o._$AO)==null||a.call(o,!1),i===void 0?o=void 0:(o=new i(n),o._$AT(n,t,r)),r!==void 0?(t._$Co??(t._$Co=[]))[r]=o:t._$Cl=o),o!==void 0&&(e=Vn(n,o._$AS(n,e.values),o,r)),e}class Ld{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,o=((e==null?void 0:e.creationScope)??fn).importNode(t,!0);nn.currentNode=o;let i=nn.nextNode(),s=0,a=0,l=r[0];for(;l!==void 0;){if(s===l.index){let c;l.type===2?c=new Rr(i,i.nextSibling,this,e):l.type===1?c=new l.ctor(i,l.name,l.strings,this,e):l.type===6&&(c=new zd(i,this,e)),this._$AV.push(c),l=r[++a]}s!==(l==null?void 0:l.index)&&(i=nn.nextNode(),s++)}return nn.currentNode=fn,o}p(e){let t=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class Rr{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,r,o){this.type=2,this._$AH=ne,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=o,this._$Cv=(o==null?void 0:o.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Vn(this,e,t),kr(e)?e===ne||e==null||e===""?(this._$AH!==ne&&this._$AR(),this._$AH=ne):e!==this._$AH&&e!==Ht&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):Id(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==ne&&kr(this._$AH)?this._$AA.nextSibling.data=e:this.$(fn.createTextNode(e)),this._$AH=e}g(e){var i;const{values:t,_$litType$:r}=e,o=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=Er.createElement(cc(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===o)this._$AH.p(t);else{const s=new Ld(o,this),a=s.u(this.options);s.p(t),this.$(a),this._$AH=s}}_$AC(e){let t=la.get(e.strings);return t===void 0&&la.set(e.strings,t=new Er(e)),t}T(e){ac(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,o=0;for(const i of e)o===t.length?t.push(r=new Rr(this.k(Cr()),this.k(Cr()),this,this.options)):r=t[o],r._$AI(i),o++;o<t.length&&(this._$AR(r&&r._$AB.nextSibling,o),t.length=o)}_$AR(e=this._$AA.nextSibling,t){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,t);e&&e!==this._$AB;){const o=e.nextSibling;e.remove(),e=o}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class No{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,o,i){this.type=1,this._$AH=ne,this._$AN=void 0,this.element=e,this.name=t,this._$AM=o,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=ne}_$AI(e,t=this,r,o){const i=this.strings;let s=!1;if(i===void 0)e=Vn(this,e,t,0),s=!kr(e)||e!==this._$AH&&e!==Ht,s&&(this._$AH=e);else{const a=e;let l,c;for(e=i[0],l=0;l<i.length-1;l++)c=Vn(this,a[r+l],t,l),c===Ht&&(c=this._$AH[l]),s||(s=!kr(c)||c!==this._$AH[l]),c===ne?e=ne:e!==ne&&(e+=(c??"")+i[l+1]),this._$AH[l]=c}s&&!o&&this.j(e)}j(e){e===ne?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Rd extends No{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ne?void 0:e}}class Bd extends No{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==ne)}}class _d extends No{constructor(e,t,r,o,i){super(e,t,r,o,i),this.type=5}_$AI(e,t=this){if((e=Vn(this,e,t,0)??ne)===Ht)return;const r=this._$AH,o=e===ne&&r!==ne||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==ne&&(r===ne||o);o&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class zd{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Vn(this,e)}}const ui=br.litHtmlPolyfillSupport;ui==null||ui(Er,Rr),(br.litHtmlVersions??(br.litHtmlVersions=[])).push("3.0.0");const Hd=(n,e,t)=>{const r=(t==null?void 0:t.renderBefore)??e;let o=r._$litPart$;if(o===void 0){const i=(t==null?void 0:t.renderBefore)??null;r._$litPart$=o=new Rr(e.insertBefore(Cr(),i),i,void 0,t??{})}return o._$AI(n),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class Q extends On{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Hd(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Ht}}var rc;Q._$litElement$=!0,Q.finalized=!0,(rc=globalThis.litElementHydrateSupport)==null||rc.call(globalThis,{LitElement:Q});const di=globalThis.litElementPolyfillSupport;di==null||di({LitElement:Q});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ve=n=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(n,e)}):customElements.define(n,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const jd={attribute:!0,type:String,converter:so,reflect:!1,hasChanged:Ds},Ud=(n=jd,e,t)=>{const{kind:r,metadata:o}=t;let i=globalThis.litPropertyMetadata.get(o);if(i===void 0&&globalThis.litPropertyMetadata.set(o,i=new Map),i.set(t.name,n),r==="accessor"){const{name:s}=t;return{set(a){const l=e.get.call(this);e.set.call(this,a),this.requestUpdate(s,l,n)},init(a){return a!==void 0&&this.C(s,void 0,n),a}}}if(r==="setter"){const{name:s}=t;return function(a){const l=this[s];e.call(this,a),this.requestUpdate(s,l,n)}}throw Error("Unsupported decorator location: "+r)};function O(n){return(e,t)=>typeof t=="object"?Ud(n,e,t):((r,o,i)=>{const s=o.hasOwnProperty(i);return o.constructor.createProperty(i,s?{...r,wrapped:!0}:r),s?Object.getOwnPropertyDescriptor(o,i):void 0})(n,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function I(n){return O({...n,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Gi=(n,e,t)=>(t.configurable=!0,t.enumerable=!0,Reflect.decorate&&typeof e!="object"&&Object.defineProperty(n,e,t),t);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Y(n,e){return(t,r,o)=>{const i=s=>{var a;return((a=s.renderRoot)==null?void 0:a.querySelector(n))??null};if(e){const{get:s,set:a}=typeof r=="object"?t:o??(()=>{const l=Symbol();return{get(){return this[l]},set(c){this[l]=c}}})();return Gi(t,r,{get(){if(e){let l=s.call(this);return l===void 0&&(l=i(this),a.call(this,l)),l}return i(this)}})}return Gi(t,r,{get(){return i(this)}})}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Lo(n){return(e,t)=>Gi(e,t,{async get(){var r;return await this.updateComplete,((r=this.renderRoot)==null?void 0:r.querySelector(n))??null}})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const uc={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},dc=n=>(...e)=>({_$litDirective$:n,values:e});let pc=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,r){this._$Ct=e,this._$AM=t,this._$Ci=r}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class Wi extends pc{constructor(e){if(super(e),this.et=ne,e.type!==uc.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===ne||e==null)return this.vt=void 0,this.et=e;if(e===Ht)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.et)return this.vt;this.et=e;const t=[e];return t.raw=t,this.vt={_$litType$:this.constructor.resultType,strings:t,values:[]}}}Wi.directiveName="unsafeHTML",Wi.resultType=1;const H=dc(Wi);let Kr;const Vd=new Uint8Array(16);function Gd(){if(!Kr&&(Kr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Kr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Kr(Vd)}const fe=[];for(let n=0;n<256;++n)fe.push((n+256).toString(16).slice(1));function Wd(n,e=0){return fe[n[e+0]]+fe[n[e+1]]+fe[n[e+2]]+fe[n[e+3]]+"-"+fe[n[e+4]]+fe[n[e+5]]+"-"+fe[n[e+6]]+fe[n[e+7]]+"-"+fe[n[e+8]]+fe[n[e+9]]+"-"+fe[n[e+10]]+fe[n[e+11]]+fe[n[e+12]]+fe[n[e+13]]+fe[n[e+14]]+fe[n[e+15]]}const Yd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ca={randomUUID:Yd};function mn(n,e,t){if(ca.randomUUID&&!e&&!n)return ca.randomUUID();n=n||{};const r=n.random||(n.rng||Gd)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let o=0;o<16;++o)e[t+o]=r[o];return e}return Wd(r)}const Kd={sidebarMenuXOffset:12},qd={mouseenterDelay:300},Jd={addedColor:"hsl(120, 37%, 88%)",replacedColor:"hsl(35, 100%, 89%)",deletedColor:"hsl(353, 100%, 93%)"},Zd={wordflowEndpoint:"https://62uqq9jku8.execute-api.us-east-1.amazonaws.com/prod/records"},Xd={"red-50":"hsl(350, 100.0%, 96.08%)","red-100":"hsl(354, 100.0%, 90.2%)","red-200":"hsl(0, 72.65%, 77.06%)","red-300":"hsl(0, 68.67%, 67.45%)","red-400":"hsl(1, 83.25%, 62.55%)","red-500":"hsl(4, 89.62%, 58.43%)","red-600":"hsl(1, 77.19%, 55.29%)","red-700":"hsl(0, 65.08%, 50.59%)","red-800":"hsl(0, 66.39%, 46.67%)","red-900":"hsl(0, 73.46%, 41.37%)","red-a100":"hsl(4, 100.0%, 75.1%)","red-a200":"hsl(0, 100.0%, 66.08%)","red-a400":"hsl(348, 100.0%, 54.51%)","red-a700":"hsl(0, 100.0%, 41.76%)","pink-50":"hsl(340, 80.0%, 94.12%)","pink-100":"hsl(339, 81.33%, 85.29%)","pink-200":"hsl(339, 82.11%, 75.88%)","pink-300":"hsl(339, 82.56%, 66.27%)","pink-400":"hsl(339, 81.9%, 58.82%)","pink-500":"hsl(339, 82.19%, 51.57%)","pink-600":"hsl(338, 77.78%, 47.65%)","pink-700":"hsl(336, 77.98%, 42.75%)","pink-800":"hsl(333, 79.27%, 37.84%)","pink-900":"hsl(328, 81.33%, 29.41%)","pink-a100":"hsl(339, 100.0%, 75.1%)","pink-a200":"hsl(339, 100.0%, 62.55%)","pink-a400":"hsl(338, 100.0%, 48.04%)","pink-a700":"hsl(333, 84.11%, 41.96%)","purple-50":"hsl(292, 44.44%, 92.94%)","purple-100":"hsl(291, 46.07%, 82.55%)","purple-200":"hsl(291, 46.94%, 71.18%)","purple-300":"hsl(291, 46.6%, 59.61%)","purple-400":"hsl(291, 46.61%, 50.78%)","purple-500":"hsl(291, 63.72%, 42.16%)","purple-600":"hsl(287, 65.05%, 40.39%)","purple-700":"hsl(282, 67.88%, 37.84%)","purple-800":"hsl(277, 70.17%, 35.49%)","purple-900":"hsl(267, 75.0%, 31.37%)","purple-a100":"hsl(291, 95.38%, 74.51%)","purple-a200":"hsl(291, 95.9%, 61.76%)","purple-a400":"hsl(291, 100.0%, 48.82%)","purple-a700":"hsl(280, 100.0%, 50.0%)","deep-purple-50":"hsl(264, 45.45%, 93.53%)","deep-purple-100":"hsl(261, 45.68%, 84.12%)","deep-purple-200":"hsl(261, 46.27%, 73.73%)","deep-purple-300":"hsl(261, 46.81%, 63.14%)","deep-purple-400":"hsl(261, 46.72%, 55.1%)","deep-purple-500":"hsl(261, 51.87%, 47.25%)","deep-purple-600":"hsl(259, 53.91%, 45.1%)","deep-purple-700":"hsl(257, 57.75%, 41.76%)","deep-purple-800":"hsl(254, 60.8%, 39.02%)","deep-purple-900":"hsl(251, 68.79%, 33.92%)","deep-purple-a100":"hsl(261, 100.0%, 76.67%)","deep-purple-a200":"hsl(255, 100.0%, 65.1%)","deep-purple-a400":"hsl(258, 100.0%, 56.08%)","deep-purple-a700":"hsl(265, 100.0%, 45.88%)","indigo-50":"hsl(231, 43.75%, 93.73%)","indigo-100":"hsl(231, 45.0%, 84.31%)","indigo-200":"hsl(230, 44.36%, 73.92%)","indigo-300":"hsl(230, 44.09%, 63.53%)","indigo-400":"hsl(230, 44.25%, 55.69%)","indigo-500":"hsl(230, 48.36%, 47.84%)","indigo-600":"hsl(231, 50.0%, 44.71%)","indigo-700":"hsl(231, 53.62%, 40.59%)","indigo-800":"hsl(232, 57.22%, 36.67%)","indigo-900":"hsl(234, 65.79%, 29.8%)","indigo-a100":"hsl(230, 100.0%, 77.45%)","indigo-a200":"hsl(230, 98.84%, 66.08%)","indigo-a400":"hsl(230, 98.97%, 61.76%)","indigo-a700":"hsl(230, 99.04%, 59.22%)","blue-50":"hsl(205, 86.67%, 94.12%)","blue-100":"hsl(207, 88.89%, 85.88%)","blue-200":"hsl(206, 89.74%, 77.06%)","blue-300":"hsl(206, 89.02%, 67.84%)","blue-400":"hsl(206, 89.95%, 60.98%)","blue-500":"hsl(206, 89.74%, 54.12%)","blue-600":"hsl(208, 79.28%, 50.78%)","blue-700":"hsl(209, 78.72%, 46.08%)","blue-800":"hsl(211, 80.28%, 41.76%)","blue-900":"hsl(216, 85.06%, 34.12%)","blue-a100":"hsl(217, 100.0%, 75.49%)","blue-a200":"hsl(217, 100.0%, 63.33%)","blue-a400":"hsl(217, 100.0%, 58.04%)","blue-a700":"hsl(224, 100.0%, 58.04%)","light-blue-50":"hsl(198, 93.55%, 93.92%)","light-blue-100":"hsl(198, 92.41%, 84.51%)","light-blue-200":"hsl(198, 92.37%, 74.31%)","light-blue-300":"hsl(198, 91.3%, 63.92%)","light-blue-400":"hsl(198, 91.93%, 56.27%)","light-blue-500":"hsl(198, 97.57%, 48.43%)","light-blue-600":"hsl(199, 97.41%, 45.49%)","light-blue-700":"hsl(201, 98.1%, 41.37%)","light-blue-800":"hsl(202, 97.91%, 37.45%)","light-blue-900":"hsl(206, 98.72%, 30.59%)","light-blue-a100":"hsl(198, 100.0%, 75.1%)","light-blue-a200":"hsl(198, 100.0%, 62.55%)","light-blue-a400":"hsl(198, 100.0%, 50.0%)","light-blue-a700":"hsl(202, 100.0%, 45.88%)","cyan-50":"hsl(186, 72.22%, 92.94%)","cyan-100":"hsl(186, 71.11%, 82.35%)","cyan-200":"hsl(186, 71.62%, 70.98%)","cyan-300":"hsl(186, 71.15%, 59.22%)","cyan-400":"hsl(186, 70.87%, 50.2%)","cyan-500":"hsl(186, 100.0%, 41.57%)","cyan-600":"hsl(186, 100.0%, 37.84%)","cyan-700":"hsl(185, 100.0%, 32.75%)","cyan-800":"hsl(185, 100.0%, 28.04%)","cyan-900":"hsl(182, 100.0%, 19.61%)","cyan-a100":"hsl(180, 100.0%, 75.88%)","cyan-a200":"hsl(180, 100.0%, 54.71%)","cyan-a400":"hsl(186, 100.0%, 50.0%)","cyan-a700":"hsl(187, 100.0%, 41.57%)","teal-50":"hsl(176, 40.91%, 91.37%)","teal-100":"hsl(174, 41.28%, 78.63%)","teal-200":"hsl(174, 41.9%, 64.9%)","teal-300":"hsl(174, 41.83%, 50.78%)","teal-400":"hsl(174, 62.75%, 40.0%)","teal-500":"hsl(174, 100.0%, 29.41%)","teal-600":"hsl(173, 100.0%, 26.86%)","teal-700":"hsl(173, 100.0%, 23.73%)","teal-800":"hsl(172, 100.0%, 20.59%)","teal-900":"hsl(169, 100.0%, 15.1%)","teal-a100":"hsl(166, 100.0%, 82.75%)","teal-a200":"hsl(165, 100.0%, 69.61%)","teal-a400":"hsl(165, 82.26%, 51.37%)","teal-a700":"hsl(171, 100.0%, 37.45%)","green-50":"hsl(124, 39.39%, 93.53%)","green-100":"hsl(121, 37.5%, 84.31%)","green-200":"hsl(122, 37.4%, 74.31%)","green-300":"hsl(122, 38.46%, 64.31%)","green-400":"hsl(122, 38.46%, 56.67%)","green-500":"hsl(122, 39.44%, 49.22%)","green-600":"hsl(122, 40.97%, 44.51%)","green-700":"hsl(122, 43.43%, 38.82%)","green-800":"hsl(123, 46.2%, 33.53%)","green-900":"hsl(124, 55.37%, 23.73%)","green-a100":"hsl(136, 77.22%, 84.51%)","green-a200":"hsl(150, 81.82%, 67.65%)","green-a400":"hsl(150, 100.0%, 45.1%)","green-a700":"hsl(144, 100.0%, 39.22%)","light-green-50":"hsl(88, 51.72%, 94.31%)","light-green-100":"hsl(87, 50.68%, 85.69%)","light-green-200":"hsl(88, 50.0%, 76.47%)","light-green-300":"hsl(87, 50.0%, 67.06%)","light-green-400":"hsl(87, 50.24%, 59.8%)","light-green-500":"hsl(87, 50.21%, 52.75%)","light-green-600":"hsl(89, 46.12%, 48.04%)","light-green-700":"hsl(92, 47.91%, 42.16%)","light-green-800":"hsl(95, 49.46%, 36.47%)","light-green-900":"hsl(103, 55.56%, 26.47%)","light-green-a100":"hsl(87, 100.0%, 78.24%)","light-green-a200":"hsl(87, 100.0%, 67.45%)","light-green-a400":"hsl(92, 100.0%, 50.59%)","light-green-a700":"hsl(96, 81.15%, 47.84%)","lime-50":"hsl(65, 71.43%, 94.51%)","lime-100":"hsl(64, 69.01%, 86.08%)","lime-200":"hsl(65, 70.69%, 77.25%)","lime-300":"hsl(65, 70.37%, 68.24%)","lime-400":"hsl(65, 69.7%, 61.18%)","lime-500":"hsl(65, 69.96%, 54.31%)","lime-600":"hsl(63, 59.68%, 49.61%)","lime-700":"hsl(62, 61.43%, 43.73%)","lime-800":"hsl(59, 62.89%, 38.04%)","lime-900":"hsl(53, 69.93%, 30.0%)","lime-a100":"hsl(65, 100.0%, 75.29%)","lime-a200":"hsl(65, 100.0%, 62.75%)","lime-a400":"hsl(73, 100.0%, 50.0%)","lime-a700":"hsl(75, 100.0%, 45.88%)","yellow-50":"hsl(55, 100.0%, 95.29%)","yellow-100":"hsl(53, 100.0%, 88.43%)","yellow-200":"hsl(53, 100.0%, 80.78%)","yellow-300":"hsl(53, 100.0%, 73.14%)","yellow-400":"hsl(53, 100.0%, 67.25%)","yellow-500":"hsl(53, 100.0%, 61.57%)","yellow-600":"hsl(48, 98.04%, 60.0%)","yellow-700":"hsl(42, 96.26%, 58.04%)","yellow-800":"hsl(37, 94.64%, 56.08%)","yellow-900":"hsl(28, 91.74%, 52.55%)","yellow-a100":"hsl(60, 100.0%, 77.65%)","yellow-a200":"hsl(60, 100.0%, 50.0%)","yellow-a400":"hsl(55, 100.0%, 50.0%)","yellow-a700":"hsl(50, 100.0%, 50.0%)","amber-50":"hsl(46, 100.0%, 94.12%)","amber-100":"hsl(45, 100.0%, 85.1%)","amber-200":"hsl(45, 100.0%, 75.49%)","amber-300":"hsl(45, 100.0%, 65.49%)","amber-400":"hsl(45, 100.0%, 57.84%)","amber-500":"hsl(45, 100.0%, 51.37%)","amber-600":"hsl(42, 100.0%, 50.0%)","amber-700":"hsl(37, 100.0%, 50.0%)","amber-800":"hsl(33, 100.0%, 50.0%)","amber-900":"hsl(26, 100.0%, 50.0%)","amber-a100":"hsl(47, 100.0%, 74.9%)","amber-a200":"hsl(47, 100.0%, 62.55%)","amber-a400":"hsl(46, 100.0%, 50.0%)","amber-a700":"hsl(40, 100.0%, 50.0%)","orange-50":"hsl(36, 100.0%, 93.92%)","orange-100":"hsl(35, 100.0%, 84.9%)","orange-200":"hsl(35, 100.0%, 75.1%)","orange-300":"hsl(35, 100.0%, 65.1%)","orange-400":"hsl(35, 100.0%, 57.45%)","orange-500":"hsl(35, 100.0%, 50.0%)","orange-600":"hsl(33, 100.0%, 49.22%)","orange-700":"hsl(30, 100.0%, 48.04%)","orange-800":"hsl(27, 100.0%, 46.86%)","orange-900":"hsl(21, 100.0%, 45.1%)","orange-a100":"hsl(38, 100.0%, 75.1%)","orange-a200":"hsl(33, 100.0%, 62.55%)","orange-a400":"hsl(34, 100.0%, 50.0%)","orange-a700":"hsl(25, 100.0%, 50.0%)","deep-orange-50":"hsl(5, 71.43%, 94.51%)","deep-orange-100":"hsl(14, 100.0%, 86.86%)","deep-orange-200":"hsl(14, 100.0%, 78.43%)","deep-orange-300":"hsl(14, 100.0%, 69.8%)","deep-orange-400":"hsl(14, 100.0%, 63.14%)","deep-orange-500":"hsl(14, 100.0%, 56.67%)","deep-orange-600":"hsl(14, 90.68%, 53.73%)","deep-orange-700":"hsl(14, 80.39%, 50.0%)","deep-orange-800":"hsl(14, 82.28%, 46.47%)","deep-orange-900":"hsl(14, 88.18%, 39.8%)","deep-orange-a100":"hsl(14, 100.0%, 75.1%)","deep-orange-a200":"hsl(14, 100.0%, 62.55%)","deep-orange-a400":"hsl(14, 100.0%, 50.0%)","deep-orange-a700":"hsl(11, 100.0%, 43.33%)","brown-50":"hsl(19, 15.79%, 92.55%)","brown-100":"hsl(16, 15.79%, 81.37%)","brown-200":"hsl(14, 15.19%, 69.02%)","brown-300":"hsl(15, 15.32%, 56.47%)","brown-400":"hsl(15, 17.5%, 47.06%)","brown-500":"hsl(15, 25.39%, 37.84%)","brown-600":"hsl(15, 25.29%, 34.12%)","brown-700":"hsl(14, 25.68%, 29.02%)","brown-800":"hsl(11, 25.81%, 24.31%)","brown-900":"hsl(8, 27.84%, 19.02%)","gray-50":"hsl(0, 0.0%, 98.04%)","gray-100":"hsl(0, 0.0%, 96.08%)","gray-200":"hsl(0, 0.0%, 93.33%)","gray-300":"hsl(0, 0.0%, 87.84%)","gray-400":"hsl(0, 0.0%, 74.12%)","gray-500":"hsl(0, 0.0%, 61.96%)","gray-600":"hsl(0, 0.0%, 45.88%)","gray-700":"hsl(0, 0.0%, 38.04%)","gray-800":"hsl(0, 0.0%, 25.88%)","gray-900":"hsl(0, 0.0%, 12.94%)","blue-gray-50":"hsl(204, 15.15%, 93.53%)","blue-gray-100":"hsl(198, 15.66%, 83.73%)","blue-gray-200":"hsl(199, 15.33%, 73.14%)","blue-gray-300":"hsl(199, 15.63%, 62.35%)","blue-gray-400":"hsl(200, 15.38%, 54.12%)","blue-gray-500":"hsl(199, 18.3%, 46.08%)","blue-gray-600":"hsl(198, 18.45%, 40.39%)","blue-gray-700":"hsl(199, 18.34%, 33.14%)","blue-gray-800":"hsl(199, 17.91%, 26.27%)","blue-gray-900":"hsl(199, 19.15%, 18.43%)","blue-gray-1000":"hsl(199, 20.93%, 8.43%)"},Ue={debug:!0,colors:Xd,layout:Kd,time:qd,customColors:Jd,urls:Zd};function Br(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function Qd(n,e){const t=indexedDB.open(n);t.onupgradeneeded=()=>t.result.createObjectStore(e);const r=Br(t);return(o,i)=>r.then(s=>i(s.transaction(e,o).objectStore(e)))}let pi;function Ro(){return pi||(pi=Qd("keyval-store","keyval")),pi}function no(n,e=Ro()){return e("readonly",t=>Br(t.get(n)))}function nt(n,e,t=Ro()){return t("readwrite",r=>(r.put(e,n),Br(r.transaction)))}function hc(n,e=Ro()){return e("readwrite",t=>(t.delete(n),Br(t.transaction)))}function ep(n=Ro()){return n("readwrite",e=>(e.clear(),Br(e.transaction)))}const Re="local-prompt";class tp{constructor(e,t){this.localPrompts=[],this.localPromptsProjection=null,this.localPromptCount=0,this.localPromptBroadcastCount=0,this.favPrompts=[null,null,null],this.promptKeys=[],this.favPromptKeys=[null,null,null],this.localPromptsUpdateCallback=e,this.localPromptsUpdateCallback(structuredClone(this.localPrompts)),this.favPromptsUpdateCallback=t,this.favPromptsUpdateCallback(structuredClone(this.favPrompts)),this.restoreFinished=this.restoreFromStorage().then(()=>{this.sortPrompts("created")})}async restoreFromStorage(){const e=await no(`${Re}-keys`);if(e!==void 0){this.promptKeys=[],this.localPrompts=[],this.promptKeys=e;for(const r of this.promptKeys){const o=await no(`${Re}-${r}`);if(o===void 0)throw Error(`Can't access prompt with key ${r}`);this.localPrompts.push(o)}}const t=await no(`${Re}-fav-keys`);if(t!==void 0){this.favPromptKeys=t,this.favPrompts=[null,null,null];for(const[r,o]of this.favPromptKeys.slice(0,3).entries())if(o!==null){const i=this.promptKeys.indexOf(o);this.favPrompts[r]=this.localPrompts[i]}}this._broadcastLocalPrompts(),this._broadcastFavPrompts()}addPrompt(e){this.promptKeys.unshift(e.key),this.localPrompts.unshift(e),nt(`${Re}-${e.key}`,e),nt(`${Re}-keys`,this.promptKeys),this.localPromptsProjection!==null?(this.localPromptsProjection.unshift(e),this._broadcastLocalPromptsProjection()):this._broadcastLocalPrompts()}setPrompt(e){let t=-1;for(const[i,s]of this.localPrompts.entries())if(s.key===e.key){t=i;break}if(t===-1)throw Error(`Can't find they key ${e.key}.`);this.localPrompts[t]=e;const r=this.promptKeys[t];if(nt(`${Re}-${r}`,e),this.localPromptsProjection!==null){for(const[i,s]of this.localPromptsProjection.entries())if(s.key===e.key){this.localPromptsProjection[i]=e;break}this._broadcastLocalPromptsProjection()}else this._broadcastLocalPrompts();const o=this.favPromptKeys.reduce((i,s,a)=>(s===e.key&&i.push(a),i),[]);if(o.length!==0){for(const i of o)this.favPrompts[i]=e;this._broadcastFavPrompts()}}deletePrompt(e){let t=-1;for(const[o,i]of this.localPrompts.entries())i.key===e.key&&(t=o);if(t===-1)throw Error(`Can't find they key ${e.key}.`);if(this.localPrompts.splice(t,1),this.promptKeys.splice(t,1),hc(`${Re}-${e.key}`),nt(`${Re}-keys`,this.promptKeys),this.localPromptsProjection!==null){for(const[o,i]of this.localPromptsProjection.entries())if(i.key===e.key){this.localPromptsProjection.splice(o,1);break}this._broadcastLocalPromptsProjection()}else this._broadcastLocalPrompts();const r=this.favPromptKeys.reduce((o,i,s)=>(i===e.key&&o.push(s),o),[]);if(r.length!==0){for(const o of r)this.favPromptKeys[o]=null,this.favPrompts[o]=null;nt(`${Re}-fav-keys`,this.favPromptKeys),this._broadcastFavPrompts()}}setFavPrompt(e,t){this.favPrompts[e]=t,this.favPromptKeys[e]=(t==null?void 0:t.key)||null,nt(`${Re}-fav-keys`,this.favPromptKeys),this._broadcastFavPrompts()}sortPrompts(e){var t,r,o;switch(e){case"name":{this.localPrompts.sort((i,s)=>i.title.localeCompare(s.title)),(t=this.localPromptsProjection)==null||t.sort((i,s)=>i.title.localeCompare(s.title));break}case"created":{this.localPrompts.sort((i,s)=>s.created.localeCompare(i.created)),(r=this.localPromptsProjection)==null||r.sort((i,s)=>s.created.localeCompare(i.created));break}case"runCount":{this.localPrompts.sort((i,s)=>s.promptRunCount-i.promptRunCount),(o=this.localPromptsProjection)==null||o.sort((i,s)=>s.promptRunCount-i.promptRunCount);break}default:throw Error(`Unknown order ${e}`)}this.promptKeys=this.localPrompts.map(i=>i.key),nt(`${Re}-keys`,this.promptKeys),this.localPromptsProjection!==null?this._broadcastLocalPromptsProjection():this._broadcastLocalPrompts()}searchPrompt(e){if(e==="")this.localPromptsProjection=null,this._broadcastLocalPrompts();else{this.localPromptsProjection=[];const t=e.toLowerCase();for(const r of this.localPrompts)this._getPromptString(r).includes(t)&&this.localPromptsProjection.push(r);this._broadcastLocalPromptsProjection()}}_cleanStorage(){ep()}_syncStorage(){this.promptKeys=[];for(const[e,t]of this.localPrompts.entries())this.promptKeys.push(t.key),nt(`${Re}-${t.key}`,t);this.favPromptKeys=[null,null,null];for(const e of this.favPrompts)this.favPromptKeys.push(e?e.key:null);nt(`${Re}-keys`,this.promptKeys),nt(`${Re}-fav-keys`,this.favPromptKeys)}_broadcastLocalPrompts(){this.localPromptCount=this.localPrompts.length,this.localPromptBroadcastCount=this.localPrompts.length,this.localPromptsUpdateCallback(structuredClone(this.localPrompts))}_broadcastLocalPromptsProjection(){if(this.localPromptsProjection===null)throw Error("localPromptsProjection is null");this.localPromptCount=this.localPrompts.length,this.localPromptBroadcastCount=this.localPromptsProjection.length,this.localPromptsUpdateCallback(structuredClone(this.localPromptsProjection))}_broadcastFavPrompts(){this.favPromptsUpdateCallback(structuredClone(this.favPrompts))}_getPromptString(e){return`${e.title} ${e.prompt} ${e.icon} ${e.description}
    ${e.recommendedModels} ${e.tags}`.toLowerCase()}}const ws=[{prompt:"Rewrite the following paragraph for a younger audience, using simpler language and concepts. {{text}}",tags:["simplification"],userID:"",userName:"BrightMind",description:"Simplifying complex texts for a younger audience.",icon:"👦",forkFrom:"",promptRunCount:2672,created:"2023-05-16T15:57:21",title:"Simplify texts for younger audience"},{prompt:"Edit this business email to make it more professional and concise. Focus on clarity and tone. {{text}}",tags:["professional"],userID:"",userName:"CorporateWriter",description:"Editing business emails for professionalism and clarity.",icon:"💼",forkFrom:"",promptRunCount:218034,created:"2023-09-09T13:00:21",title:"Edit business emails for clarity"},{prompt:"Transform the following scientific research abstract into a news article suitable for the general public. {{text}}",tags:["science"],userID:"",userName:"ScienceToPublic",description:"Translating scientific jargon into accessible news.",icon:"🔬",forkFrom:"",promptRunCount:1,created:"2023-12-24T17:54:40",title:"Translate scientific jargon into news"},{prompt:"Enhance the descriptiveness of this short story, adding vivid details and stronger character development. {{text}}",tags:["creativity","storytelling"],userID:"",userName:"CreativeWriter88",description:"Enriching stories with vivid descriptions and deep character development.",icon:"📚",forkFrom:"",promptRunCount:96,created:"2023-05-15T20:40:22",title:"Enrich stories with vivid descriptions"},{prompt:"Condense this technical manual into a one-page summary, highlighting key points and instructions. {{text}}",tags:["technical","summary"],userID:"",userName:"TechSummarizer",description:"Summarizing technical manuals into concise, one-page overviews.",icon:"📄",forkFrom:"",promptRunCount:6,created:"2023-07-02T18:54:54",title:"Summarize technical manuals concisely"},{prompt:"Reword this academic article to remove all passive voice, making the writing more active and engaging. {{text}}",tags:["academic"],userID:"",userName:"ActiveAcademic",description:"Transforming academic writing from passive to active voice for greater engagement.",icon:"🎓",forkFrom:"",promptRunCount:1267,created:"2023-01-02T06:11:13",title:"Transform academic writing actively"},{prompt:"Proofread this blog post for spelling, grammar, and punctuation errors. Provide suggestions for improvements. {{text}}",tags:["blog"],userID:"",userName:"BlogProofreader",description:"Proofreading blog posts to enhance readability and correctness.",icon:"✍️",forkFrom:"",promptRunCount:310,created:"2023-06-16T23:08:11",title:"Proofread blog posts for correctness"},{prompt:"Adapt this historical narrative to a screenplay format, focusing on dialogues and scene descriptions. {{text}}",tags:["screenplay"],userID:"",userName:"ScreenAdaptor",description:"Adapting historical narratives into screenplay formats.",icon:"🎬",forkFrom:"",promptRunCount:80731,created:"2023-07-20T01:43:53",title:"Adapt historical narratives for screenplays"},{prompt:"Translate the essence of this poem into a short, modern-day story while retaining its thematic elements. {{text}}",tags:["translation","poetry"],userID:"",userName:"PoeticTranslator",description:"Translating poetry themes into modern-day stories.",icon:"🌹",forkFrom:"",promptRunCount:16,created:"2023-12-04T20:45:28",title:"Translate poetry themes into stories"},{prompt:"Edit this recipe to include more detailed steps and tips for beginner cooks. {{text}}",tags:["cooking"],userID:"",userName:"RecipeEditor",description:"Enhancing recipes with detailed instructions for beginners.",icon:"🍳",forkFrom:"",promptRunCount:26005,created:"2023-11-09T07:02:12",title:"Enhance recipes with detailed instructions"},{prompt:"Rewrite this product description to target a teenage audience, using trendy language and appealing features. {{text}}",tags:["marketing","teenagers"],userID:"",userName:"YouthMarketer",description:"Tailoring product descriptions for a teenage demographic.",icon:"🛍️",forkFrom:"",promptRunCount:46351,created:"2023-04-05T05:52:35",title:"Tailor product descriptions for teenagers"},{prompt:"Revise this political speech to make it more persuasive and impactful, focusing on rhetorical devices. {{text}}",tags:["politics"],userID:"",userName:"SpeechCrafter",description:"Crafting more persuasive and impactful political speeches.",icon:"🗣️",forkFrom:"",promptRunCount:2476,created:"2023-01-31T19:55:13",title:"Craft persuasive political speeches"},{prompt:"As an experienced writer, revise the text to make it more engaging for readers. {{text}}",tags:["writing"],userID:"user123",userName:"WriterJane",description:"This is a prompt to help writers create engaging content.",icon:"✍️",forkFrom:"",promptRunCount:50,created:"2023-07-15T06:33:22",title:"Create engaging content"},{prompt:"Proofread and correct the following article for grammar and clarity. Place your edited version in the {{output}} tag. {{text}}",tags:["proofreading"],userID:"user456",userName:"GrammarGuru",description:"Improve grammar and clarity of articles.",icon:"📚",forkFrom:"",promptRunCount:6,created:"2023-03-10T06:24:44",title:"Improve grammar and clarity"},{prompt:"You are a professional editor. Enhance the readability and structure of this text for a wider audience. {{text}}",tags:["editing"],userID:"user789",userName:"EditorExpert",description:"Help writers improve text readability and structure.",icon:"🖋️",forkFrom:"",promptRunCount:1562,created:"2023-12-06T05:18:18",title:"Enhance text readability and structure"},{prompt:"Revise the following blog post to make it more concise and impactful. Place your edited version in the {{output}} tag. {{text}}",tags:["writing"],userID:"user101",userName:"BlogMaven",description:"Assist bloggers in creating concise and impactful content.",icon:"📝",forkFrom:"",promptRunCount:9,created:"2023-01-28T16:54:39",title:"Assist bloggers with impactful content"},{prompt:"You are a skilled communicator. Edit the text to enhance its clarity and coherence. {{text}}",tags:["communication"],userID:"user202",userName:"CommunicationPro",description:"Improve the clarity and coherence of written communication.",icon:"🗣️",forkFrom:"",promptRunCount:855,created:"2023-10-23T05:01:28",title:"Improve clarity and coherence"},{prompt:"You are a professional writer tasked with improving the readability of this scientific article for a broader audience. Make complex concepts accessible. {{text}}",tags:["writing"],userID:"user123",userName:"WriterExpert",description:"Assist writers in simplifying scientific content for wider readership.",icon:"📄",forkFrom:"",promptRunCount:5,created:"2023-08-10T17:09:13",title:"Simplify scientific content for readers"},{prompt:"Enhance the flow and coherence of this legal document. Ensure it is legally accurate and well-structured. {{text}}",tags:["law"],userID:"user456",userName:"LegalPro",description:"Help legal professionals improve the quality of legal documents.",icon:"⚖️",forkFrom:"",promptRunCount:1764,created:"2023-01-04T21:29:53",title:"Enhance legal documents"},{prompt:"You are an experienced proofreader. Correct the grammar, punctuation, and spelling in this manuscript. {{text}}",tags:["proofreading","grammar"],userID:"user789",userName:"ProofreadingAce",description:"Offer proofreading services to authors and writers.",icon:"📖",forkFrom:"",promptRunCount:94848,created:"2023-10-13T02:03:22",title:"Offer proofreading for authors"},{prompt:"Revise the marketing copy for this product to make it more compelling and persuasive. {{text}}",tags:["marketing"],userID:"user101",userName:"MarketingPro",description:"Assist businesses in creating persuasive marketing materials.",icon:"📢",forkFrom:"",promptRunCount:100,created:"2023-09-01T05:15:52",title:"Create persuasive marketing materials"},{prompt:"You are a language enthusiast. Improve the dialogues in this screenplay to make them more authentic and engaging. {{text}}",tags:["screenplay"],userID:"user202",userName:"LanguageArtist",description:"Help scriptwriters enhance the quality of dialogues in their screenplays.",icon:"🎭",forkFrom:"",promptRunCount:427,created:"2023-02-19T08:52:39",title:"Enhance screenplay dialogues"},{prompt:"Rewrite the user manual for this software to ensure it's user-friendly and easy to understand. {{text}}",tags:["software"],userID:"user303",userName:"ManualMaster",description:"Assist software developers in creating user-friendly manuals.",icon:"💻",forkFrom:"",promptRunCount:29375,created:"2023-06-18T09:34:58",title:"Create user-friendly software manuals"},{prompt:"You are a creative editor. Edit the fantasy novel to make it more immersive and captivating. {{text}}",tags:["editing","fantasy"],userID:"user404",userName:"FantasyEditor",description:"Help authors enhance the immersive experience in fantasy novels.",icon:"🧙‍♂️",forkFrom:"",promptRunCount:4,created:"2023-08-02T12:15:08",title:"Enhance immersion in fantasy novels"},{prompt:"Polish the content of this travel blog to make it more inspiring and informative. {{text}}",tags:["travel"],userID:"user505",userName:"TravelWriter",description:"Support travel bloggers in creating inspiring travel content.",icon:"✈️",forkFrom:"",promptRunCount:289,created:"2023-05-14T04:19:41",title:"Inspire travel bloggers with content"},{prompt:"You are an expert reviewer. Provide feedback and critique for this restaurant review to make it more insightful. {{text}}",tags:["review","restaurant"],userID:"user606",userName:"ReviewExpert",description:"Help reviewers improve the quality and depth of their restaurant reviews.",icon:"🍽️",forkFrom:"",promptRunCount:87694,created:"2023-06-25T13:03:32",title:"Enhance restaurant review quality"},{prompt:"Revise this academic paper to enhance its scholarly impact and coherence. {{text}}",tags:["academic"],userID:"user707",userName:"AcademicEditor",description:"Support researchers in improving the quality of their academic papers.",icon:"📚",forkFrom:"",promptRunCount:24793,created:"2023-06-30T10:44:26",title:"Improve academic paper quality"},{prompt:"You are a language enthusiast. Improve the dialogues in this screenplay to make them more authentic and engaging. {{text}}",tags:["screenplay"],userID:"user808",userName:"LanguageArtist",description:"Help scriptwriters enhance the quality of dialogues in their screenplays.",icon:"🎭",forkFrom:"",promptRunCount:28,created:"2023-03-12T17:57:22",title:"Enhance screenplay dialogues"},{prompt:"Rewrite the user manual for this software to ensure it's user-friendly and easy to understand. {{text}}",tags:["software","user manual"],userID:"user909",userName:"ManualMaster",description:"Assist software developers in creating user-friendly manuals.",icon:"💻",forkFrom:"",promptRunCount:257,created:"2023-12-08T10:15:08",title:"Create user-friendly software manuals"},{prompt:"As a skilled writer, revise the content to make it more engaging for the target audience. Ensure clarity and flow. {{text}}",tags:["writing","engagement"],userID:"user001",userName:"WriterWizard",description:"A prompt for enhancing writing engagement and clarity.",icon:"✍️",forkFrom:"",promptRunCount:616,created:"2023-06-28T09:54:15",title:"Enhance writing engagement"},{prompt:"Proofread and correct the following manuscript for grammatical errors and coherence. Provide feedback for improvement. {{text}}",tags:["proofreading"],userID:"user002",userName:"GrammarGuru",description:"A task to ensure grammatical accuracy and coherence in writing.",icon:"📚",forkFrom:"",promptRunCount:117,created:"2023-08-31T07:57:35",title:"Ensure grammatical accuracy"},{prompt:"You are a professional editor. Improve the readability and structure of this document for a broader readership. {{text}}",tags:["editing"],userID:"user003",userName:"EditorExpert",description:"An opportunity to enhance document readability and structure.",icon:"🖋️",forkFrom:"",promptRunCount:240331,created:"2023-08-08T08:14:00",title:"Enhance document readability"},{prompt:"Revise the marketing copy for this product to make it more persuasive and compelling. Enhance its selling points. {{text}}",tags:["marketing"],userID:"user004",userName:"MarketingMaven",description:"A task to create persuasive marketing content.",icon:"📢",forkFrom:"",promptRunCount:1148,created:"2023-12-05T04:14:29",title:"Create persuasive marketing content"},{prompt:"You are a language enthusiast. Edit the dialogues in this script to make them more authentic and engaging. {{text}}",tags:["scriptwriting"],userID:"user005",userName:"ScriptMaster",description:"An opportunity to improve the authenticity of script dialogues.",icon:"🎭",forkFrom:"",promptRunCount:1,created:"2023-02-15T16:21:51",title:"Improve script dialogue authenticity"},{prompt:"Rewrite the user manual for this software to ensure it's user-friendly and easy to understand. Enhance the user experience. {{text}}",tags:["software"],userID:"user006",userName:"ManualMaestro",description:"A task to create user-friendly software manuals.",icon:"💻",forkFrom:"",promptRunCount:11974,created:"2023-12-28T18:32:04",title:"Create user-friendly software manuals"},{prompt:"You are a creative editor. Edit the fantasy novel to make it more immersive and captivating. Bring the world to life. {{text}}",tags:["editing"],userID:"user007",userName:"FantasyArtisan",description:"An opportunity to enhance the immersive experience in fantasy novels.",icon:"🧙‍♂️",forkFrom:"",promptRunCount:46927,created:"2023-08-12T18:24:39",title:"Enhance immersive fantasy novels"},{prompt:"Polish the content of this travel blog to make it more inspiring and informative. Transport readers to new places. {{text}}",tags:["travel"],userID:"user008",userName:"TravelJourneyer",description:"A task to inspire readers through travel blogs.",icon:"✈️",forkFrom:"",promptRunCount:15,created:"2023-05-16T23:35:51",title:"Inspire through travel blogs"},{prompt:"You are an expert reviewer. Provide feedback and critique for this restaurant review to make it more insightful. Elevate the experience. {{text}}",tags:["review","restaurant"],userID:"user009",userName:"ReviewSavant",description:"An opportunity to enhance the quality of restaurant reviews.",icon:"🍽️",forkFrom:"",promptRunCount:2653,created:"2023-04-20T01:36:32",title:"Enhance restaurant review quality"},{prompt:"Revise this academic paper to enhance its scholarly impact and coherence. Contribute to academic excellence. {{text}}",tags:["academic"],userID:"user010",userName:"AcademicAdept",description:"A task to contribute to academic excellence through paper revising.",icon:"🍽️",forkFrom:"",promptRunCount:70598,created:"2023-01-06T17:50:06",title:"Contribute to academic excellence"},{prompt:"Revise the marketing content for this new product launch to make it more appealing and persuasive. Highlight key features. {{text}}",tags:["marketing","product launch"],userID:"user011",userName:"MarketingExpert",description:"A task to create persuasive marketing materials for a product launch.",icon:"🚀",forkFrom:"",promptRunCount:5876,created:"2023-03-14T07:15:51",title:"Create marketing materials"},{prompt:"You are a literature enthusiast. Edit the dialogue in this play to make it more authentic and emotionally resonant. {{text}}",tags:["playwriting"],userID:"user012",userName:"LiteraryArtist",description:"An opportunity to enhance the authenticity and emotional impact of play dialogue.",icon:"🎭",forkFrom:"",promptRunCount:4,created:"2023-08-22T04:18:45",title:"Enhance play dialogue impact"},{prompt:"Polish the content of this fashion blog to make it more trendy and visually appealing. Keep readers up-to-date. {{text}}",tags:["fashion"],userID:"user013",userName:"Fashionista",description:"A task to create trendy and visually appealing fashion blog content.",icon:"👗",forkFrom:"",promptRunCount:13,created:"2023-05-16T02:25:01",title:"Create trendy fashion blog content"},{prompt:"Improve the user interface copy for this app to make it user-friendly and easy to understand. Enhance user experience. {{text}}",tags:["app","user interface"],userID:"user014",userName:"UXDesigner",description:"An opportunity to improve app user interface for better user experience.",icon:"📱",forkFrom:"",promptRunCount:109,created:"2023-07-04T09:16:03",title:"Improve app UI for user experience"},{prompt:"You are a grammar expert. Proofread and correct the following technical manual for accuracy and clarity. {{text}}",tags:["proofreading"],userID:"user015",userName:"GrammarWhiz",description:"Offer proofreading services for technical manuals.",icon:"📖",forkFrom:"",promptRunCount:190414,created:"2023-05-02T16:30:33",title:"Proofreading technical manuals"},{prompt:"Revise this academic research paper to ensure it's well-structured and scholarly. Contribute to academic excellence. {{text}}",tags:["academic"],userID:"user016",userName:"ResearchScholar",description:"A task to contribute to the quality of academic research papers.",icon:"🔍",forkFrom:"",promptRunCount:26201,created:"2023-05-09T10:42:18",title:"Contribute to research quality"},{prompt:"You are a creative editor. Edit the fantasy novel to make it more immersive and captivating. Transport readers to another world. {{text}}",tags:["editing"],userID:"user017",userName:"FantasyArtisan",description:"Help authors enhance the immersive experience in fantasy novels.",icon:"🧝‍♀️",forkFrom:"",promptRunCount:558,created:"2023-04-20T03:21:35",title:"Enhance immersive fantasy novels"},{prompt:"Rewrite the technical documentation for this software to ensure it's comprehensive and user-friendly. Enhance user knowledge. {{text}}",tags:["software"],userID:"user018",userName:"DocMaster",description:"Assist software developers in creating comprehensive and user-friendly documentation.",icon:"💻",forkFrom:"",promptRunCount:205873,created:"2023-05-20T17:25:04",title:"Create user-friendly documentation"},{prompt:"Enhance the flow and coherence of this legal brief. Ensure it's legally accurate and persuasive. {{text}}",tags:["legal"],userID:"user019",userName:"LegalExpert",description:"A task to improve the quality and persuasiveness of legal briefs.",icon:"⚖️",forkFrom:"",promptRunCount:26,created:"2023-07-01T00:32:27",title:"Improve legal brief persuasiveness"},{prompt:"Revise this scientific research paper to make it more accessible and engaging for a general audience. Simplify complex concepts. {{text}}",tags:["science"],userID:"user101",userName:"ScienceScribe",description:"A task to make scientific research more understandable for the public.",icon:"🔬",forkFrom:"",promptRunCount:42,created:"2023-03-05T06:05:37",title:"Make research understandable"},{prompt:"Enhance the coherence and readability of this legal document. Ensure it complies with legal standards. {{text}}",tags:["law"],userID:"user102",userName:"LegalWordsmith",description:"An opportunity to improve the quality and compliance of legal documents.",icon:"⚖️",forkFrom:"",promptRunCount:2859,created:"2023-08-03T07:39:13",title:"Improve legal document quality"},{prompt:"As a skilled proofreader, correct the grammar, punctuation, and spelling in this manuscript. Provide detailed feedback. {{text}}",tags:["proofreading"],userID:"user103",userName:"GrammarGuardian",description:"Offer thorough proofreading services for writers.",icon:"📖",forkFrom:"",promptRunCount:216,created:"2023-06-18T04:00:00",title:"Thorough proofreading services"},{prompt:"Revise the marketing copy for this startup's website to make it more compelling and persuasive. Emphasize unique selling points. {{text}}",tags:["marketing"],userID:"user104",userName:"StartupWordsmith",description:"A task to create persuasive marketing materials for a startup.",icon:"💼",forkFrom:"",promptRunCount:8,created:"2023-07-29T11:38:41",title:"Create startup marketing materials"},{prompt:"You are a language enthusiast. Edit the dialogues in this screenplay to make them more authentic and emotionally impactful. {{text}}",tags:["screenplay","dialogue"],userID:"user105",userName:"ScriptArtisan",description:"An opportunity to enhance the authenticity and emotional depth of script dialogues.",icon:"🎥",forkFrom:"",promptRunCount:374,created:"2023-04-27T06:18:44",title:"Enhance script dialogue authenticity"},{prompt:"Rewrite the user manual for this software application to ensure it's user-friendly and easy to follow. Enhance the user experience. {{text}}",tags:["software"],userID:"user106",userName:"UserGuidePro",description:"A task to create user-friendly software manuals.",icon:"📘",forkFrom:"",promptRunCount:5333,created:"2023-11-27T05:27:45",title:"User-friendly software manuals"},{prompt:"You are a creative editor. Edit the fantasy novel to make it more immersive and captivating. Transport readers to a magical world. {{text}}",tags:["editing","fantasy"],userID:"user107",userName:"FantasyWordsmith",description:"Help authors enhance the immersive experience in fantasy novels.",icon:"🧚‍♂️",forkFrom:"",promptRunCount:97928,created:"2023-03-25T05:41:09",title:"Enhance fantasy novel immersion"},{prompt:"Polish the content of this travel blog to make it more inspiring and informative. Share travel adventures. {{text}}",tags:["travel"],userID:"user108",userName:"TravelExplorer",description:"A task to inspire readers through travel blog content.",icon:"🌍",forkFrom:"",promptRunCount:20875,created:"2023-05-09T06:21:34",title:"Inspire through travel blogs"},{prompt:"Revise the review for this restaurant to make it more insightful and descriptive. Share dining experiences. {{text}}",tags:["review"],userID:"user109",userName:"ReviewConnoisseur",description:"An opportunity to enhance the depth and quality of restaurant reviews.",icon:"🍔",forkFrom:"",promptRunCount:22,created:"2023-04-23T18:28:23",title:"Enhance restaurant review quality"},{prompt:"You are an expert academic editor. Edit this research paper to ensure it's scholarly and coherent. Contribute to academic excellence. {{text}}",tags:["academic","research paper"],userID:"user110",userName:"AcademicEditor",description:"A task to contribute to the quality of academic research papers.",icon:"🎓",forkFrom:"",promptRunCount:2,created:"2023-02-13T06:04:51",title:"Contribute to research papers"},{prompt:"Improve the flow and coherence of this technical report. Ensure it's clear and informative. {{text}}",tags:["technical"],userID:"user111",userName:"TechWriter",description:"An opportunity to enhance the clarity and informativeness of technical reports.",icon:"🔍",forkFrom:"",promptRunCount:279297,created:"2023-11-05T21:24:22",title:"Enhance technical report clarity"},{prompt:"You are a creative editor. Edit the poetry collection to make it more emotionally resonant and evocative. {{text}}",tags:["editing"],userID:"user112",userName:"PoetryArtisan",description:"Help poets enhance the emotional impact of their poetry collections.",icon:"✒️",forkFrom:"",promptRunCount:4,created:"2023-06-14T22:20:02",title:"Enhance poetry emotional impact"},{prompt:"Revise this legal contract to ensure it's legally sound and comprehensive. Protect legal interests. {{text}}",tags:["legal"],userID:"user113",userName:"LegalProtector",description:"A task to create legally sound and comprehensive contracts.",icon:"📜",forkFrom:"",promptRunCount:6750,created:"2023-10-04T21:40:27",title:"Create comprehensive contracts"},{prompt:"You are an experienced engineer. Improve the technical documentation to make it more user-friendly and informative. Enhance user knowledge. {{text}}",tags:["engineering","technical documentation"],userID:"user114",userName:"EngineeringPro",description:"An opportunity to create user-friendly technical documentation.",icon:"🛠️",forkFrom:"",promptRunCount:915,created:"2023-06-06T23:32:20",title:"User-friendly tech documentation"},{prompt:"Polish the content of this fashion magazine article to make it more stylish and visually appealing. Set fashion trends. {{text}}",tags:["fashion"],userID:"user115",userName:"FashionCritic",description:"A task to influence fashion trends through stylish magazine articles.",icon:"👠",forkFrom:"",promptRunCount:59,created:"2023-03-16T04:58:05",title:"Influence fashion trends"},{prompt:"Enhance the flow and coherence of this technical manual. Ensure it's clear and user-friendly. {{text}}",tags:["technical"],userID:"user116",userName:"TechWizard",description:"An opportunity to create clear and user-friendly technical manuals.",icon:"📓",forkFrom:"",promptRunCount:34438,created:"2023-03-29T10:30:43",title:"Clear technical manuals"},{prompt:"You are an expert content writer. Revise this blog post to make it more engaging and informative. Captivate readers. {{text}}",tags:["blog","content writing"],userID:"user117",userName:"ContentMaestro",description:"Help bloggers captivate readers through engaging and informative content.",icon:"✍️",forkFrom:"",promptRunCount:73,created:"2023-06-17T12:55:31",title:"Engaging blog content"},{prompt:"Rewrite this travel guide to make it more exciting and adventurous. Inspire travelers. {{text}}",tags:["travel","guide","adventure"],userID:"user118",userName:"TravelAdventurer",description:"A task to inspire travelers through exciting travel guides.",icon:"🌄",forkFrom:"",promptRunCount:5,created:"2023-11-22T08:42:25",title:"Inspire travelers with guides"},{prompt:"You are a professional writer tasked with enhancing this news article's readability for a wider readership. Simplify complex concepts. {{text}}",tags:["writing"],userID:"user101",userName:"WriterPro",description:"A prompt to improve news article readability for diverse audiences.",icon:"📰",forkFrom:"",promptRunCount:14274,created:"2023-06-15T07:47:38",title:"Improve news article readability"},{prompt:"Revise this scientific research paper to ensure it's scientifically accurate and comprehensible. Contribute to scientific knowledge. {{text}}",tags:["science"],userID:"user102",userName:"ScienceSavvy",description:"A task to enhance the quality and accuracy of scientific research papers.",icon:"🔬",forkFrom:"",promptRunCount:19350,created:"2023-02-07T07:13:08",title:"Enhance research paper quality"},{prompt:"You are a grammar enthusiast. Edit the content of this technical manual to eliminate errors and improve clarity. {{text}}",tags:["proofreading"],userID:"user103",userName:"GrammarGeek",description:"Offer proofreading services for technical manuals to improve clarity.",icon:"💡",forkFrom:"",promptRunCount:7667,created:"2023-01-17T02:12:35",title:"Proofread technical manuals"},{prompt:"Enhance the narrative flow and coherence of this novel excerpt. Make it more engaging and captivating. {{text}}",tags:["novel"],userID:"user104",userName:"NovelMaestro",description:"A task to enhance the narrative flow and engagement of novel excerpts.",icon:"📖",forkFrom:"",promptRunCount:7681,created:"2023-06-15T03:17:28",title:"Enhance novel narrative flow"},{prompt:"You are an experienced editor. Improve the dialogues in this screenplay to make them more authentic and emotionally resonant. {{text}}",tags:["screenplay"],userID:"user105",userName:"ScreenplayExpert",description:"An opportunity to enhance the authenticity and emotional impact of screenplay dialogues.",icon:"🎬",forkFrom:"",promptRunCount:8,created:"2023-03-20T16:14:56",title:"Enhance screenplay dialogues"},{prompt:"Revise the content of this travel blog to make it more inspiring and informative. Transport readers to exciting destinations. {{text}}",tags:["travel"],userID:"user106",userName:"TravelExplorer",description:"A task to inspire readers through travel blog content.",icon:"✈️",forkFrom:"",promptRunCount:1047,created:"2023-10-29T01:15:31",title:"Inspire through travel blogs"},{prompt:"You are a seasoned reviewer. Provide feedback and critique for this movie review to make it more insightful and engaging. {{text}}",tags:["review"],userID:"user107",userName:"ReviewCritic",description:"An opportunity to enhance the quality and engagement of movie reviews.",icon:"🎥",forkFrom:"",promptRunCount:357,created:"2023-07-12T10:48:29",title:"Enhance movie review quality"},{prompt:"Polish the content of this fashion magazine article to make it more trendy and visually appealing. Stay ahead of fashion. {{text}}",tags:["fashion"],userID:"user108",userName:"FashionTrendsetter",description:"A task to create trendy and visually appealing fashion magazine articles.",icon:"👗",forkFrom:"",promptRunCount:614,created:"2023-05-31T04:55:37",title:"Create stylish magazine articles"},{prompt:"You are an experienced legal editor. Edit this legal brief to ensure it's legally accurate and persuasive. {{text}}",tags:["legal"],userID:"user109",userName:"Legalboy11",description:"Fun.",icon:"👗",forkFrom:"",promptRunCount:76,created:"2023-01-15T07:36:34",title:"Fun"},{prompt:"You are a professional content writer, tasked with making this blog post more engaging for the readers. Add creative elements to enhance interest. {{text}}",tags:["writing"],userID:"user201",userName:"ContentCreator",description:"A prompt to improve the engagement of blog posts through creative elements.",icon:"✍️",forkFrom:"",promptRunCount:37,created:"2023-08-22T12:29:57",title:"Improve blog post engagement"},{prompt:"Proofread and edit this technical documentation to eliminate errors and ensure clarity. Provide explanations where needed. {{text}}",tags:["proofreading"],userID:"user202",userName:"TechExpert",description:"A task to improve the accuracy and clarity of technical documentation.",icon:"💻",forkFrom:"",promptRunCount:28385,created:"2023-03-29T11:34:26",title:"Clarify technical documentation"},{prompt:"You are a grammar enthusiast. Edit this legal contract to ensure it's legally precise and free of errors. {{text}}",tags:["legal"],userID:"user203",userName:"LegalLinguist",description:"Offer proofreading services for legal contracts to ensure precision.",icon:"⚖️",forkFrom:"",promptRunCount:59358,created:"2023-07-17T01:07:02",title:"Proofread legal contracts"},{prompt:"Enhance the narrative flow and coherence of this short story. Make it more immersive and emotionally resonant. {{text}}",tags:["story"],userID:"user204",userName:"StoryTeller",description:"A task to enhance the narrative flow and emotional resonance of short stories.",icon:"📖",forkFrom:"",promptRunCount:15,created:"2023-12-27T02:46:12",title:"Enhance short story flow"},{prompt:"You are an experienced editor. Improve the dialogues in this movie script to make them more authentic and captivating. {{text}}",tags:["screenwriting"],userID:"user205",userName:"ScreenplaySculptor",description:"An opportunity to enhance the authenticity and engagement of movie script dialogues.",icon:"🎬",forkFrom:"",promptRunCount:39649,created:"2023-11-22T15:06:33",title:"Improve script dialogues"},{prompt:"Revise the content of this travel guide to make it more informative and inspiring. Guide readers on exciting journeys. {{text}}",tags:["travel"],userID:"user206",userName:"TravelGuide",description:"A task to inspire and guide readers through travel content.",icon:"🌍",forkFrom:"",promptRunCount:176,created:"2023-11-06T09:19:18",title:"Inspire with travel content"},{prompt:"You are a seasoned reviewer. Provide feedback and critique for this book review to make it more insightful and thought-provoking. {{text}}",tags:["review"],userID:"user207",userName:"BookReviewer",description:"An opportunity to enhance the quality and thoughtfulness of book reviews.",icon:"📚",forkFrom:"",promptRunCount:542,created:"2023-09-09T04:30:39",title:"Enhance book review quality"},{prompt:"Polish the content of this cooking blog to make it more delicious and visually appealing. Share culinary delights. {{text}}",tags:["cooking"],userID:"user208",userName:"ChefBlogger",description:"A task to create mouthwatering and visually appealing cooking blog content.",icon:"🍽️",forkFrom:"",promptRunCount:1,created:"2023-10-04T01:12:57",title:"Create cooking blog content"},{prompt:"You are an academic editor. Edit this research paper to ensure it's academically rigorous and logically structured. {{text}}",tags:["academic"],userID:"user209",userName:"AcademicEditor",description:"A task to contribute to academic excellence through research paper editing.",icon:"🔍",forkFrom:"",promptRunCount:2,created:"2023-08-22T04:37:34",title:"Edit research papers"},{prompt:"Revise the content of this fashion catalog to make it more trendy and appealing. Showcase the latest fashion trends. {{text}}",tags:["fashion"],userID:"user210",userName:"FashionCurator",description:"A task to curate and present the latest fashion trends in a trendy catalog.",icon:"👠",forkFrom:"",promptRunCount:1453,created:"2023-12-29T06:43:45",title:"Curate trendy fashion trends"},{prompt:"You are a technical writer. Improve this software manual to make it user-friendly and easy to understand. Enhance user experience. {{text}}",tags:["software"],userID:"user211",userName:"TechWriter",description:"An opportunity to create user-friendly and comprehensible software manuals.",icon:"💻",forkFrom:"",promptRunCount:1143,created:"2023-10-02T02:13:42",title:"User-friendly software manuals"},{prompt:"Enhance the flow and coherence of this legal argument. Ensure it's persuasive and legally sound. {{text}}",tags:["legal","argument"],userID:"user212",userName:"LegalLuminary",description:"A task to improve the quality and persuasiveness of legal arguments.",icon:"⚖️",forkFrom:"",promptRunCount:23,created:"2023-01-24T04:56:40",title:"Persuasive legal arguments"},{prompt:"You are a creative content creator. Edit this marketing campaign copy to make it more compelling and memorable. {{text}}",tags:["marketing","campaign"],userID:"user213",userName:"MarketingMaven",description:"An opportunity to enhance the impact and memorability of marketing campaign copy.",icon:"📢",forkFrom:"",promptRunCount:58926,created:"2023-04-30T14:58:15",title:"Memorable marketing copy"},{prompt:"Polish the content of this health blog to make it more informative and health-conscious. Promote well-being. {{text}}",tags:["health"],userID:"user214",userName:"HealthEnthusiast",description:"A task to promote well-being and health-consciousness through blog content.",icon:"🌿",forkFrom:"",promptRunCount:9,created:"2023-08-27T21:34:39",title:"Promote well-being in blogs"},{prompt:"You are an experienced journalist. Improve this news article to make it more informative and unbiased. Deliver the facts. {{text}}",tags:["journalism"],userID:"user215",userName:"JournalistPro",description:"A prompt to enhance the informativeness and objectivity of news articles.",icon:"🗞️",forkFrom:"",promptRunCount:28,created:"2023-07-08T22:29:06",title:"Informative news articles"},{prompt:"Revise the content of this technology blog to make it more up-to-date and informative. Keep readers tech-savvy. {{text}}",tags:["technology"],userID:"user216",userName:"TechGeek",description:"A task to keep readers informed and tech-savvy through technology blog content.",icon:"🔌",forkFrom:"",promptRunCount:824,created:"2023-08-15T08:33:12",title:"Tech-savvy content"},{prompt:"You are a literary editor. Edit this poetry collection to make it more evocative and emotionally moving. Stir the soul. {{text}}",tags:["poetry"],userID:"user217",userName:"LiteraryLover",description:"An opportunity to enhance the emotional depth and impact of poetry collections.",icon:"📜",forkFrom:"",promptRunCount:24384,created:"2023-09-28T23:59:45",title:"Enhance poetry impact"},{prompt:"Polish the content of this lifestyle blog to make it more trendy and relatable. Connect with modern readers. {{text}}",tags:["lifestyle","blog"],userID:"user218",userName:"LifestyleGuru",description:"A task to create trendy and relatable lifestyle blog content.",icon:"🌟",forkFrom:"",promptRunCount:6723,created:"2023-06-09T14:54:07",title:"Create lifestyle blog"},{prompt:"You are a grammar expert. Proofread and edit this educational guide to ensure it's error-free and easy to understand. {{text}}",tags:["proofreading"],userID:"user219",userName:"GrammarWizard",description:"Offer proofreading services for educational guides to ensure clarity and accuracy.",icon:"📚",forkFrom:"",promptRunCount:84,created:"2023-03-26T07:55:36",title:"Proofread educational guides"},{prompt:"Enhance the flow and coherence of this marketing presentation. Make it more persuasive and attention-grabbing. {{text}}",tags:["marketing"],userID:"user220",userName:"MarketingGuru",description:"A task to create persuasive and attention-grabbing marketing presentations.",icon:"📊",forkFrom:"",promptRunCount:298764,created:"2023-10-03T02:26:05",title:"Create persuasive presentations"},{prompt:"You are an experienced novelist. Rewrite this short story to add depth to the characters and intensify the plot. {{text}}",tags:["writing"],userID:"user301",userName:"AuthorExtraordinaire",description:"A prompt to enhance the storytelling elements of a short story.",icon:"✒️",forkFrom:"",promptRunCount:22,created:"2023-03-21T00:54:53",title:"Strengthen short story storytelling"},{prompt:"Revise the content of this history article to make it more informative and historically accurate. Share knowledge with readers. {{text}}",tags:["history","article"],userID:"user302",userName:"HistoryBuff",description:"A task to improve historical accuracy and knowledge sharing through articles.",icon:"📜",forkFrom:"",promptRunCount:50,created:"2023-06-30T16:31:46",title:"Enhance historical articles"},{prompt:"You are a language enthusiast. Edit this translation to ensure it's culturally sensitive and linguistically accurate. Bridge languages. {{text}}",tags:["translation"],userID:"user303",userName:"LanguageLover",description:"An opportunity to create culturally sensitive and accurate translations.",icon:"🌍",forkFrom:"",promptRunCount:70432,created:"2023-05-15T13:01:46",title:"Culturally sensitive translations"},{prompt:"Polish the content of this environmental blog to make it more eco-friendly and impactful. Promote sustainability. {{text}}",tags:["environment"],userID:"user304",userName:"EcoWarrior",description:"A task to promote eco-friendliness and sustainability through blog content.",icon:"🌿",forkFrom:"",promptRunCount:1003,created:"2023-04-03T18:54:40",title:"Promote eco-friendliness"},{prompt:"You are a professional editor. Edit this scientific research paper to ensure it's logically structured and scientifically sound. Advance research. {{text}}",tags:["scientific"],userID:"user305",userName:"ScienceEditor",description:"A prompt to enhance the logical structure and scientific rigor of research papers.",icon:"🔬",forkFrom:"",promptRunCount:230,created:"2023-05-01T01:59:21",title:"Improve research paper structure"}],hi=Ue.urls.wordflowEndpoint,fc=ws,np=localStorage.getItem("user-id");for(const n of fc)n.key=mn(),n.injectionMode="replace",n.temperature=.2,n.recommendedModels=[],n.outputParsingPattern="",n.outputParsingReplacement="",n.userID=np,n.recommendedModels=["gpt-3.5","palm-2","gpt-4","gemini-pro","llama-2","gemini-ultra"];class rp{constructor(e,t){this.remotePrompts=[],this.promptIsSubset=!1,this.popularTags=[],this.remotePromptsUpdateCallback=e,this.popularTagsUpdateCallback=t}async getPopularTags(){const e=new URL(hi);e.searchParams.append("popularTags","true");const t={method:"GET",credentials:"include"},r=await fetch(e.toString(),t);this.popularTags=await r.json(),this.popularTags=this.popularTags.filter(o=>o.tag!==""),this._broadcastPopularTags()}async getPromptsByTag(e,t){const r=new URL(hi);r.searchParams.append("tag",e),t==="new"?r.searchParams.append("mostRecent","true"):r.searchParams.append("mostPopular","true");const o={method:"GET",credentials:"include"},i=await fetch(r.toString(),o);this.remotePrompts=await i.json();const s=i.headers.get("x-has-pagination");this.promptIsSubset=s==="true",this._broadcastRemotePrompts()}async sharePrompt(e){const t=new URL(hi);t.searchParams.append("type","prompt");const r={...e};delete r.created,delete r.promptRunCount,delete r.key;const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"};return(await fetch(t.toString(),o)).status}_broadcastRemotePrompts(){this.remotePromptsUpdateCallback(structuredClone(this.remotePrompts))}_broadcastPopularTags(){this.popularTagsUpdateCallback(structuredClone(this.popularTags))}async _populateRemotePrompts(e){for(const t of fc.slice(0,e))await this.sharePrompt(t)}}const fi="user-config";var Pe=(n=>(n["gpt-3.5-free"]="GPT 3.5 (free)",n["gpt-3.5"]="GPT 3.5",n["gpt-4"]="GPT 4",n["gemini-pro"]="Gemini Pro",n))(Pe||{});const lo={"GPT 3.5 (free)":"gpt-3.5-free","GPT 3.5":"gpt-3.5","GPT 4":"gpt-4","Gemini Pro":"gemini-pro"};var Lt=(n=>(n.google="Google",n.openAI="Open AI",n))(Lt||{});const ua={"GPT 3.5":"Open AI","GPT 3.5 (free)":"Open AI","GPT 4":"Open AI","Gemini Pro":"Google"};var an,ln;class op{constructor(e){ai(this,an,void 0);ai(this,ln,void 0);this.updateUserConfig=e,Tn(this,an,{"Open AI":"",Google:""}),Tn(this,ln,"GPT 3.5 (free)"),this._broadcastUserConfig(),this.restoreFinished=this._restoreFromStorage()}setAPIKey(e,t){Yr(this,an)[e]=t,this._syncStorage(),this._broadcastUserConfig()}setPreferredLLM(e){Tn(this,ln,e),this._syncStorage(),this._broadcastUserConfig()}async _restoreFromStorage(){const e=await no(fi);e&&(Tn(this,an,e.llmAPIKeys),Tn(this,ln,e.preferredLLM)),this._broadcastUserConfig()}async _syncStorage(){const e=this._constructConfig();await nt(fi,e)}_constructConfig(){return{llmAPIKeys:Yr(this,an),preferredLLM:Yr(this,ln)}}async _cleanStorage(){await hc(fi)}_broadcastUserConfig(){const e=this._constructConfig();this.updateUserConfig(e)}}an=new WeakMap,ln=new WeakMap;const ip=`.toast{height:100%;max-width:300px;display:flex;flex-direction:row;align-items:flex-start;gap:6px;border-radius:5px;padding:5px 12px;box-sizing:border-box;font-size:var(--font-d2);background-color:var(--green-50);border:1px solid color-mix(in lab,var(--green-50) 100%,var(--gray-500) 20%);color:var(--green-800);box-shadow:0 1px 2px #0000000d,0 0 5px #0000000d;animation:toastPop .1s ease-in-out forwards}.toast[toast-type=warning]{background-color:var(--orange-50);border:1px solid color-mix(in lab,var(--orange-50) 100%,var(--gray-500) 20%);color:var(--orange-800)}.toast[toast-type=error]{background-color:var(--red-50);border:1px solid color-mix(in lab,var(--red-50) 100%,var(--gray-500) 20%);color:var(--red-800)}.toast[is-hidden]{display:none}@keyframes toastPop{0%{transform:scale(.8);opacity:0}90%{transform:scale(1.1);opacity:.9}to{transform:scale(1);opacity:1}}.svg-icon{flex-shrink:0;display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center;position:relative;top:3px}.svg-icon svg{fill:currentColor;width:100%;height:100%}.cross-icon{color:var(--gray-800);width:10px;height:10px;top:5px;margin-left:12px;cursor:pointer}.cross-icon:hover{color:var(--gray-600)}.cross-icon:active{color:var(--gray-700)}.message{width:100%;line-height:1.2}
`;var sp=Object.defineProperty,ap=Object.getOwnPropertyDescriptor,_r=(n,e,t,r)=>{for(var o=r>1?void 0:r?ap(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&sp(e,t,o),o};const lp=M`<svg
  width="100%"
  height="100%"
  viewBox="0 0 80 80"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xml:space="preserve"
  xmlns:serif="http://www.serif.com/"
  style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
>
  <g id="icon-cross-circle-solid">
    <path
      d="M39.904,79.15C18.42,79.15 0.5,61.279 0.5,39.746C0.5,18.213 18.371,0.342 39.855,0.342C61.389,0.342 79.357,18.213 79.357,39.746C79.357,61.279 61.437,79.15 39.904,79.15ZM27.062,56.25C28.088,56.25 29.016,55.908 29.65,55.225L39.904,44.873L50.207,55.225C50.842,55.908 51.77,56.25 52.746,56.25C54.797,56.25 56.408,54.639 56.408,52.588C56.408,51.611 56.066,50.732 55.334,50.049L45.031,39.795L55.383,29.443C56.164,28.711 56.457,27.881 56.457,26.904C56.457,24.902 54.846,23.34 52.844,23.34C51.916,23.34 51.135,23.682 50.402,24.365L39.904,34.766L29.553,24.414C28.869,23.779 28.088,23.438 27.062,23.438C25.109,23.438 23.498,24.951 23.498,27.002C23.498,27.93 23.889,28.809 24.523,29.492L34.826,39.795L24.523,50.098C23.889,50.781 23.498,51.66 23.498,52.588C23.498,54.639 25.109,56.25 27.062,56.25Z"
    />
  </g>
</svg> `,cp=M`<svg
  width="100%"
  height="100%"
  viewBox="0 0 80 80"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xml:space="preserve"
  xmlns:serif="http://www.serif.com/"
  style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
>
  <g id="icon-check-circle-solid">
    <path
      d="M39.618,79.15C18.134,79.15 0.214,61.279 0.214,39.746C0.214,18.213 18.085,0.342 39.569,0.342C61.102,0.342 79.071,18.213 79.071,39.746C79.071,61.279 61.151,79.15 39.618,79.15ZM35.321,58.545C36.786,58.545 38.056,57.861 38.983,56.396L56.366,28.857C56.952,27.978 57.489,26.953 57.489,25.977C57.489,23.877 55.731,22.607 53.778,22.607C52.606,22.607 51.483,23.291 50.702,24.658L35.126,49.854L28.095,40.478C27.02,39.014 26.044,38.623 24.823,38.623C22.772,38.623 21.308,40.234 21.308,42.236C21.308,43.213 21.649,44.189 22.333,45.019L31.415,56.396C32.587,57.959 33.808,58.545 35.321,58.545Z"
    />
  </g>
</svg> `,up=M`<svg
  width="100%"
  height="100%"
  viewBox="0 0 80 80"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xml:space="preserve"
  xmlns:serif="http://www.serif.com/"
  style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
>
  <g id="icon-warning-circle-solid">
    <path
      d="M40.391,79.15C18.907,79.15 0.987,61.279 0.987,39.746C0.987,18.213 18.858,0.342 40.343,0.342C61.876,0.342 79.845,18.213 79.845,39.746C79.845,61.279 61.925,79.15 40.391,79.15ZM40.391,46.973C42.589,46.973 43.809,45.752 43.858,43.457L44.444,22.705C44.493,20.41 42.735,18.701 40.343,18.701C37.95,18.701 36.241,20.361 36.29,22.656L36.876,43.457C36.925,45.703 38.145,46.973 40.391,46.973ZM40.391,60.205C42.882,60.205 45.079,58.301 45.079,55.762C45.079,53.223 42.931,51.269 40.391,51.269C37.901,51.269 35.753,53.271 35.753,55.762C35.753,58.252 37.95,60.205 40.391,60.205Z"
    />
  </g>
</svg>`,dp=M`<svg
  width="100%"
  height="100%"
  viewBox="0 0 62 62"
  version="1.1"
  xml:space="preserve"
  style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
>
  <g id="icon-cross">
    <path
      d="M1.299,60.421C2.861,61.935 5.4,61.935 6.914,60.421L30.84,36.447L54.814,60.421C56.279,61.935 58.867,61.935 60.381,60.421C61.894,58.859 61.894,56.32 60.381,54.855L36.406,30.88L60.381,6.955C61.894,5.441 61.943,2.853 60.381,1.339C58.818,-0.125 56.279,-0.125 54.814,1.339L30.84,25.314L6.914,1.339C5.4,-0.125 2.812,-0.174 1.299,1.339C-0.166,2.902 -0.166,5.441 1.299,6.955L25.273,30.88L1.299,54.855C-0.166,56.32 -0.215,58.908 1.299,60.421Z"
      style="fill-rule:nonzero;"
    />
  </g>
</svg> `;let gn=class extends Q{constructor(){super(),this.type="error",this.message="Title cannot be empty",this.duration=6e3,this.isHidden=!0,this.timer=null}willUpdate(n){}async initData(){}show(){this.isHidden&&(this.isHidden=!1),this.duration>0&&(this.timer!==null&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.hide()},this.duration))}hide(){if(this.isHidden)return;if(this.shadowRoot===null)throw Error("Shadow root is null");const e=this.shadowRoot.querySelector(".toast").animate({opacity:[1,0]},{duration:200,easing:"ease-in-out"});e.onfinish=()=>{this.isHidden=!0}}render(){let n=cp;return this.type==="warning"?n=up:this.type==="error"&&(n=lp),M`
      <div class="toast" toast-type=${this.type} ?is-hidden=${this.isHidden}>
        <div class="svg-icon">${n}</div>
        <div class="message">${this.message}</div>
        <div
          class="svg-icon cross-icon"
          @click=${()=>{this.hide()}}
        >
          ${dp}
        </div>
      </div>
    `}};gn.styles=[be`
      ${oe(ip)}
    `];_r([O({type:String})],gn.prototype,"type",2);_r([O({type:String})],gn.prototype,"message",2);_r([O({type:Number})],gn.prototype,"duration",2);_r([I()],gn.prototype,"isHidden",2);gn=_r([ve("nightjar-toast")],gn);const co=async(n,e,t,r,o,i=!1,s=[],a="")=>{const c={model:o,messages:[{role:"user",content:t}],temperature:r,stop:s},u=localStorage.getItem("[gpt]"+t);if(i&&u!==null)return console.log("Use cached output (text gen)"),await new Promise(f=>setTimeout(f,1e3)),{command:"finishTextGen",payload:{requestID:e,apiKey:n,result:u,prompt:t,detail:a}};const d="https://api.openai.com/v1/chat/completions",p={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Authorization:`Bearer ${n}`},body:JSON.stringify(c)};try{const h=await fetch(d,p),f=await h.json();if(h.status!==200||f.choices.length<1)throw Error("GPT API error"+JSON.stringify(f));const m={command:"finishTextGen",payload:{requestID:e,apiKey:n,result:f.choices[0].message.content,prompt:t,detail:a}};return i&&localStorage.getItem("[gpt]"+t)===null&&localStorage.setItem("[gpt]"+t,f.choices[0].message.content),m}catch(h){return{command:"error",payload:{requestID:e,originalCommand:"startTextGen",message:h}}}},pp=Ue.urls.wordflowEndpoint,mi=async(n,e,t,r,o,i,s=!1,a="")=>{const l=localStorage.getItem("[wordflow]"+e+t);if(s&&l!==null)return console.log("Use cached output (text gen)"),await new Promise(h=>setTimeout(h,1e3)),{command:"finishTextGen",payload:{requestID:"",apiKey:"",result:l,prompt:e+t,detail:a}};const c={prompt:e,text:t,temperature:r,userID:o,model:i},u=new URL(pp);u.searchParams.append("type","run");const d={method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)};try{const p=await fetch(u.toString(),d),h=await p.json();if(p.status!==200)return{command:"error",payload:{requestID:n,originalCommand:"startTextGen",message:h.message}};const f=h,m={command:"finishTextGen",payload:{requestID:"",apiKey:"",result:f.payload.result,prompt:f.payload.fullPrompt,detail:a}};return s&&localStorage.getItem("[wordflow]"+e+t)===null&&localStorage.setItem("[wordflow]"+e+t,f.payload.result),m}catch(p){return{command:"error",payload:{requestID:n,originalCommand:"startTextGen",message:p}}}};var pr=(n=>(n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n))(pr||{}),hr=(n=>(n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n))(hr||{});const mc=async(n,e,t,r,o=!1,i=[],s="")=>{const a=[{category:pr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:hr.BLOCK_ONLY_HIGH},{category:pr.HARM_CATEGORY_HARASSMENT,threshold:hr.BLOCK_ONLY_HIGH},{category:pr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:hr.BLOCK_ONLY_HIGH},{category:pr.HARM_CATEGORY_HATE_SPEECH,threshold:hr.BLOCK_ONLY_HIGH}],l={contents:[{parts:[{text:t}]}],safetySettings:a,generationConfig:{temperature:r,stopSequences:i}},c=localStorage.getItem("[gemini]"+t);if(o&&c!==null)return console.log("Use cached output (text gen)"),await new Promise(m=>setTimeout(m,1e3)),{command:"finishTextGen",payload:{requestID:e,apiKey:n,result:c,prompt:t,detail:s}};let d="https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";const p=new URLSearchParams;p.append("key",n),d+=`?${p.toString()}`;const h={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)};try{const f=await fetch(d,h),m=await f.json();if(f.status!==200)throw Error("Gemini API error"+JSON.stringify(m));if(m.candidates===void 0)throw console.error("Gemini API is blocked, feedback: ",m.promptFeedback.safetyRatings,m),Error("Gemini API Error"+JSON.stringify(m));const g=m.candidates[0].content.parts[0].text,y={command:"finishTextGen",payload:{requestID:e,apiKey:n,result:g,prompt:t,detail:s}};return o&&localStorage.getItem("[gemini]"+t)===null&&localStorage.setItem("[gemini]"+t,g),y}catch(f){return{command:"error",payload:{requestID:e,originalCommand:"startTextGen",message:f}}}},hp=`<p>Welcome to Wordflow, your new AI writing assistant! With Wordflow, you can easily run, discover, and share AI prompts. To run a prompt, simply click a button on the right menu bar. By default, it applies a stored prompt to the current paragraph. If you prefer, you can also select some text before clicking the button to use the selected text as the prompt's input.</p>
<p></p>
<p>Wordflow is highly customizable. To start editing the prompt, customizing your shortcut buttons, and configuring AI models (e.g., GPT 4 and Gemini Pro), simply click the gear button on the right.</p>
<p></p>
<p>Wordflow is also a social platform. You can explore trending prompts and easily add them to your library. You can also share your own prompts, allowing others to benefit from your creativity and ideas.</p>`;var Et=(n=>(n[n.HARM_CATEGORY_UNSPECIFIED=0]="HARM_CATEGORY_UNSPECIFIED",n[n.HARM_CATEGORY_DEROGATORY=1]="HARM_CATEGORY_DEROGATORY",n[n.HARM_CATEGORY_TOXICITY=2]="HARM_CATEGORY_TOXICITY",n[n.HARM_CATEGORY_VIOLENCE=3]="HARM_CATEGORY_VIOLENCE",n[n.HARM_CATEGORY_SEXUAL=4]="HARM_CATEGORY_SEXUAL",n[n.HARM_CATEGORY_MEDICAL=5]="HARM_CATEGORY_MEDICAL",n[n.HARM_CATEGORY_DANGEROUS=6]="HARM_CATEGORY_DANGEROUS",n))(Et||{}),Mt=(n=>(n[n.HARM_BLOCK_THRESHOLD_UNSPECIFIED=0]="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n[n.BLOCK_LOW_AND_ABOVE=1]="BLOCK_LOW_AND_ABOVE",n[n.BLOCK_MEDIUM_AND_ABOVE=2]="BLOCK_MEDIUM_AND_ABOVE",n[n.BLOCK_ONLY_HIGH=3]="BLOCK_ONLY_HIGH",n[n.BLOCK_NONE=4]="BLOCK_NONE",n))(Mt||{});const fp=async(n,e,t,r,o=!0,i=[],s="")=>{const a=[{category:Et.HARM_CATEGORY_DANGEROUS,threshold:Mt.BLOCK_ONLY_HIGH},{category:Et.HARM_CATEGORY_DEROGATORY,threshold:Mt.BLOCK_ONLY_HIGH},{category:Et.HARM_CATEGORY_MEDICAL,threshold:Mt.BLOCK_ONLY_HIGH},{category:Et.HARM_CATEGORY_SEXUAL,threshold:Mt.BLOCK_ONLY_HIGH},{category:Et.HARM_CATEGORY_TOXICITY,threshold:Mt.BLOCK_ONLY_HIGH},{category:Et.HARM_CATEGORY_UNSPECIFIED,threshold:Mt.BLOCK_ONLY_HIGH},{category:Et.HARM_CATEGORY_VIOLENCE,threshold:Mt.BLOCK_ONLY_HIGH}],l={prompt:{text:t},safetySettings:a,temperature:r,stopSequences:i},c=localStorage.getItem("[palm]"+t);if(o&&c!==null)return console.log("Use cached output (text gen)"),await new Promise(m=>setTimeout(m,1e3)),{command:"finishTextGen",payload:{requestID:e,apiKey:n,result:c,prompt:t,detail:s}};let d="https://generativelanguage.googleapis.com/v1beta2/models/text-bison-001:generateText";const p=new URLSearchParams;p.append("key",n),d+=`?${p.toString()}`;const h={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)};try{const f=await fetch(d,h),m=await f.json();if(f.status!==200)throw Error("PaLM API error"+JSON.stringify(m));if(m.candidates===void 0)throw console.error("PaLM API is blocked, feedback: ",m.filters[0],m),Error("PaLM API Error"+JSON.stringify(m));const g={command:"finishTextGen",payload:{requestID:e,apiKey:n,result:m.candidates[0].output,prompt:t,detail:s}};return localStorage.getItem("[palm]"+t)===null&&localStorage.setItem("[palm]"+t,m.candidates[0].output),g}catch(f){return{command:"error",payload:{requestID:e,originalCommand:"startTextGen",message:f}}}},mp=`.modal-auth{width:100%;height:100%;position:absolute;top:0;left:0;z-index:10;background-color:#00000080;display:none;animation:fade-in .15s ease-in-out}.modal-auth.displayed{display:flex}.dialog-window{padding:20px;background-color:#fff;box-shadow:var(--shadow-border-large);border-radius:10px;width:max-content;max-width:calc(100% - 40px);box-sizing:border-box;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;gap:8px;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.header{font-weight:600}.content{font-size:var(--font-d2);margin:4px 0 2px;width:100%;display:flex;flex-direction:column;gap:5px}.content strong{font-weight:600}.content .row{display:flex;flex-direction:column;gap:3px}.content .row .input-form{display:flex;flex-direction:row;gap:5px}.content .row .input-form input{box-sizing:border-box;width:100%}.content .row .input-form button{font-size:var(--font-d2);padding:3px 5px;border-radius:3px}.content .row a{color:var(--blue-600)}.content .row .message{opacity:0;font-size:var(--font-d2);color:var(--blue-600);transition:opacity .15s;position:relative;display:flex;width:max-content}.content .row .message.displayed{opacity:1}.content .row .message.loading:after{display:inline-block;position:absolute;left:100%;top:0;animation:dotting steps(1,end) 1s infinite;content:""}.content .row .message.error{color:var(--red-600)}.content .row .message.success{color:var(--green-600)}.footer{width:100%;display:flex;flex-direction:row;justify-content:flex-end;flex-wrap:wrap;gap:6px;font-size:var(--font-d1)}button{background:none;color:inherit;border:none;font:inherit;cursor:pointer;outline:inherit;line-height:1;background-color:var(--gray-200);padding:4px 8px;border-radius:4px;display:flex;align-items:center;gap:4px;flex-grow:0;transition:background-color .15s ease-in-out}button:hover{background-color:var(--gray-300)}button:active{background-color:var(--gray-400)}button.primary{background-color:var(--blue-500);border-color:var(--blue-500);color:#fff}button.primary:hover{background-color:var(--blue-400)}button.primary:active{background-color:var(--blue-600)}button[disabled]{background-color:var(--gray-200);border-color:var(--gray-200);color:var(--gray-600);cursor:not-allowed}button[disabled]:hover,button[disabled]:active{background-color:var(--gray-200)}@keyframes dotting{0%{content:""}25%{content:"."}50%{content:".."}75%{content:"..."}to{content:""}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}
`;var gp=Object.defineProperty,yp=Object.getOwnPropertyDescriptor,zr=(n,e,t,r)=>{for(var o=r>1?void 0:r?yp(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&gp(e,t,o),o};const bp="API key added.";let yn=class extends Q{constructor(){super(),this.apiKey="",this.textGenWorkerRequestID=1,this.initData=async()=>{},this.authVerificationFailed=(n,e,t)=>{e.classList.remove("loading"),e.classList.remove("success"),e.classList.add("error"),this.modelMessageMap[n]="Invalid, try a different key",this.requestUpdate(),console.error(t)},this.authVerificationSucceeded=(n,e,t)=>{localStorage.setItem(`${n}APIKey`,t);const r=new CustomEvent("api-key-added",{detail:{model:n,apiKey:t}});this.dispatchEvent(r),this.modelSetMap[n]=!0,this.modelMessageMap[n]=bp,e.classList.remove("loading"),e.classList.remove("error"),e.classList.add("success"),this.requestUpdate()},this.submitButtonClicked=n=>{const e=this.renderRoot.querySelector(`#message-${n}`),t=this.renderRoot.querySelector(`#api-input-${n}`);if(e===null||t===null)throw Error("Can't locate the input elements");const r=t.value;if(r===void 0||r==="")return;e.classList.remove("error"),e.classList.remove("success"),e.classList.add("displayed"),e.classList.add("loading"),this.modelMessageMap[n]="Verifying",this.requestUpdate();const o=`auth-${this.textGenWorkerRequestID++}`,i="The color of sky is",s=.8;switch(n){case"palm":{fp(r,o,i,s,!1).then(a=>{this.textGenMessageHandler(n,e,a)});break}case"gpt":{co(r,o,i,s,"gpt-3.5-turbo",!1).then(a=>{console.log(a),this.textGenMessageHandler(n,e,a)});break}default:console.error(`Unknown model ${n}`)}},this.doneButtonClicked=()=>{var n;(n=this.modalElement)==null||n.classList.remove("displayed")},this.textGenMessageHandler=(n,e,t)=>{switch(t.command){case"finishTextGen":{t.payload.requestID.includes("auth")&&this.authVerificationSucceeded(n,e,t.payload.apiKey);break}case"error":{t.payload.originalCommand==="startTextGen"&&this.authVerificationFailed(n,e,t.payload.message);break}default:{console.error("TextGen message handler: unknown message");break}}},this.modelSetMap={palm:!1,gpt:!1},this.modelMessageMap={palm:"Verifying...",gpt:"Verifying..."}}connectedCallback(){super.connectedCallback(),this.updateComplete.then(n=>{const e=["palm","gpt"];for(const r of e){const o=localStorage.getItem(`${r}APIKey`);if(o===null)this.modelSetMap[r]=!1;else{this.modelSetMap[r]=!0;const i=new CustomEvent("api-key-added",{detail:{model:r,apiKey:o}});this.dispatchEvent(i);break}}this.requestUpdate(),Object.values(this.modelSetMap).some(r=>r)||setTimeout(()=>{var r;(r=this.modalElement)==null||r.classList.add("displayed")},300)})}willUpdate(n){var e;n.has("apiKey")&&this.apiKey!==""&&((e=this.modalElement)==null||e.classList.remove("displayed"))}render(){const n=e=>this.modelSetMap[e]?"Edit":"Add";return M`
      <div class="modal-auth">
        <div class="dialog-window">
          <div class="header">Enter At Least an LLM API Key</div>

          <div class="content">
            <div class="row">
              <span class="info-text">
                <strong>PaLM 2</strong> (<a
                  href="https://makersuite.google.com/app/apikey"
                  target="_blank"
                  >reference</a
                >)
              </span>
              <div class="input-form">
                <input id="api-input-palm" placeholder="API Key" />
                <button
                  class="primary"
                  @click="${()=>this.submitButtonClicked("palm")}"
                >
                  ${n("palm")}
                </button>
              </div>
              <div class="message" id="message-palm">
                ${this.modelMessageMap.palm}
              </div>
            </div>

            <div class="row">
              <span class="info-text">
                <strong>GPT 3.5</strong> (<a
                  href="https://platform.openai.com/docs/guides/gpt"
                  target="_blank"
                  >reference</a
                >)
              </span>
              <div class="input-form">
                <input id="api-input-gpt" placeholder="API Key" />
                <button
                  class="primary"
                  @click="${()=>this.submitButtonClicked("gpt")}"
                >
                  ${n("gpt")}
                </button>
              </div>
              <div class="message" id="message-gpt">
                ${this.modelMessageMap.gpt}
              </div>
            </div>
          </div>

          <div class="footer">
            <button
              class="primary"
              ?disabled=${!Object.values(this.modelSetMap).some(e=>e)}
              @click="${()=>this.doneButtonClicked()}"
            >
              Done
            </button>
            <button disabled>Cancel</button>
          </div>
        </div>
      </div>
    `}};yn.styles=[be`
      ${oe(mp)}
    `];zr([O({type:String})],yn.prototype,"apiKey",2);zr([Y(".modal-auth")],yn.prototype,"modalElement",2);zr([I()],yn.prototype,"modelSetMap",2);zr([I()],yn.prototype,"modelMessageMap",2);yn=zr([ve("wordflow-modal-auth")],yn);function vp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gc={exports:{}};(function(n){var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},t=-1,r=1,o=0;e.Diff=function(i,s){return[i,s]},e.prototype.diff_main=function(i,s,a,l){typeof l>"u"&&(this.Diff_Timeout<=0?l=Number.MAX_VALUE:l=new Date().getTime()+this.Diff_Timeout*1e3);var c=l;if(i==null||s==null)throw new Error("Null input. (diff_main)");if(i==s)return i?[new e.Diff(o,i)]:[];typeof a>"u"&&(a=!0);var u=a,d=this.diff_commonPrefix(i,s),p=i.substring(0,d);i=i.substring(d),s=s.substring(d),d=this.diff_commonSuffix(i,s);var h=i.substring(i.length-d);i=i.substring(0,i.length-d),s=s.substring(0,s.length-d);var f=this.diff_compute_(i,s,u,c);return p&&f.unshift(new e.Diff(o,p)),h&&f.push(new e.Diff(o,h)),this.diff_cleanupMerge(f),f},e.prototype.diff_compute_=function(i,s,a,l){var c;if(!i)return[new e.Diff(r,s)];if(!s)return[new e.Diff(t,i)];var u=i.length>s.length?i:s,d=i.length>s.length?s:i,p=u.indexOf(d);if(p!=-1)return c=[new e.Diff(r,u.substring(0,p)),new e.Diff(o,d),new e.Diff(r,u.substring(p+d.length))],i.length>s.length&&(c[0][0]=c[2][0]=t),c;if(d.length==1)return[new e.Diff(t,i),new e.Diff(r,s)];var h=this.diff_halfMatch_(i,s);if(h){var f=h[0],m=h[1],g=h[2],y=h[3],b=h[4],v=this.diff_main(f,g,a,l),k=this.diff_main(m,y,a,l);return v.concat([new e.Diff(o,b)],k)}return a&&i.length>100&&s.length>100?this.diff_lineMode_(i,s,l):this.diff_bisect_(i,s,l)},e.prototype.diff_lineMode_=function(i,s,a){var l=this.diff_linesToChars_(i,s);i=l.chars1,s=l.chars2;var c=l.lineArray,u=this.diff_main(i,s,!1,a);this.diff_charsToLines_(u,c),this.diff_cleanupSemantic(u),u.push(new e.Diff(o,""));for(var d=0,p=0,h=0,f="",m="";d<u.length;){switch(u[d][0]){case r:h++,m+=u[d][1];break;case t:p++,f+=u[d][1];break;case o:if(p>=1&&h>=1){u.splice(d-p-h,p+h),d=d-p-h;for(var g=this.diff_main(f,m,!1,a),y=g.length-1;y>=0;y--)u.splice(d,0,g[y]);d=d+g.length}h=0,p=0,f="",m="";break}d++}return u.pop(),u},e.prototype.diff_bisect_=function(i,s,a){for(var l=i.length,c=s.length,u=Math.ceil((l+c)/2),d=u,p=2*u,h=new Array(p),f=new Array(p),m=0;m<p;m++)h[m]=-1,f[m]=-1;h[d+1]=0,f[d+1]=0;for(var g=l-c,y=g%2!=0,b=0,v=0,k=0,x=0,C=0;C<u&&!(new Date().getTime()>a);C++){for(var A=-C+b;A<=C-v;A+=2){var $=d+A,E;A==-C||A!=C&&h[$-1]<h[$+1]?E=h[$+1]:E=h[$-1]+1;for(var z=E-A;E<l&&z<c&&i.charAt(E)==s.charAt(z);)E++,z++;if(h[$]=E,E>l)v+=2;else if(z>c)b+=2;else if(y){var S=d+g-A;if(S>=0&&S<p&&f[S]!=-1){var L=l-f[S];if(E>=L)return this.diff_bisectSplit_(i,s,E,z,a)}}}for(var U=-C+k;U<=C-x;U+=2){var S=d+U,L;U==-C||U!=C&&f[S-1]<f[S+1]?L=f[S+1]:L=f[S-1]+1;for(var V=L-U;L<l&&V<c&&i.charAt(l-L-1)==s.charAt(c-V-1);)L++,V++;if(f[S]=L,L>l)x+=2;else if(V>c)k+=2;else if(!y){var $=d+g-U;if($>=0&&$<p&&h[$]!=-1){var E=h[$],z=d+E-$;if(L=l-L,E>=L)return this.diff_bisectSplit_(i,s,E,z,a)}}}}return[new e.Diff(t,i),new e.Diff(r,s)]},e.prototype.diff_bisectSplit_=function(i,s,a,l,c){var u=i.substring(0,a),d=s.substring(0,l),p=i.substring(a),h=s.substring(l),f=this.diff_main(u,d,!1,c),m=this.diff_main(p,h,!1,c);return f.concat(m)},e.prototype.diff_linesToChars_=function(i,s){var a=[],l={};a[0]="";function c(h){for(var f="",m=0,g=-1,y=a.length;g<h.length-1;){g=h.indexOf(`
`,m),g==-1&&(g=h.length-1);var b=h.substring(m,g+1);(l.hasOwnProperty?l.hasOwnProperty(b):l[b]!==void 0)?f+=String.fromCharCode(l[b]):(y==u&&(b=h.substring(m),g=h.length),f+=String.fromCharCode(y),l[b]=y,a[y++]=b),m=g+1}return f}var u=4e4,d=c(i);u=65535;var p=c(s);return{chars1:d,chars2:p,lineArray:a}},e.prototype.diff_charsToLines_=function(i,s){for(var a=0;a<i.length;a++){for(var l=i[a][1],c=[],u=0;u<l.length;u++)c[u]=s[l.charCodeAt(u)];i[a][1]=c.join("")}},e.prototype.diff_commonPrefix=function(i,s){if(!i||!s||i.charAt(0)!=s.charAt(0))return 0;for(var a=0,l=Math.min(i.length,s.length),c=l,u=0;a<c;)i.substring(u,c)==s.substring(u,c)?(a=c,u=a):l=c,c=Math.floor((l-a)/2+a);return c},e.prototype.diff_commonSuffix=function(i,s){if(!i||!s||i.charAt(i.length-1)!=s.charAt(s.length-1))return 0;for(var a=0,l=Math.min(i.length,s.length),c=l,u=0;a<c;)i.substring(i.length-c,i.length-u)==s.substring(s.length-c,s.length-u)?(a=c,u=a):l=c,c=Math.floor((l-a)/2+a);return c},e.prototype.diff_commonOverlap_=function(i,s){var a=i.length,l=s.length;if(a==0||l==0)return 0;a>l?i=i.substring(a-l):a<l&&(s=s.substring(0,a));var c=Math.min(a,l);if(i==s)return c;for(var u=0,d=1;;){var p=i.substring(c-d),h=s.indexOf(p);if(h==-1)return u;d+=h,(h==0||i.substring(c-d)==s.substring(0,d))&&(u=d,d++)}},e.prototype.diff_halfMatch_=function(i,s){if(this.Diff_Timeout<=0)return null;var a=i.length>s.length?i:s,l=i.length>s.length?s:i;if(a.length<4||l.length*2<a.length)return null;var c=this;function u(v,k,x){for(var C=v.substring(x,x+Math.floor(v.length/4)),A=-1,$="",E,z,S,L;(A=k.indexOf(C,A+1))!=-1;){var U=c.diff_commonPrefix(v.substring(x),k.substring(A)),V=c.diff_commonSuffix(v.substring(0,x),k.substring(0,A));$.length<V+U&&($=k.substring(A-V,A)+k.substring(A,A+U),E=v.substring(0,x-V),z=v.substring(x+U),S=k.substring(0,A-V),L=k.substring(A+U))}return $.length*2>=v.length?[E,z,S,L,$]:null}var d=u(a,l,Math.ceil(a.length/4)),p=u(a,l,Math.ceil(a.length/2)),h;if(!d&&!p)return null;p?d?h=d[4].length>p[4].length?d:p:h=p:h=d;var f,m,g,y;i.length>s.length?(f=h[0],m=h[1],g=h[2],y=h[3]):(g=h[0],y=h[1],f=h[2],m=h[3]);var b=h[4];return[f,m,g,y,b]},e.prototype.diff_cleanupSemantic=function(i){for(var s=!1,a=[],l=0,c=null,u=0,d=0,p=0,h=0,f=0;u<i.length;)i[u][0]==o?(a[l++]=u,d=h,p=f,h=0,f=0,c=i[u][1]):(i[u][0]==r?h+=i[u][1].length:f+=i[u][1].length,c&&c.length<=Math.max(d,p)&&c.length<=Math.max(h,f)&&(i.splice(a[l-1],0,new e.Diff(t,c)),i[a[l-1]+1][0]=r,l--,l--,u=l>0?a[l-1]:-1,d=0,p=0,h=0,f=0,c=null,s=!0)),u++;for(s&&this.diff_cleanupMerge(i),this.diff_cleanupSemanticLossless(i),u=1;u<i.length;){if(i[u-1][0]==t&&i[u][0]==r){var m=i[u-1][1],g=i[u][1],y=this.diff_commonOverlap_(m,g),b=this.diff_commonOverlap_(g,m);y>=b?(y>=m.length/2||y>=g.length/2)&&(i.splice(u,0,new e.Diff(o,g.substring(0,y))),i[u-1][1]=m.substring(0,m.length-y),i[u+1][1]=g.substring(y),u++):(b>=m.length/2||b>=g.length/2)&&(i.splice(u,0,new e.Diff(o,m.substring(0,b))),i[u-1][0]=r,i[u-1][1]=g.substring(0,g.length-b),i[u+1][0]=t,i[u+1][1]=m.substring(b),u++),u++}u++}},e.prototype.diff_cleanupSemanticLossless=function(i){function s(b,v){if(!b||!v)return 6;var k=b.charAt(b.length-1),x=v.charAt(0),C=k.match(e.nonAlphaNumericRegex_),A=x.match(e.nonAlphaNumericRegex_),$=C&&k.match(e.whitespaceRegex_),E=A&&x.match(e.whitespaceRegex_),z=$&&k.match(e.linebreakRegex_),S=E&&x.match(e.linebreakRegex_),L=z&&b.match(e.blanklineEndRegex_),U=S&&v.match(e.blanklineStartRegex_);return L||U?5:z||S?4:C&&!$&&E?3:$||E?2:C||A?1:0}for(var a=1;a<i.length-1;){if(i[a-1][0]==o&&i[a+1][0]==o){var l=i[a-1][1],c=i[a][1],u=i[a+1][1],d=this.diff_commonSuffix(l,c);if(d){var p=c.substring(c.length-d);l=l.substring(0,l.length-d),c=p+c.substring(0,c.length-d),u=p+u}for(var h=l,f=c,m=u,g=s(l,c)+s(c,u);c.charAt(0)===u.charAt(0);){l+=c.charAt(0),c=c.substring(1)+u.charAt(0),u=u.substring(1);var y=s(l,c)+s(c,u);y>=g&&(g=y,h=l,f=c,m=u)}i[a-1][1]!=h&&(h?i[a-1][1]=h:(i.splice(a-1,1),a--),i[a][1]=f,m?i[a+1][1]=m:(i.splice(a+1,1),a--))}a++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\s/,e.linebreakRegex_=/[\r\n]/,e.blanklineEndRegex_=/\n\r?\n$/,e.blanklineStartRegex_=/^\r?\n\r?\n/,e.prototype.diff_cleanupEfficiency=function(i){for(var s=!1,a=[],l=0,c=null,u=0,d=!1,p=!1,h=!1,f=!1;u<i.length;)i[u][0]==o?(i[u][1].length<this.Diff_EditCost&&(h||f)?(a[l++]=u,d=h,p=f,c=i[u][1]):(l=0,c=null),h=f=!1):(i[u][0]==t?f=!0:h=!0,c&&(d&&p&&h&&f||c.length<this.Diff_EditCost/2&&d+p+h+f==3)&&(i.splice(a[l-1],0,new e.Diff(t,c)),i[a[l-1]+1][0]=r,l--,c=null,d&&p?(h=f=!0,l=0):(l--,u=l>0?a[l-1]:-1,h=f=!1),s=!0)),u++;s&&this.diff_cleanupMerge(i)},e.prototype.diff_cleanupMerge=function(i){i.push(new e.Diff(o,""));for(var s=0,a=0,l=0,c="",u="",d;s<i.length;)switch(i[s][0]){case r:l++,u+=i[s][1],s++;break;case t:a++,c+=i[s][1],s++;break;case o:a+l>1?(a!==0&&l!==0&&(d=this.diff_commonPrefix(u,c),d!==0&&(s-a-l>0&&i[s-a-l-1][0]==o?i[s-a-l-1][1]+=u.substring(0,d):(i.splice(0,0,new e.Diff(o,u.substring(0,d))),s++),u=u.substring(d),c=c.substring(d)),d=this.diff_commonSuffix(u,c),d!==0&&(i[s][1]=u.substring(u.length-d)+i[s][1],u=u.substring(0,u.length-d),c=c.substring(0,c.length-d))),s-=a+l,i.splice(s,a+l),c.length&&(i.splice(s,0,new e.Diff(t,c)),s++),u.length&&(i.splice(s,0,new e.Diff(r,u)),s++),s++):s!==0&&i[s-1][0]==o?(i[s-1][1]+=i[s][1],i.splice(s,1)):s++,l=0,a=0,c="",u="";break}i[i.length-1][1]===""&&i.pop();var p=!1;for(s=1;s<i.length-1;)i[s-1][0]==o&&i[s+1][0]==o&&(i[s][1].substring(i[s][1].length-i[s-1][1].length)==i[s-1][1]?(i[s][1]=i[s-1][1]+i[s][1].substring(0,i[s][1].length-i[s-1][1].length),i[s+1][1]=i[s-1][1]+i[s+1][1],i.splice(s-1,1),p=!0):i[s][1].substring(0,i[s+1][1].length)==i[s+1][1]&&(i[s-1][1]+=i[s+1][1],i[s][1]=i[s][1].substring(i[s+1][1].length)+i[s+1][1],i.splice(s+1,1),p=!0)),s++;p&&this.diff_cleanupMerge(i)},e.prototype.diff_xIndex=function(i,s){var a=0,l=0,c=0,u=0,d;for(d=0;d<i.length&&(i[d][0]!==r&&(a+=i[d][1].length),i[d][0]!==t&&(l+=i[d][1].length),!(a>s));d++)c=a,u=l;return i.length!=d&&i[d][0]===t?u:u+(s-c)},e.prototype.diff_prettyHtml=function(i){for(var s=[],a=/&/g,l=/</g,c=/>/g,u=/\n/g,d=0;d<i.length;d++){var p=i[d][0],h=i[d][1],f=h.replace(a,"&amp;").replace(l,"&lt;").replace(c,"&gt;").replace(u,"&para;<br>");switch(p){case r:s[d]='<ins style="background:#e6ffe6;">'+f+"</ins>";break;case t:s[d]='<del style="background:#ffe6e6;">'+f+"</del>";break;case o:s[d]="<span>"+f+"</span>";break}}return s.join("")},e.prototype.diff_text1=function(i){for(var s=[],a=0;a<i.length;a++)i[a][0]!==r&&(s[a]=i[a][1]);return s.join("")},e.prototype.diff_text2=function(i){for(var s=[],a=0;a<i.length;a++)i[a][0]!==t&&(s[a]=i[a][1]);return s.join("")},e.prototype.diff_levenshtein=function(i){for(var s=0,a=0,l=0,c=0;c<i.length;c++){var u=i[c][0],d=i[c][1];switch(u){case r:a+=d.length;break;case t:l+=d.length;break;case o:s+=Math.max(a,l),a=0,l=0;break}}return s+=Math.max(a,l),s},e.prototype.diff_toDelta=function(i){for(var s=[],a=0;a<i.length;a++)switch(i[a][0]){case r:s[a]="+"+encodeURI(i[a][1]);break;case t:s[a]="-"+i[a][1].length;break;case o:s[a]="="+i[a][1].length;break}return s.join("	").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(i,s){for(var a=[],l=0,c=0,u=s.split(/\t/g),d=0;d<u.length;d++){var p=u[d].substring(1);switch(u[d].charAt(0)){case"+":try{a[l++]=new e.Diff(r,decodeURI(p))}catch{throw new Error("Illegal escape in diff_fromDelta: "+p)}break;case"-":case"=":var h=parseInt(p,10);if(isNaN(h)||h<0)throw new Error("Invalid number in diff_fromDelta: "+p);var f=i.substring(c,c+=h);u[d].charAt(0)=="="?a[l++]=new e.Diff(o,f):a[l++]=new e.Diff(t,f);break;default:if(u[d])throw new Error("Invalid diff operation in diff_fromDelta: "+u[d])}}if(c!=i.length)throw new Error("Delta length ("+c+") does not equal source text length ("+i.length+").");return a},e.prototype.match_main=function(i,s,a){if(i==null||s==null||a==null)throw new Error("Null input. (match_main)");return a=Math.max(0,Math.min(a,i.length)),i==s?0:i.length?i.substring(a,a+s.length)==s?a:this.match_bitap_(i,s,a):-1},e.prototype.match_bitap_=function(i,s,a){if(s.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var l=this.match_alphabet_(s),c=this;function u(E,z){var S=E/s.length,L=Math.abs(a-z);return c.Match_Distance?S+L/c.Match_Distance:L?1:S}var d=this.Match_Threshold,p=i.indexOf(s,a);p!=-1&&(d=Math.min(u(0,p),d),p=i.lastIndexOf(s,a+s.length),p!=-1&&(d=Math.min(u(0,p),d)));var h=1<<s.length-1;p=-1;for(var f,m,g=s.length+i.length,y,b=0;b<s.length;b++){for(f=0,m=g;f<m;)u(b,a+m)<=d?f=m:g=m,m=Math.floor((g-f)/2+f);g=m;var v=Math.max(1,a-m+1),k=Math.min(a+m,i.length)+s.length,x=Array(k+2);x[k+1]=(1<<b)-1;for(var C=k;C>=v;C--){var A=l[i.charAt(C-1)];if(b===0?x[C]=(x[C+1]<<1|1)&A:x[C]=(x[C+1]<<1|1)&A|((y[C+1]|y[C])<<1|1)|y[C+1],x[C]&h){var $=u(b,C-1);if($<=d)if(d=$,p=C-1,p>a)v=Math.max(1,2*a-p);else break}}if(u(b+1,a)>d)break;y=x}return p},e.prototype.match_alphabet_=function(i){for(var s={},a=0;a<i.length;a++)s[i.charAt(a)]=0;for(var a=0;a<i.length;a++)s[i.charAt(a)]|=1<<i.length-a-1;return s},e.prototype.patch_addContext_=function(i,s){if(s.length!=0){if(i.start2===null)throw Error("patch not initialized");for(var a=s.substring(i.start2,i.start2+i.length1),l=0;s.indexOf(a)!=s.lastIndexOf(a)&&a.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)l+=this.Patch_Margin,a=s.substring(i.start2-l,i.start2+i.length1+l);l+=this.Patch_Margin;var c=s.substring(i.start2-l,i.start2);c&&i.diffs.unshift(new e.Diff(o,c));var u=s.substring(i.start2+i.length1,i.start2+i.length1+l);u&&i.diffs.push(new e.Diff(o,u)),i.start1-=c.length,i.start2-=c.length,i.length1+=c.length+u.length,i.length2+=c.length+u.length}},e.prototype.patch_make=function(i,s,a){var l,c;if(typeof i=="string"&&typeof s=="string"&&typeof a>"u")l=i,c=this.diff_main(l,s,!0),c.length>2&&(this.diff_cleanupSemantic(c),this.diff_cleanupEfficiency(c));else if(i&&typeof i=="object"&&typeof s>"u"&&typeof a>"u")c=i,l=this.diff_text1(c);else if(typeof i=="string"&&s&&typeof s=="object"&&typeof a>"u")l=i,c=s;else if(typeof i=="string"&&typeof s=="string"&&a&&typeof a=="object")l=i,c=a;else throw new Error("Unknown call format to patch_make.");if(c.length===0)return[];for(var u=[],d=new e.patch_obj,p=0,h=0,f=0,m=l,g=l,y=0;y<c.length;y++){var b=c[y][0],v=c[y][1];switch(!p&&b!==o&&(d.start1=h,d.start2=f),b){case r:d.diffs[p++]=c[y],d.length2+=v.length,g=g.substring(0,f)+v+g.substring(f);break;case t:d.length1+=v.length,d.diffs[p++]=c[y],g=g.substring(0,f)+g.substring(f+v.length);break;case o:v.length<=2*this.Patch_Margin&&p&&c.length!=y+1?(d.diffs[p++]=c[y],d.length1+=v.length,d.length2+=v.length):v.length>=2*this.Patch_Margin&&p&&(this.patch_addContext_(d,m),u.push(d),d=new e.patch_obj,p=0,m=g,h=f);break}b!==r&&(h+=v.length),b!==t&&(f+=v.length)}return p&&(this.patch_addContext_(d,m),u.push(d)),u},e.prototype.patch_deepCopy=function(i){for(var s=[],a=0;a<i.length;a++){var l=i[a],c=new e.patch_obj;c.diffs=[];for(var u=0;u<l.diffs.length;u++)c.diffs[u]=new e.Diff(l.diffs[u][0],l.diffs[u][1]);c.start1=l.start1,c.start2=l.start2,c.length1=l.length1,c.length2=l.length2,s[a]=c}return s},e.prototype.patch_apply=function(i,s){if(i.length==0)return[s,[]];i=this.patch_deepCopy(i);var a=this.patch_addPadding(i);s=a+s+a,this.patch_splitMax(i);for(var l=0,c=[],u=0;u<i.length;u++){var d=i[u].start2+l,p=this.diff_text1(i[u].diffs),h,f=-1;if(p.length>this.Match_MaxBits?(h=this.match_main(s,p.substring(0,this.Match_MaxBits),d),h!=-1&&(f=this.match_main(s,p.substring(p.length-this.Match_MaxBits),d+p.length-this.Match_MaxBits),(f==-1||h>=f)&&(h=-1))):h=this.match_main(s,p,d),h==-1)c[u]=!1,l-=i[u].length2-i[u].length1;else{c[u]=!0,l=h-d;var m;if(f==-1?m=s.substring(h,h+p.length):m=s.substring(h,f+this.Match_MaxBits),p==m)s=s.substring(0,h)+this.diff_text2(i[u].diffs)+s.substring(h+p.length);else{var g=this.diff_main(p,m,!1);if(p.length>this.Match_MaxBits&&this.diff_levenshtein(g)/p.length>this.Patch_DeleteThreshold)c[u]=!1;else{this.diff_cleanupSemanticLossless(g);for(var y=0,b,v=0;v<i[u].diffs.length;v++){var k=i[u].diffs[v];k[0]!==o&&(b=this.diff_xIndex(g,y)),k[0]===r?s=s.substring(0,h+b)+k[1]+s.substring(h+b):k[0]===t&&(s=s.substring(0,h+b)+s.substring(h+this.diff_xIndex(g,y+k[1].length))),k[0]!==t&&(y+=k[1].length)}}}}}return s=s.substring(a.length,s.length-a.length),[s,c]},e.prototype.patch_addPadding=function(i){for(var s=this.Patch_Margin,a="",l=1;l<=s;l++)a+=String.fromCharCode(l);for(var l=0;l<i.length;l++)i[l].start1+=s,i[l].start2+=s;var c=i[0],u=c.diffs;if(u.length==0||u[0][0]!=o)u.unshift(new e.Diff(o,a)),c.start1-=s,c.start2-=s,c.length1+=s,c.length2+=s;else if(s>u[0][1].length){var d=s-u[0][1].length;u[0][1]=a.substring(u[0][1].length)+u[0][1],c.start1-=d,c.start2-=d,c.length1+=d,c.length2+=d}if(c=i[i.length-1],u=c.diffs,u.length==0||u[u.length-1][0]!=o)u.push(new e.Diff(o,a)),c.length1+=s,c.length2+=s;else if(s>u[u.length-1][1].length){var d=s-u[u.length-1][1].length;u[u.length-1][1]+=a.substring(0,d),c.length1+=d,c.length2+=d}return a},e.prototype.patch_splitMax=function(i){for(var s=this.Match_MaxBits,a=0;a<i.length;a++)if(!(i[a].length1<=s)){var l=i[a];i.splice(a--,1);for(var c=l.start1,u=l.start2,d="";l.diffs.length!==0;){var p=new e.patch_obj,h=!0;for(p.start1=c-d.length,p.start2=u-d.length,d!==""&&(p.length1=p.length2=d.length,p.diffs.push(new e.Diff(o,d)));l.diffs.length!==0&&p.length1<s-this.Patch_Margin;){var f=l.diffs[0][0],m=l.diffs[0][1];f===r?(p.length2+=m.length,u+=m.length,p.diffs.push(l.diffs.shift()),h=!1):f===t&&p.diffs.length==1&&p.diffs[0][0]==o&&m.length>2*s?(p.length1+=m.length,c+=m.length,h=!1,p.diffs.push(new e.Diff(f,m)),l.diffs.shift()):(m=m.substring(0,s-p.length1-this.Patch_Margin),p.length1+=m.length,c+=m.length,f===o?(p.length2+=m.length,u+=m.length):h=!1,p.diffs.push(new e.Diff(f,m)),m==l.diffs[0][1]?l.diffs.shift():l.diffs[0][1]=l.diffs[0][1].substring(m.length))}d=this.diff_text2(p.diffs),d=d.substring(d.length-this.Patch_Margin);var g=this.diff_text1(l.diffs).substring(0,this.Patch_Margin);g!==""&&(p.length1+=g.length,p.length2+=g.length,p.diffs.length!==0&&p.diffs[p.diffs.length-1][0]===o?p.diffs[p.diffs.length-1][1]+=g:p.diffs.push(new e.Diff(o,g))),h||i.splice(++a,0,p)}}},e.prototype.patch_toText=function(i){for(var s=[],a=0;a<i.length;a++)s[a]=i[a];return s.join("")},e.prototype.patch_fromText=function(i){var s=[];if(!i)return s;for(var a=i.split(`
`),l=0,c=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;l<a.length;){var u=a[l].match(c);if(!u)throw new Error("Invalid patch string: "+a[l]);var d=new e.patch_obj;for(s.push(d),d.start1=parseInt(u[1],10),u[2]===""?(d.start1--,d.length1=1):u[2]=="0"?d.length1=0:(d.start1--,d.length1=parseInt(u[2],10)),d.start2=parseInt(u[3],10),u[4]===""?(d.start2--,d.length2=1):u[4]=="0"?d.length2=0:(d.start2--,d.length2=parseInt(u[4],10)),l++;l<a.length;){var p=a[l].charAt(0);try{var h=decodeURI(a[l].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+h)}if(p=="-")d.diffs.push(new e.Diff(t,h));else if(p=="+")d.diffs.push(new e.Diff(r,h));else if(p==" ")d.diffs.push(new e.Diff(o,h));else{if(p=="@")break;if(p!=="")throw new Error('Invalid patch mode "'+p+'" in: '+h)}l++}}return s},e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},e.patch_obj.prototype.toString=function(){var i,s;this.length1===0?i=this.start1+",0":this.length1==1?i=this.start1+1:i=this.start1+1+","+this.length1,this.length2===0?s=this.start2+",0":this.length2==1?s=this.start2+1:s=this.start2+1+","+this.length2;for(var a=["@@ -"+i+" +"+s+` @@
`],l,c=0;c<this.diffs.length;c++){switch(this.diffs[c][0]){case r:l="+";break;case t:l="-";break;case o:l=" ";break}a[c+1]=l+encodeURI(this.diffs[c][1])+`
`}return a.join("").replace(/%20/g," ")},n.exports=e,n.exports.diff_match_patch=e,n.exports.DIFF_DELETE=t,n.exports.DIFF_INSERT=r,n.exports.DIFF_EQUAL=o})(gc);var Dp=gc.exports;const wp=vp(Dp);function me(n){this.content=n}me.prototype={constructor:me,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,o=r.find(n),i=r.content.slice();return o==-1?i.push(t||n,e):(i[o+1]=e,t&&(i[o]=t)),new me(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new me(t)},addToStart:function(n,e){return new me([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new me(t)},addBefore:function(n,e,t){var r=this.remove(e),o=r.content.slice(),i=r.find(n);return o.splice(i==-1?o.length:i,0,e,t),new me(o)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=me.from(n),n.size?new me(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=me.from(n),n.size?new me(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=me.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};me.from=function(n){if(n instanceof me)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new me(e)};function yc(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let o=n.child(r),i=e.child(r);if(o==i){t+=o.nodeSize;continue}if(!o.sameMarkup(i))return t;if(o.isText&&o.text!=i.text){for(let s=0;o.text[s]==i.text[s];s++)t++;return t}if(o.content.size||i.content.size){let s=yc(o.content,i.content,t+1);if(s!=null)return s}t+=o.nodeSize}}function bc(n,e,t,r){for(let o=n.childCount,i=e.childCount;;){if(o==0||i==0)return o==i?null:{a:t,b:r};let s=n.child(--o),a=e.child(--i),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let c=bc(s.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class D{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,o=0,i){for(let s=0,a=0;a<t;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,o+a,i||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,o+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,o){let i="",s=!0;return this.nodesBetween(e,t,(a,l)=>{a.isText?(i+=a.text.slice(Math.max(e,l)-l,t-l),s=!r):a.isLeaf?(o?i+=typeof o=="function"?o(a):o:a.type.spec.leafText&&(i+=a.type.spec.leafText(a)),s=!r):!s&&a.isBlock&&(i+=r,s=!0)},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,o=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(o[o.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)o.push(e.content[i]);return new D(o,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],o=0;if(t>e)for(let i=0,s=0;s<t;i++){let a=this.content[i],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),o+=a.nodeSize),s=l}return new D(r,o)}cutByIndex(e,t){return e==t?D.empty:e==0&&t==this.content.length?this:new D(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let o=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return o[e]=t,new D(o,i)}addToStart(e){return new D([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new D(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let o=this.content[t];e(o,r,t),r+=o.nodeSize}}findDiffStart(e,t=0){return yc(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return bc(this,e,t,r)}findIndex(e,t=-1){if(e==0)return qr(0,e);if(e==this.size)return qr(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,o=0;;r++){let i=this.child(r),s=o+i.nodeSize;if(s>=e)return s==e||t>0?qr(r+1,s):qr(r,o);o=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return D.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new D(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return D.empty;let t,r=0;for(let o=0;o<e.length;o++){let i=e[o];r+=i.nodeSize,o&&i.isText&&e[o-1].sameMarkup(i)?(t||(t=e.slice(0,o)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new D(t||e,r)}static from(e){if(!e)return D.empty;if(e instanceof D)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new D([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}D.empty=new D([],0);const gi={index:0,offset:0};function qr(n,e){return gi.index=n,gi.offset=e,gi}function uo(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!uo(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!uo(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let K=class Yi{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let o=0;o<e.length;o++){let i=e[o];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,o));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,o)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&uo(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Yi.none;if(e instanceof Yi)return[e];let t=e.slice();return t.sort((r,o)=>r.type.rank-o.type.rank),t}};K.none=[];class po extends Error{}class T{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Dc(this.content,e+this.openStart,t);return r&&new T(r,this.openStart,this.openEnd)}removeBetween(e,t){return new T(vc(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return T.empty;let r=t.openStart||0,o=t.openEnd||0;if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new T(D.fromJSON(e,t.content),r,o)}static maxOpen(e,t=!0){let r=0,o=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)o++;return new T(e,r,o)}}T.empty=new T(D.empty,0,0);function vc(n,e,t){let{index:r,offset:o}=n.findIndex(e),i=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(o==e||i.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(vc(i.content,e-o-1,t-o-1)))}function Dc(n,e,t,r){let{index:o,offset:i}=n.findIndex(e),s=n.maybeChild(o);if(i==e||s.isText)return r&&!r.canReplace(o,o,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=Dc(s.content,e-i-1,t);return a&&n.replaceChild(o,s.copy(a))}function xp(n,e,t){if(t.openStart>n.depth)throw new po("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new po("Inconsistent open depths");return wc(n,e,t,0)}function wc(n,e,t,r){let o=n.index(r),i=n.node(r);if(o==e.index(r)&&r<n.depth-t.openStart){let s=wc(n,e,t,r+1);return i.copy(i.content.replaceChild(o,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return un(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=Cp(t,n);return un(i,Cc(n,s,a,e,r))}else return un(i,ho(n,e,r))}function xc(n,e){if(!e.type.compatibleContent(n.type))throw new po("Cannot join "+e.type.name+" onto "+n.type.name)}function Ki(n,e,t){let r=n.node(t);return xc(r,e.node(t)),r}function cn(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function vr(n,e,t,r){let o=(e||n).node(t),i=0,s=e?e.index(t):o.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(cn(n.nodeAfter,r),i++));for(let a=i;a<s;a++)cn(o.child(a),r);e&&e.depth==t&&e.textOffset&&cn(e.nodeBefore,r)}function un(n,e){return n.type.checkContent(e),n.copy(e)}function Cc(n,e,t,r,o){let i=n.depth>o&&Ki(n,e,o+1),s=r.depth>o&&Ki(t,r,o+1),a=[];return vr(null,n,o,a),i&&s&&e.index(o)==t.index(o)?(xc(i,s),cn(un(i,Cc(n,e,t,r,o+1)),a)):(i&&cn(un(i,ho(n,e,o+1)),a),vr(e,t,o,a),s&&cn(un(s,ho(t,r,o+1)),a)),vr(r,null,o,a),new D(a)}function ho(n,e,t){let r=[];if(vr(null,n,t,r),n.depth>t){let o=Ki(n,e,t+1);cn(un(o,ho(n,e,t+1)),r)}return vr(e,null,t,r),new D(r)}function Cp(n,e){let t=e.depth-n.openStart,o=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)o=e.node(i).copy(D.from(o));return{start:o.resolveNoCache(n.openStart+t),end:o.resolveNoCache(o.content.size-n.openEnd-t)}}class Mr{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],o=e.child(t);return r?e.child(t).cut(r):o}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],o=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)o+=r.child(i).nodeSize;return o}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return K.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),o=e.maybeChild(t);if(!r){let a=r;r=o,o=a}let i=r.marks;for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!o||!i[s].isInSet(o.marks))&&(i=i[s--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,o=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!o||!r[i].isInSet(o.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new fo(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],o=0,i=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(i),c=i-l;if(r.push(s,a,o+l),!c||(s=s.child(a),s.isText))break;i=c-1,o+=l+1}return new Mr(t,r,i)}static resolveCached(e,t){for(let o=0;o<yi.length;o++){let i=yi[o];if(i.pos==t&&i.doc==e)return i}let r=yi[bi]=Mr.resolve(e,t);return bi=(bi+1)%kp,r}}let yi=[],bi=0,kp=12;class fo{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Ep=Object.create(null);let dn=class qi{constructor(e,t,r,o=K.none){this.type=e,this.attrs=t,this.marks=o,this.content=r||D.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,o=0){this.content.nodesBetween(e,t,r,o,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,o){return this.content.textBetween(e,t,r,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&uo(this.attrs,t||e.defaultAttrs||Ep)&&K.sameSet(this.marks,r||K.none)}copy(e=null){return e==this.content?this:new qi(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new qi(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return T.empty;let o=this.resolve(e),i=this.resolve(t),s=r?0:o.sharedDepth(t),a=o.start(s),c=o.node(s).content.cut(o.pos-a,i.pos-a);return new T(c,o.depth-s,i.depth-s)}replace(e,t,r){return xp(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:o}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(o==e||t.isText)return t;e-=o+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let o=this.content.child(t-1);return{node:o,index:t-1,offset:r-o.nodeSize}}resolve(e){return Mr.resolveCached(this,e)}resolveNoCache(e){return Mr.resolve(this,e)}rangeHasMark(e,t,r){let o=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),kc(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=D.empty,o=0,i=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,o,i),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=o;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,o){if(o&&!this.type.allowsMarks(o))return!1;let i=this.contentMatchAt(e).matchType(r),s=i&&i.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=K.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!K.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let o=D.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,o,r)}};dn.prototype.text=void 0;class mo extends dn{constructor(e,t,r,o){if(super(e,t,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):kc(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new mo(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new mo(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function kc(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class bn{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new Mp(e,t);if(r.next==null)return bn.empty;let o=Ec(r);r.next&&r.err("Unexpected trailing text");let i=Ip(Op(o));return $p(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let o=this;for(let i=t;o&&i<r;i++)o=o.matchType(e.child(i).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let o=[this];function i(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return D.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&o.indexOf(d)==-1){o.push(d);let p=i(d,a.concat(u));if(p)return p}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let o=r.shift(),i=o.match;if(i.matchType(e)){let s=[];for(let a=o;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<i.next.length;s++){let{type:a,next:l}=i.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!o.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:o}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let o=0;o<r.next.length;o++)e.indexOf(r.next[o].next)==-1&&t(r.next[o].next)}return t(this),e.map((r,o)=>{let i=o+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)i+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return i}).join(`
`)}}bn.empty=new bn(!0);class Mp{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Ec(n){let e=[];do e.push(Tp(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Tp(n){let e=[];do e.push(Sp(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Sp(n){let e=Ap(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=Fp(n,e);else break;return e}function da(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function Fp(n,e){let t=da(n),r=t;return n.eat(",")&&(n.next!="}"?r=da(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function Pp(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let o=[];for(let i in t){let s=t[i];s.groups.indexOf(e)>-1&&o.push(s)}return o.length==0&&n.err("No node type or group '"+e+"' found"),o}function Ap(n){if(n.eat("(")){let e=Ec(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=Pp(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Op(n){let e=[[]];return o(i(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function o(s,a){s.forEach(l=>l.to=a)}function i(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=i(s.exprs[l],a);if(l==s.exprs.length-1)return c;o(c,a=t())}else if(s.type=="star"){let l=t();return r(a,l),o(i(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return o(i(s.expr,a),l),o(i(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(i(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=t();o(i(s.expr,l),u),l=u}if(s.max==-1)o(i(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=t();r(l,u),o(i(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Mc(n,e){return e-n}function pa(n,e){let t=[];return r(e),t.sort(Mc);function r(o){let i=n[o];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(o);for(let s=0;s<i.length;s++){let{term:a,to:l}=i[s];!a&&t.indexOf(l)==-1&&r(l)}}}function Ip(n){let e=Object.create(null);return t(pa(n,0));function t(r){let o=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<o.length;u++)o[u][0]==a&&(c=o[u][1]);pa(n,l).forEach(u=>{c||o.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new bn(r.indexOf(n.length-1)>-1);for(let s=0;s<o.length;s++){let a=o[s][1].sort(Mc);i.next.push({type:o[s][0],next:e[a.join(",")]||t(a)})}return i}}function $p(n,e){for(let t=0,r=[n];t<r.length;t++){let o=r[t],i=!o.validEnd,s=[];for(let a=0;a<o.next.length;a++){let{type:l,next:c}=o.next[a];s.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Tc(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function Sc(n,e){let t=Object.create(null);for(let r in n){let o=e&&e[r];if(o===void 0){let i=n[r];if(i.hasDefault)o=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=o}return t}function Fc(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new Np(n[t]);return e}let ha=class Pc{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Fc(r.attrs),this.defaultAttrs=Tc(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==bn.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Sc(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new dn(this,this.computeAttrs(e),D.from(t),K.setFrom(r))}createChecked(e=null,t,r){return t=D.from(t),this.checkContent(t),new dn(this,this.computeAttrs(e),t,K.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=D.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let o=this.contentMatch.matchFragment(t),i=o&&o.fillBefore(D.empty,!0);return i?new dn(this,e,t.append(i),K.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:K.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,s)=>r[i]=new Pc(i,t,s));let o=t.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class Np{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Bo{constructor(e,t,r,o){this.name=e,this.rank=t,this.schema=r,this.spec=o,this.attrs=Fc(o.attrs),this.excluded=null;let i=Tc(this.attrs);this.instance=i?new K(this,i):null}create(e=null){return!e&&this.instance?this.instance:new K(this,Sc(this.attrs,e))}static compile(e,t){let r=Object.create(null),o=0;return e.forEach((i,s)=>r[i]=new Bo(i,o++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class Lp{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let o in e)t[o]=e[o];t.nodes=me.from(e.nodes),t.marks=me.from(e.marks||{}),this.nodes=ha.compile(this.spec.nodes,this),this.marks=Bo.compile(this.spec.marks,this);let r=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=r[s]||(r[s]=bn.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet=a=="_"?null:a?fa(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let o in this.marks){let i=this.marks[o],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:fa(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,o){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof ha){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,o)}text(e,t){let r=this.nodes.text;return new mo(r,r.defaultAttrs,e,K.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return dn.fromJSON(this,e)}markFromJSON(e){return K.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function fa(n,e){let t=[];for(let r=0;r<e.length;r++){let o=e[r],i=n.marks[o],s=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(o=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}class Gn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let o=e.nodes[r.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new ga(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new ga(this,t,!0);return r.addAll(e,t.from,t.to),T.maxOpen(r.finish())}matchTag(e,t,r){for(let o=r?this.tags.indexOf(r)+1:0;o<this.tags.length;o++){let i=this.tags[o];if(_p(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let s=i.getAttrs(e);if(s===!1)continue;i.attrs=s||void 0}return i}}}matchStyle(e,t,r,o){for(let i=o?this.styles.indexOf(o)+1:0;i<this.styles.length;i++){let s=this.styles[i],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(o){let i=o.priority==null?50:o.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<i)break}t.splice(s,0,o)}for(let o in e.marks){let i=e.marks[o].spec.parseDOM;i&&i.forEach(s=>{r(s=ya(s)),s.mark||s.ignore||s.clearMark||(s.mark=o)})}for(let o in e.nodes){let i=e.nodes[o].spec.parseDOM;i&&i.forEach(s=>{r(s=ya(s)),s.node||s.ignore||s.mark||(s.node=o)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Gn(e,Gn.schemaRules(e)))}}const Ac={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Rp={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Oc={ol:!0,ul:!0},go=1,yo=2,Dr=4;function ma(n,e,t){return e!=null?(e?go:0)|(e==="full"?yo:0):n&&n.whitespace=="pre"?go|yo:t&~Dr}class Jr{constructor(e,t,r,o,i,s,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=o,this.solid=i,this.options=a,this.content=[],this.activeMarks=K.none,this.stashMarks=[],this.match=s||(a&Dr?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(D.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,o;return(o=r.findWrapping(e.type))?(this.match=r,o):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&go)){let r=this.content[this.content.length-1],o;if(r&&r.isText&&(o=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-o[0].length))}}let t=D.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(D.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let o=r[t];(this.type?this.type.allowsMarkType(o.type):Hp(o.type,e))&&!o.isInSet(this.activeMarks)&&(this.activeMarks=o.addToSet(this.activeMarks),this.pendingMarks=o.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Ac.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ga{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let o=t.topNode,i,s=ma(null,t.preserveWhitespace,0)|(r?Dr:0);o?i=new Jr(o.type,o.attrs,K.none,K.none,!0,t.topMatch||o.type.contentMatch,s):r?i=new Jr(null,null,K.none,K.none,!0,null,s):i=new Jr(e.schema.topNodeType,null,K.none,K.none,!0,null,s),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let o=this.readStyles(zp(r));if(!o)return;let[i,s]=o,a=this.top;for(let l=0;l<s.length;l++)this.removePendingMark(s[l],a);for(let l=0;l<i.length;l++)this.addPendingMark(i[l]);t();for(let l=0;l<i.length;l++)this.removePendingMark(i[l],a);for(let l=0;l<s.length;l++)this.addPendingMark(s[l])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&yo||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&go)r.options&yo?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let o=r.content[r.content.length-1],i=e.previousSibling;(!o||i&&i.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),o;Oc.hasOwnProperty(r)&&this.parser.normalizeLists&&Bp(e);let i=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,t));if(i?i.ignore:Rp.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(e=i.skip);let s,a=this.top,l=this.needsBlock;if(Ac.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),s=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}i&&i.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),s&&this.sync(a),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,i,i.consuming===!1?o:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=K.none,r=K.none;for(let o=0;o<e.length;o+=2)for(let i=void 0;;){let s=this.parser.matchStyle(e[o],e[o+1],this,i);if(!s)break;if(s.ignore)return null;if(s.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(a=>{s.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(t),s.consuming===!1)i=s;else break}return[t,r]}addElementByRule(e,t,r){let o,i,s;t.node?(i=this.parser.schema.nodes[t.node],i.isLeaf?this.insertNode(i.create(t.attrs))||this.leafFallback(e):o=this.enter(i,t.attrs||null,t.preserveWhitespace)):(s=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(s));let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}o&&this.sync(a)&&this.open--,s&&this.removePendingMark(s,a)}addAll(e,t,r){let o=t||0;for(let i=t?e.childNodes[t]:e.firstChild,s=r==null?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i);this.findAtPoint(e,o)}findPlace(e){let t,r;for(let o=this.open;o>=0;o--){let i=this.nodes[o],s=i.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,r=i,!s.length)||i.solid)break}if(!t)return!1;this.sync(r);for(let o=0;o<t.length;o++)this.enterInner(t[o],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let o=0;o<e.marks.length;o++)(!t.type||t.type.allowsMarkType(e.marks[o].type))&&(r=e.marks[o].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let o=this.findPlace(e.create(t));return o&&this.enterInner(e,t,!0,r),o}enterInner(e,t=null,r=!1,o){this.closeExtra();let i=this.top;i.applyPending(e),i.match=i.match&&i.match.matchType(e);let s=ma(e,o,i.options);i.options&Dr&&i.content.length==0&&(s|=Dr),this.nodes.push(new Jr(e,t,i.activeMarks,i.pendingMarks,r,null,s)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let o=r.length-1;o>=0;o--)e+=r[o].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&e.nodeType==1&&e.contains(this.find[o].node)&&t.compareDocumentPosition(this.find[o].node)&(r?2:4)&&(this.find[o].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&o?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=jp(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let o=this.nodes[r];if(o.pendingMarks.lastIndexOf(e)>-1)o.pendingMarks=e.removeFromSet(o.pendingMarks);else{o.activeMarks=e.removeFromSet(o.activeMarks);let s=o.popFromStashMark(e);s&&o.type&&o.type.allowsMarkType(s.type)&&(o.activeMarks=s.addToSet(o.activeMarks))}if(o==t)break}}}function Bp(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Oc.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function _p(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function zp(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function ya(n){let e={};for(let t in n)e[t]=n[t];return e}function Hp(n,e){let t=e.schema.nodes;for(let r in t){let o=t[r];if(!o.allowsMarkType(n))continue;let i=[],s=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&s(u))return!0}};if(s(o.contentMatch))return!0}}function jp(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class ut{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=vi(t).createDocumentFragment());let o=r,i=[];return e.forEach(s=>{if(i.length||s.marks.length){let a=0,l=0;for(;a<i.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)o=i.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,t);u&&(i.push([c,o]),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:o}=ut.renderSpec(vi(t),this.nodes[e.type.name](e));if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,o)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let o=e.marks.length-1;o>=0;o--){let i=this.serializeMark(e.marks[o],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let o=this.marks[e.type.name];return o&&ut.renderSpec(vi(r),o(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let o=t[0],i=o.indexOf(" ");i>0&&(r=o.slice(0,i),o=o.slice(i+1));let s,a=r?e.createElementNS(r,o):e.createElement(o),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:p,contentDOM:h}=ut.renderSpec(e,d,r);if(a.appendChild(p),h){if(s)throw new RangeError("Multiple content holes");s=h}}}return{dom:a,contentDOM:s}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ut(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=ba(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return ba(e.marks)}}function ba(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function vi(n){return n.document||window.document}const Ic=65535,$c=Math.pow(2,16);function Up(n,e){return n+e*$c}function va(n){return n&Ic}function Vp(n){return(n-(n&Ic))/$c}const Nc=1,Lc=2,ro=4,Rc=8;class Ji{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Rc)>0}get deletedBefore(){return(this.delInfo&(Nc|ro))>0}get deletedAfter(){return(this.delInfo&(Lc|ro))>0}get deletedAcross(){return(this.delInfo&ro)>0}}class Ve{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ve.empty)return Ve.empty}recover(e){let t=0,r=va(e);if(!this.inverted)for(let o=0;o<r;o++)t+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[r*3]+t+Vp(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let o=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?o:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+s],d=l+c;if(e<=d){let p=c?e==l?-1:e==d?1:t:t,h=l+o+(p<0?0:u);if(r)return h;let f=e==(t<0?l:d)?null:Up(a/3,e-l),m=e==l?Lc:e==d?Nc:ro;return(t<0?e!=l:e!=d)&&(m|=Rc),new Ji(h,m,f)}o+=u-c}return r?e+o:new Ji(e+o,0,null)}touches(e,t){let r=0,o=va(t),i=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==o*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let o=0,i=0;o<this.ranges.length;o+=3){let s=this.ranges[o],a=s-(this.inverted?i:0),l=s+(this.inverted?0:i),c=this.ranges[o+t],u=this.ranges[o+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new Ve(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ve.empty:new Ve(e<0?[0,-e,0]:[0,0,e])}}Ve.empty=new Ve([]);class Bn{constructor(e=[],t,r=0,o=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=o}slice(e=0,t=this.maps.length){return new Bn(this.maps,this.mirror,e,t)}copy(){return new Bn(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let o=e.getMirror(t);this.appendMap(e.maps[t],o!=null&&o<t?r+o:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let o=e.getMirror(t);this.appendMap(e.maps[t].invert(),o!=null&&o>t?r-o-1:void 0)}}invert(){let e=new Bn;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let o=0;for(let i=this.from;i<this.to;i++){let s=this.maps[i],a=s.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this.maps[l].recover(a.recover);continue}}o|=a.delInfo,e=a.pos}return r?e:new Ji(e,o,null)}}const Di=Object.create(null);class Me{getMap(){return Ve.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Di[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Di)throw new RangeError("Duplicate use of step JSON ID "+e);return Di[e]=t,t.prototype.jsonID=e,t}}class re{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new re(e,null)}static fail(e){return new re(null,e)}static fromReplace(e,t,r,o){try{return re.ok(e.replace(t,r,o))}catch(i){if(i instanceof po)return re.fail(i.message);throw i}}}function xs(n,e,t){let r=[];for(let o=0;o<n.childCount;o++){let i=n.child(o);i.content.size&&(i=i.copy(xs(i.content,e,i))),i.isInline&&(i=e(i,t,o)),r.push(i)}return D.fromArray(r)}class Ot extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new T(xs(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),o),t.openStart,t.openEnd);return re.fromReplace(e,this.from,this.to,i)}invert(){return new dt(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ot(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ot&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ot(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ot(t.from,t.to,e.markFromJSON(t.mark))}}Me.jsonID("addMark",Ot);class dt extends Me{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new T(xs(t.content,o=>o.mark(this.mark.removeFromSet(o.marks)),e),t.openStart,t.openEnd);return re.fromReplace(e,this.from,this.to,r)}invert(){return new Ot(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new dt(t.pos,r.pos,this.mark)}merge(e){return e instanceof dt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new dt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new dt(t.from,t.to,e.markFromJSON(t.mark))}}Me.jsonID("removeMark",dt);class It extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return re.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return re.fromReplace(e,this.pos,this.pos+1,new T(D.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let o=0;o<t.marks.length;o++)if(!t.marks[o].isInSet(r))return new It(this.pos,t.marks[o]);return new It(this.pos,this.mark)}}return new Wn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new It(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new It(t.pos,e.markFromJSON(t.mark))}}Me.jsonID("addNodeMark",It);class Wn extends Me{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return re.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return re.fromReplace(e,this.pos,this.pos+1,new T(D.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new It(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Wn(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Wn(t.pos,e.markFromJSON(t.mark))}}Me.jsonID("removeNodeMark",Wn);class ge extends Me{constructor(e,t,r,o=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=o}apply(e){return this.structure&&Zi(e,this.from,this.to)?re.fail("Structure replace would overwrite content"):re.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ve([this.from,this.to-this.from,this.slice.size])}invert(e){return new ge(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ge(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof ge)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?T.empty:new T(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ge(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?T.empty:new T(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ge(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ge(t.from,t.to,T.fromJSON(e,t.slice),!!t.structure)}}Me.jsonID("replace",ge);class ae extends Me{constructor(e,t,r,o,i,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Zi(e,this.from,this.gapFrom)||Zi(e,this.gapTo,this.to)))return re.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return re.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?re.fromReplace(e,this.from,this.to,r):re.fail("Content does not fit in gap")}getMap(){return new Ve([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ae(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||o<t.pos||i>r.pos?null:new ae(t.pos,r.pos,o,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ae(t.from,t.to,t.gapFrom,t.gapTo,T.fromJSON(e,t.slice),t.insert,!!t.structure)}}Me.jsonID("replaceAround",ae);function Zi(n,e,t){let r=n.resolve(e),o=t-e,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let s=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}}return!1}function Gp(n,e,t,r){let o=[],i=[],s,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let p=Math.max(c,e),h=Math.min(c+l.nodeSize,t),f=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(f)||(s&&s.to==p&&s.mark.eq(d[m])?s.to=h:o.push(s=new dt(p,h,d[m])));a&&a.to==p?a.to=h:i.push(a=new Ot(p,h,r))}}),o.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function Wp(n,e,t,r){let o=[],i=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;i++;let l=null;if(r instanceof Bo){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],p;for(let h=0;h<o.length;h++){let f=o[h];f.step==i-1&&d.eq(o[h].style)&&(p=f)}p?(p.to=c,p.step=i):o.push({style:d,from:Math.max(a,e),to:c,step:i})}}}),o.forEach(s=>n.step(new dt(s.from,s.to,s.style)))}function Yp(n,e,t,r=t.contentMatch){let o=n.doc.nodeAt(e),i=[],s=e+1;for(let a=0;a<o.childCount;a++){let l=o.child(a),c=s+l.nodeSize,u=r.matchType(l.type);if(!u)i.push(new ge(s,c,T.empty));else{r=u;for(let d=0;d<l.marks.length;d++)t.allowsMarkType(l.marks[d].type)||n.step(new dt(s,c,l.marks[d]));if(l.isText&&!t.spec.code){let d,p=/\r?\n|\r/g,h;for(;d=p.exec(l.text);)h||(h=new T(D.from(t.schema.text(" ",t.allowedMarks(l.marks))),0,0)),i.push(new ge(s+d.index,s+d.index+d[0].length,h))}}s=c}if(!r.validEnd){let a=r.fillBefore(D.empty,!0);n.replace(s,s,new T(a,0,0))}for(let a=i.length-1;a>=0;a--)n.step(i[a])}function Kp(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function or(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let o=n.$from.node(r),i=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&o.canReplace(i,s,t))return r;if(r==0||o.type.spec.isolating||!Kp(o,i,s))break}return null}function qp(n,e,t){let{$from:r,$to:o,depth:i}=e,s=r.before(i+1),a=o.after(i+1),l=s,c=a,u=D.empty,d=0;for(let f=i,m=!1;f>t;f--)m||r.index(f)>0?(m=!0,u=D.from(r.node(f).copy(u)),d++):l--;let p=D.empty,h=0;for(let f=i,m=!1;f>t;f--)m||o.after(f+1)<o.end(f)?(m=!0,p=D.from(o.node(f).copy(p)),h++):c++;n.step(new ae(l,c,s,a,new T(u.append(p),d,h),u.size-d,!0))}function Cs(n,e,t=null,r=n){let o=Jp(n,e),i=o&&Zp(r,e);return i?o.map(Da).concat({type:e,attrs:t}).concat(i.map(Da)):null}function Da(n){return{type:n,attrs:null}}function Jp(n,e){let{parent:t,startIndex:r,endIndex:o}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let s=i.length?i[0]:e;return t.canReplaceWith(r,o,s)?i:null}function Zp(n,e){let{parent:t,startIndex:r,endIndex:o}=n,i=t.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<o;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:s}function Xp(n,e,t){let r=D.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=D.from(t[s].type.create(t[s].attrs,r))}let o=e.start,i=e.end;n.step(new ae(o,i,o,i,new T(r,0,0),t.length,!0))}function Qp(n,e,t,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{if(s.isTextblock&&!s.hasMarkup(r,o)&&eh(n.doc,n.mapping.slice(i).map(a),r)){n.clearIncompatible(n.mapping.slice(i).map(a,1),r);let l=n.mapping.slice(i),c=l.map(a,1),u=l.map(a+s.nodeSize,1);return n.step(new ae(c,u,c+1,u-1,new T(D.from(r.create(o,null,s.marks)),0,0),1,!0)),!1}})}function eh(n,e,t){let r=n.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,t)}function th(n,e,t,r,o){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let s=t.create(r,null,o||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,s);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new ae(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new T(D.from(s),0,0),1,!0))}function _n(n,e,t=1,r){let o=n.resolve(e),i=o.depth-t,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,u=t-2;c>i;c--,u--){let d=o.node(c),p=o.index(c);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(p,d.childCount),f=r&&r[u+1];f&&(h=h.replaceChild(0,f.type.create(f.attrs)));let m=r&&r[u]||d;if(!d.canReplace(p+1,d.childCount)||!m.type.validContent(h))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function nh(n,e,t=1,r){let o=n.doc.resolve(e),i=D.empty,s=D.empty;for(let a=o.depth,l=o.depth-t,c=t-1;a>l;a--,c--){i=D.from(o.node(a).copy(i));let u=r&&r[c];s=D.from(u?u.type.create(u.attrs,s):o.node(a).copy(s))}n.step(new ge(e,e,new T(i.append(s),t,t),!0))}function Yt(n,e){let t=n.resolve(e),r=t.index();return Bc(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Bc(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function _o(n,e,t=-1){let r=n.resolve(e);for(let o=r.depth;;o--){let i,s,a=r.index(o);if(o==r.depth?(i=r.nodeBefore,s=r.nodeAfter):t>0?(i=r.node(o+1),a++,s=r.node(o).maybeChild(a)):(i=r.node(o).maybeChild(a-1),s=r.node(o+1)),i&&!i.isTextblock&&Bc(i,s)&&r.node(o).canReplace(a,a+1))return e;if(o==0)break;e=t<0?r.before(o):r.after(o)}}function rh(n,e,t){let r=new ge(e-t,e+t,T.empty,!0);n.step(r)}function oh(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let o=r.depth-1;o>=0;o--){let i=r.index(o);if(r.node(o).canReplaceWith(i,i,t))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let i=r.indexAfter(o);if(r.node(o).canReplaceWith(i,i,t))return r.after(o+1);if(i<r.node(o).childCount)return null}return null}function _c(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let o=t.content;for(let i=0;i<t.openStart;i++)o=o.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(i==1)u=c.canReplace(l,l,o);else{let d=c.contentMatchAt(l).findWrapping(o.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function ks(n,e,t=e,r=T.empty){if(e==t&&!r.size)return null;let o=n.resolve(e),i=n.resolve(t);return zc(o,i,r)?new ge(e,t,r):new ih(o,i,r).fit()}function zc(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class ih{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=D.empty;for(let o=0;o<=e.depth;o++){let i=e.node(o);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(o))})}for(let o=e.depth;o>0;o--)this.placed=D.from(e.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;let i=this.placed,s=r.depth,a=o.depth;for(;s&&a&&i.childCount==1;)i=i.firstChild.content,s--,a--;let l=new T(i,s,a);return e>-1?new ae(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new ge(r.pos,o.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,o=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(o=0),i.type.spec.isolating&&o<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let o,i=null;r?(i=wi(this.unplaced.content,r-1).firstChild,o=i.content):o=this.unplaced.content;let s=o.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(s?c.matchType(s.type)||(d=c.fillBefore(D.from(s),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:d};if(t==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,o=wi(e,t);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new T(e,t+1,Math.max(r,o.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,o=wi(e,t);if(o.childCount<=1&&t>0){let i=e.size-t<=t+o.size;this.unplaced=new T(fr(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new T(fr(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:o,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:p}=this.frontier[t];if(o){for(let m=0;m<o.childCount;m++)u.push(o.child(m));d=d.matchFragment(o)}let h=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),g=d.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(d=g,u.push(Hc(m.mark(p.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?h:-1)))}let f=c==a.childCount;f||(h=-1),this.placed=mr(this.placed,t,D.from(u)),this.frontier[t].match=d,f&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<h;m++){let y=g.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),g=y.content}this.unplaced=f?e==0?T.empty:new T(fr(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new T(fr(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!xi(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,o=this.$to.after(r);for(;r>1&&o==this.$to.end(--r);)++o;return o}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:o}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=xi(e,t,o,r,i);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=xi(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=mr(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let o=e.node(r),i=o.type.contentMatch.fillBefore(o.content,!0,e.index(r));this.openFrontierNode(o.type,o.attrs,i)}return e}openFrontierNode(e,t=null,r){let o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=mr(this.placed,this.depth,D.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(D.empty,!0);t.childCount&&(this.placed=mr(this.placed,this.frontier.length,t))}}function fr(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(fr(n.firstChild.content,e-1,t)))}function mr(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(mr(n.lastChild.content,e-1,t)))}function wi(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Hc(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Hc(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(D.empty,!0)))),n.copy(r)}function xi(n,e,t,r,o){let i=n.node(e),s=o?n.indexAfter(e):n.index(e);if(s==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!sh(t,i.content,s)?a:null}function sh(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function ah(n){return n.spec.defining||n.spec.definingForContent}function lh(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let o=n.doc.resolve(e),i=n.doc.resolve(t);if(zc(o,i,r))return n.step(new ge(e,t,r));let s=Uc(o,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let p=o.depth,h=o.pos-1;p>0;p--,h--){let f=o.node(p).type.spec;if(f.defining||f.definingAsContext||f.isolating)break;s.indexOf(p)>-1?a=p:o.before(p)==h&&s.splice(1,0,-p)}let l=s.indexOf(a),c=[],u=r.openStart;for(let p=r.content,h=0;;h++){let f=p.firstChild;if(c.push(f),h==r.openStart)break;p=f.content}for(let p=u-1;p>=0;p--){let h=c[p],f=ah(h.type);if(f&&!h.sameMarkup(o.node(Math.abs(a)-1)))u=p;else if(f||!h.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let h=(p+u+1)%(r.openStart+1),f=c[h];if(f)for(let m=0;m<s.length;m++){let g=s[(m+l)%s.length],y=!0;g<0&&(y=!1,g=-g);let b=o.node(g-1),v=o.index(g-1);if(b.canReplaceWith(v,v,f.type,f.marks))return n.replace(o.before(g),y?i.after(g):t,new T(jc(r.content,0,r.openStart,h),h,r.openEnd))}}let d=n.steps.length;for(let p=s.length-1;p>=0&&(n.replace(e,t,r),!(n.steps.length>d));p--){let h=s[p];h<0||(e=o.before(h),t=i.after(h))}}function jc(n,e,t,r,o){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(jc(i.content,e+1,t,r,i)))}if(e>r){let i=o.contentMatchAt(0),s=i.fillBefore(n).append(n);n=s.append(i.matchFragment(s).fillBefore(D.empty,!0))}return n}function ch(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let o=oh(n.doc,e,r.type);o!=null&&(e=t=o)}n.replaceRange(e,t,new T(D.from(r),0,0))}function uh(n,e,t){let r=n.doc.resolve(e),o=n.doc.resolve(t),i=Uc(r,o);for(let s=0;s<i.length;s++){let a=i[s],l=s==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),o.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),o.indexAfter(a-1))))return n.delete(r.before(a),o.after(a))}for(let s=1;s<=r.depth&&s<=o.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&o.end(s)-t!=o.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function Uc(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let o=r;o>=0;o--){let i=n.start(o);if(i<n.pos-(n.depth-o)||e.end(o)>e.pos+(e.depth-o)||n.node(o).type.spec.isolating||e.node(o).type.spec.isolating)break;(i==e.start(o)||o==n.depth&&o==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&o&&e.start(o-1)==i-1)&&t.push(o)}return t}class zn extends Me{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return re.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let o=t.type.create(r,null,t.marks);return re.fromReplace(e,this.pos,this.pos+1,new T(D.from(o),0,t.isLeaf?0:1))}getMap(){return Ve.empty}invert(e){return new zn(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new zn(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new zn(t.pos,t.attr,t.value)}}Me.jsonID("attr",zn);class Tr extends Me{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let o in e.attrs)t[o]=e.attrs[o];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return re.ok(r)}getMap(){return Ve.empty}invert(e){return new Tr(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Tr(t.attr,t.value)}}Me.jsonID("docAttr",Tr);let Yn=class extends Error{};Yn=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Yn.prototype=Object.create(Error.prototype);Yn.prototype.constructor=Yn;Yn.prototype.name="TransformError";class dh{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Bn}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Yn(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=T.empty){let o=ks(this.doc,e,t,r);return o&&this.step(o),this}replaceWith(e,t,r){return this.replace(e,t,new T(D.from(r),0,0))}delete(e,t){return this.replace(e,t,T.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return lh(this,e,t,r),this}replaceRangeWith(e,t,r){return ch(this,e,t,r),this}deleteRange(e,t){return uh(this,e,t),this}lift(e,t){return qp(this,e,t),this}join(e,t=1){return rh(this,e,t),this}wrap(e,t){return Xp(this,e,t),this}setBlockType(e,t=e,r,o=null){return Qp(this,e,t,r,o),this}setNodeMarkup(e,t,r=null,o){return th(this,e,t,r,o),this}setNodeAttribute(e,t,r){return this.step(new zn(e,t,r)),this}setDocAttribute(e,t){return this.step(new Tr(e,t)),this}addNodeMark(e,t){return this.step(new It(e,t)),this}removeNodeMark(e,t){if(!(t instanceof K)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Wn(e,t)),this}split(e,t=1,r){return nh(this,e,t,r),this}addMark(e,t,r){return Gp(this,e,t,r),this}removeMark(e,t,r){return Wp(this,e,t,r),this}clearIncompatible(e,t,r){return Yp(this,e,t,r),this}}const Ci=Object.create(null);class _{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new ph(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=T.empty){let r=t.content.lastChild,o=null;for(let a=0;a<t.openEnd;a++)o=r,r=r.lastChild;let i=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?T.empty:t),a==0&&Ca(e,i,(r?r.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,o=this.ranges;for(let i=0;i<o.length;i++){let{$from:s,$to:a}=o[i],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Ca(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let o=e.parent.inlineContent?new R(e):In(e.node(0),e.parent,e.pos,e.index(),t,r);if(o)return o;for(let i=e.depth-1;i>=0;i--){let s=t<0?In(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):In(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new it(e.node(0))}static atStart(e){return In(e,e,0,0,1)||new it(e)}static atEnd(e){return In(e,e,e.content.size,e.childCount,-1)||new it(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Ci[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ci)throw new RangeError("Duplicate use of selection JSON ID "+e);return Ci[e]=t,t.prototype.jsonID=e,t}getBookmark(){return R.between(this.$anchor,this.$head).getBookmark()}}_.prototype.visible=!0;class ph{constructor(e,t){this.$from=e,this.$to=t}}let wa=!1;function xa(n){!wa&&!n.parent.inlineContent&&(wa=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class R extends _{constructor(e,t=e){xa(e),xa(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return _.near(r);let o=e.resolve(t.map(this.anchor));return new R(o.parent.inlineContent?o:r,r)}replace(e,t=T.empty){if(super.replace(e,t),t==T.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof R&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new zo(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new R(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let o=e.resolve(t);return new this(o,r==t?o:e.resolve(r))}static between(e,t,r){let o=e.pos-t.pos;if((!r||o)&&(r=o>=0?1:-1),!t.parent.inlineContent){let i=_.findFrom(t,r,!0)||_.findFrom(t,-r,!0);if(i)t=i.$head;else return _.near(t,r)}return e.parent.inlineContent||(o==0?e=t:(e=(_.findFrom(e,-r,!0)||_.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=o<0&&(e=t))),new R(e,t)}}_.jsonID("text",R);class zo{constructor(e,t){this.anchor=e,this.head=t}map(e){return new zo(e.map(this.anchor),e.map(this.head))}resolve(e){return R.between(e.resolve(this.anchor),e.resolve(this.head))}}class N extends _{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:o}=t.mapResult(this.anchor),i=e.resolve(o);return r?_.near(i):new N(i)}content(){return new T(D.from(this.node),0,0)}eq(e){return e instanceof N&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Es(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new N(e.resolve(t.anchor))}static create(e,t){return new N(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}N.prototype.visible=!1;_.jsonID("node",N);class Es{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new zo(r,r):new Es(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&N.isSelectable(r)?new N(t):_.near(t)}}class it extends _{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=T.empty){if(t==T.empty){e.delete(0,e.doc.content.size);let r=_.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new it(e)}map(e){return new it(e)}eq(e){return e instanceof it}getBookmark(){return hh}}_.jsonID("all",it);const hh={map(){return this},resolve(n){return new it(n)}};function In(n,e,t,r,o,i=!1){if(e.inlineContent)return R.create(n,t);for(let s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){let a=e.child(s);if(a.isAtom){if(!i&&N.isSelectable(a))return N.create(n,t-(o<0?a.nodeSize:0))}else{let l=In(n,a,t+o,o<0?a.childCount:0,o,i);if(l)return l}t+=a.nodeSize*o}return null}function Ca(n,e,t){let r=n.steps.length-1;if(r<e)return;let o=n.steps[r];if(!(o instanceof ge||o instanceof ae))return;let i=n.mapping.maps[r],s;i.forEach((a,l,c,u)=>{s==null&&(s=u)}),n.setSelection(_.near(n.doc.resolve(s),t))}const ka=1,Zr=2,Ea=4;class fh extends dh{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|ka)&~Zr,this.storedMarks=null,this}get selectionSet(){return(this.updated&ka)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Zr,this}ensureMarks(e){return K.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Zr)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Zr,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||K.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let o=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(o.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let s=this.doc.resolve(t);i=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,o.text(e,i)),this.selection.empty||this.setSelection(_.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Ea,this}get scrolledIntoView(){return(this.updated&Ea)>0}}function Ma(n,e){return!e||!n?n:n.bind(e)}class gr{constructor(e,t,r){this.name=e,this.init=Ma(t.init,r),this.apply=Ma(t.apply,r)}}const mh=[new gr("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new gr("selection",{init(n,e){return n.selection||_.atStart(e.doc)},apply(n){return n.selection}}),new gr("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new gr("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class ki{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=mh.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new gr(r.key,r.spec.state,r))})}}class Nn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let o=this.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),o=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=o?o[s].n:0,c=o?o[s].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!o){o=[];for(let d=0;d<this.config.plugins.length;d++)o.push(d<s?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}o&&(o[s]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Nn(this.config),r=this.config.fields;for(let o=0;o<r.length;o++){let i=r[o];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new fh(this)}static create(e){let t=new ki(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Nn(t);for(let o=0;o<t.fields.length;o++)r[t.fields[o].name]=t.fields[o].init(e,r);return r}reconfigure(e){let t=new ki(this.schema,e.plugins),r=t.fields,o=new Nn(t);for(let i=0;i<r.length;i++){let s=r[i].name;o[s]=this.hasOwnProperty(s)?this[s]:r[i].init(e,o)}return o}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=e[r],i=o.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(o,this[o.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let o=new ki(e.schema,e.plugins),i=new Nn(o);return o.fields.forEach(s=>{if(s.name=="doc")i.doc=dn.fromJSON(e.schema,t.doc);else if(s.name=="selection")i.selection=_.fromJSON(i.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[s.name]=c.fromJSON.call(l,e,t[a],i);return}}i[s.name]=s.init(e,i)}}),i}}function Vc(n,e,t){for(let r in n){let o=n[r];o instanceof Function?o=o.bind(e):r=="handleDOMEvents"&&(o=Vc(o,e,{})),t[r]=o}return t}class Ne{constructor(e){this.spec=e,this.props={},e.props&&Vc(e.props,this,this.props),this.key=e.key?e.key.key:Gc("plugin")}getState(e){return e[this.key]}}const Ei=Object.create(null);function Gc(n){return n in Ei?n+"$"+ ++Ei[n]:(Ei[n]=0,n+"$")}class et{constructor(e="key"){this.key=Gc(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Fe=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Sr=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Ta=null;const wt=function(n,e,t){let r=Ta||(Ta=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},vn=function(n,e,t,r){return t&&(Sa(n,e,t,r,-1)||Sa(n,e,t,r,1))},gh=/^(img|br|input|textarea|hr)$/i;function Sa(n,e,t,r,o){for(;;){if(n==t&&e==r)return!0;if(e==(o<0?0:lt(n))){let i=n.parentNode;if(!i||i.nodeType!=1||Ms(n)||gh.test(n.nodeName)||n.contentEditable=="false")return!1;e=Fe(n)+(o<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(o<0?-1:0)],n.contentEditable=="false")return!1;e=o<0?lt(n):0}else return!1}}function lt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function yh(n,e,t){for(let r=e==0,o=e==lt(n);r||o;){if(n==t)return!0;let i=Fe(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,o=o&&i==lt(n)}}function Ms(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Ho=function(n){return n.focusNode&&vn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function tn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function bh(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function vh(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const pt=typeof navigator<"u"?navigator:null,Fa=typeof document<"u"?document:null,Kt=pt&&pt.userAgent||"",Xi=/Edge\/(\d+)/.exec(Kt),Wc=/MSIE \d/.exec(Kt),Qi=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Kt),Be=!!(Wc||Qi||Xi),Rt=Wc?document.documentMode:Qi?+Qi[1]:Xi?+Xi[1]:0,st=!Be&&/gecko\/(\d+)/i.test(Kt);st&&+(/Firefox\/(\d+)/.exec(Kt)||[0,0])[1];const es=!Be&&/Chrome\/(\d+)/.exec(Kt),ke=!!es,Dh=es?+es[1]:0,Ae=!Be&&!!pt&&/Apple Computer/.test(pt.vendor),Kn=Ae&&(/Mobile\/\w+/.test(Kt)||!!pt&&pt.maxTouchPoints>2),Ke=Kn||(pt?/Mac/.test(pt.platform):!1),wh=pt?/Win/.test(pt.platform):!1,rt=/Android \d/.test(Kt),Hr=!!Fa&&"webkitFontSmoothing"in Fa.documentElement.style,xh=Hr?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Ch(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Dt(n,e){return typeof n=="number"?n:n[e]}function kh(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Pa(n,e,t){let r=n.someProp("scrollThreshold")||0,o=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let s=t||n.dom;s;s=Sr(s)){if(s.nodeType!=1)continue;let a=s,l=a==i.body,c=l?Ch(i):kh(a),u=0,d=0;if(e.top<c.top+Dt(r,"top")?d=-(c.top-e.top+Dt(o,"top")):e.bottom>c.bottom-Dt(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Dt(o,"top")-c.top:e.bottom-c.bottom+Dt(o,"bottom")),e.left<c.left+Dt(r,"left")?u=-(c.left-e.left+Dt(o,"left")):e.right>c.right-Dt(r,"right")&&(u=e.right-c.right+Dt(o,"right")),u||d)if(l)i.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,h=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let f=a.scrollLeft-p,m=a.scrollTop-h;e={left:e.left-f,top:e.top-m,right:e.right-f,bottom:e.bottom-m}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function Eh(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,o;for(let i=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(i,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,o=l.top;break}}return{refDOM:r,refTop:o,stack:Yc(n.dom)}}function Yc(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Sr(r));return e}function Mh({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Kc(t,r==0?0:r-e)}function Kc(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:o,left:i}=n[t];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Sn=null;function Th(n){if(n.setActive)return n.setActive();if(Sn)return n.focus(Sn);let e=Yc(n);n.focus(Sn==null?{get preventScroll(){return Sn={preventScroll:!0},!0}}:void 0),Sn||(Sn=!1,Kc(e,0))}function qc(n,e){let t,r=2e8,o,i=0,s=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let p;if(u.nodeType==1)p=u.getClientRects();else if(u.nodeType==3)p=wt(u).getClientRects();else continue;for(let h=0;h<p.length;h++){let f=p[h];if(f.top<=s&&f.bottom>=a){s=Math.max(f.bottom,s),a=Math.min(f.top,a);let m=f.left>e.left?f.left-e.left:f.right<e.left?e.left-f.right:0;if(m<r){t=u,r=m,o=m&&t.nodeType==3?{left:f.right<e.left?f.right:f.left,top:e.top}:e,u.nodeType==1&&m&&(i=d+(e.left>=(f.left+f.right)/2?1:0));continue}}else f.top>e.top&&!l&&f.left<=e.left&&f.right>=e.left&&(l=u,c={left:Math.max(f.left,Math.min(f.right,e.left)),top:f.top});!t&&(e.left>=f.right&&e.top>=f.top||e.left>=f.left&&e.top>=f.bottom)&&(i=d+1)}}return!t&&l&&(t=l,o=c,r=0),t&&t.nodeType==3?Sh(t,o):!t||r&&t.nodeType==1?{node:n,offset:i}:qc(t,o)}function Sh(n,e){let t=n.nodeValue.length,r=document.createRange();for(let o=0;o<t;o++){r.setEnd(n,o+1),r.setStart(n,o);let i=Tt(r,1);if(i.top!=i.bottom&&Ts(e,i))return{node:n,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function Ts(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function Fh(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Ph(n,e,t){let{node:r,offset:o}=qc(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();i=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,o,i)}function Ah(n,e,t,r){let o=-1;for(let i=e,s=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent&&!s||!a.contentDOM)){let l=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&!s&&(s=!0,l.left>r.left||l.top>r.top?o=a.posBefore:(l.right<r.left||l.bottom<r.top)&&(o=a.posAfter)),!a.contentDOM&&o<0&&!a.node.isText)return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter}i=a.dom.parentNode}return o>-1?o:n.docView.posFromDOM(e,t,-1)}function Jc(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=o;;){let s=n.childNodes[i];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Ts(e,c))return Jc(s,e,c)}}if((i=(i+1)%r)==o)break}return n}function Oh(n,e){let t=n.dom.ownerDocument,r,o=0,i=vh(t,e.left,e.top);i&&({node:r,offset:o}=i);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=n.dom.getBoundingClientRect();if(!Ts(e,c)||(s=Jc(n.dom,e,c),!s))return null}if(Ae)for(let c=s;r&&c;c=Sr(c))c.draggable&&(r=void 0);if(s=Fh(s,e),r){if(st&&r.nodeType==1&&(o=Math.min(o,r.childNodes.length),o<r.childNodes.length)){let u=r.childNodes[o],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&o++}let c;Hr&&o&&r.nodeType==1&&(c=r.childNodes[o-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&o--,r==n.dom&&o==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(o==0||r.nodeType!=1||r.childNodes[o-1].nodeName!="BR")&&(a=Ah(n,r,o,e))}a==null&&(a=Ph(n,s,e));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Aa(n){return n.top<n.bottom||n.left<n.right}function Tt(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Aa(r))return r}return Array.prototype.find.call(t,Aa)||n.getBoundingClientRect()}const Ih=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Zc(n,e,t){let{node:r,offset:o,atom:i}=n.docView.domFromPos(e,t<0?-1:1),s=Hr||st;if(r.nodeType==3)if(s&&(Ih.test(r.nodeValue)||(t<0?!o:o==r.nodeValue.length))){let l=Tt(wt(r,o,o),t);if(st&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let c=Tt(wt(r,o-1,o-1),-1);if(c.top==l.top){let u=Tt(wt(r,o,o+1),-1);if(u.top!=l.top)return ar(u,u.left<c.left)}}return l}else{let l=o,c=o,u=t<0?1:-1;return t<0&&!o?(c++,u=-1):t>=0&&o==r.nodeValue.length?(l--,u=1):t<0?l--:c++,ar(Tt(wt(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&o&&(t<0||o==lt(r))){let l=r.childNodes[o-1];if(l.nodeType==1)return Mi(l.getBoundingClientRect(),!1)}if(i==null&&o<lt(r)){let l=r.childNodes[o];if(l.nodeType==1)return Mi(l.getBoundingClientRect(),!0)}return Mi(r.getBoundingClientRect(),t>=0)}if(i==null&&o&&(t<0||o==lt(r))){let l=r.childNodes[o-1],c=l.nodeType==3?wt(l,lt(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return ar(Tt(c,1),!1)}if(i==null&&o<lt(r)){let l=r.childNodes[o];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?wt(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return ar(Tt(c,-1),!0)}return ar(Tt(r.nodeType==3?wt(r):r,-t),t>=0)}function ar(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Mi(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Xc(n,e,t){let r=n.state,o=n.root.activeElement;r!=e&&n.updateState(e),o!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),o!=n.dom&&o&&o.focus()}}function $h(n,e,t){let r=e.selection,o=t=="up"?r.$from:r.$to;return Xc(n,e,()=>{let{node:i}=n.docView.domFromPos(o.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let s=Zc(n,o.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=wt(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const Nh=/[\u0590-\u08ac]/;function Lh(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=n.domSelection();return!Nh.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:s:Xc(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),p=a.caretBidiLevel;a.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:f,focusOffset:m}=n.domSelectionRange(),g=f&&!h.contains(f.nodeType==1?f:f.parentNode)||l==f&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return p!=null&&(a.caretBidiLevel=p),g})}let Oa=null,Ia=null,$a=!1;function Rh(n,e,t){return Oa==e&&Ia==t?$a:(Oa=e,Ia=t,$a=t=="up"||t=="down"?$h(n,e,t):Lh(n,e,t))}const qe=0,Na=1,rn=2,ht=3;class jr{constructor(e,t,r,o){this.parent=e,this.children=t,this.dom=r,this.contentDOM=o,this.dirty=qe,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let o=this.children[t];if(o==e)return r;r+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,s;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(s)+s.size:this.posAtStart}else{let i,s;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}let o;if(e==this.dom&&this.contentDOM)o=t>Fe(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){o=!1;break}if(i.previousSibling)break}if(o==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){o=!0;break}if(i.nextSibling)break}}return o??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,o=e;o;o=o.parentNode){let i=this.getDesc(o),s;if(i&&(!t||i.node))if(r&&(s=i.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let o=e;o;o=o.parentNode){let i=this.getDesc(o);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let o=this.children[t],i=r+o.size;if(r==e&&i!=r){for(;!o.border&&o.children.length;)o=o.children[0];return o}if(e<i)return o.descAt(e-r-o.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,o=0;for(let i=0;r<this.children.length;r++){let s=this.children[r],a=i+s.size;if(a>e||s instanceof eu){o=e-i;break}i=a}if(o)return this.children[r].domFromPos(o-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof Qc&&i.side>=0;r--);if(t<=0){let i,s=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,s=!1);return i&&t&&s&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Fe(i.dom)+1:0}}else{let i,s=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,s=!1);return i&&s&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Fe(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,i=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(o==-1&&e<=c){let u=s+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=s;for(let d=a;d>0;d--){let p=this.children[d-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){o=Fe(p.dom)+1;break}e-=p.size}o==-1&&(o=0)}if(o>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=Fe(d.dom);break}t+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:t,fromOffset:o,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,o=!1){let i=Math.min(e,t),s=Math.max(e,t);for(let p=0,h=0;p<this.children.length;p++){let f=this.children[p],m=h+f.size;if(i>h&&s<m)return f.setSelection(e-h-f.border,t-h-f.border,r,o);h=m}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((st||Ae)&&e==t){let{node:p,offset:h}=a;if(p.nodeType==3){if(u=!!(h&&p.nodeValue[h-1]==`
`),u&&h==p.nodeValue.length)for(let f=p,m;f;f=f.parentNode){if(m=f.nextSibling){m.nodeName=="BR"&&(a=l={node:m.parentNode,offset:Fe(m)+1});break}let g=f.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let f=p.childNodes[h-1];u=f&&(f.nodeName=="BR"||f.contentEditable=="false")}}if(st&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(o=!0)}if(!(o||u&&Ae)&&vn(a.node,a.offset,c.anchorNode,c.anchorOffset)&&vn(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==t)&&!u){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>t){let h=a;a=l,l=h}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,o=0;o<this.children.length;o++){let i=this.children[o],s=r+i.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+i.border,l=s-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==s?rn:Na,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=ht:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?rn:ht}r=s}this.dirty=rn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?rn:Na;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Qc extends jr{constructor(e,t,r,o){let i,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!i)return o;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==qe&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Bh extends jr{constructor(e,t,r,o){super(e,[],t,null),this.textDOM=r,this.text=o}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Dn extends jr{constructor(e,t,r,o){super(e,[],r,o),this.mark=t}static create(e,t,r,o){let i=o.nodeViews[t.type.name],s=i&&i(t,o,r);return(!s||!s.dom)&&(s=ut.renderSpec(document,t.type.spec.toDOM(t,r))),new Dn(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return this.dirty&ht||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ht&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=qe){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=qe}}slice(e,t,r){let o=Dn.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;t<s&&(i=rs(i,t,s,r)),e>0&&(i=rs(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o}}class Bt extends jr{constructor(e,t,r,o,i,s,a,l,c){super(e,[],i,s),this.node=t,this.outerDeco=r,this.innerDeco=o,this.nodeDOM=a}static create(e,t,r,o,i,s){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,o),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=ut.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let p=u;return u=ru(u,r,t),c?l=new _h(e,t,r,o,u,d||null,p,c,i,s+1):t.isText?new jo(e,t,r,o,u,p,i):new Bt(e,t,r,o,u,d||null,p,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>D.empty)}return e}matchesNode(e,t,r){return this.dirty==qe&&e.eq(this.node)&&ns(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,o=t,i=e.composing?this.localCompositionInfo(e,t):null,s=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new Hh(this,s&&s.node,e);Vh(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?K.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,o)},(c,u,d,p)=>{l.syncToMarks(c.marks,r,e);let h;l.findNodeMatch(c,u,d,p)||a&&e.state.selection.from>o&&e.state.selection.to<o+c.nodeSize&&(h=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,d,h,e)||l.updateNextNode(c,u,d,e,p,o)||l.addNode(c,u,d,e,o),o+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==rn)&&(s&&this.protectLocalComposition(e,s),tu(this.contentDOM,this.children,e),Kn&&Gh(this.dom))}localCompositionInfo(e,t){let{from:r,to:o}=e.state.selection;if(!(e.state.selection instanceof R)||r<t||o>t+this.node.content.size)return null;let i=e.domSelectionRange(),s=Wh(i.focusNode,i.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let a=s.nodeValue,l=Yh(this.node.content,a,r-t,o-t);return l<0?null:{node:s,pos:l,text:a}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:o}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new Bh(this,i,t,o);e.input.compositionNodes.push(s),this.children=rs(this.children,r,r+o.length,e,s)}update(e,t,r,o){return this.dirty==ht||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,o),!0)}updateInner(e,t,r,o){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=qe}updateOuterDeco(e){if(ns(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=nu(this.dom,this.nodeDOM,ts(this.outerDeco,this.node,t),ts(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function La(n,e,t,r,o){ru(r,e,n);let i=new Bt(void 0,n,e,t,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class jo extends Bt{constructor(e,t,r,o,i,s,a){super(e,t,r,o,i,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,o){return this.dirty==ht||this.dirty!=qe&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=qe||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=qe,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let o=this.node.cut(e,t),i=document.createTextNode(o.text);return new jo(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=ht)}get domAtom(){return!1}}class eu extends jr{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==qe&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class _h extends Bt{constructor(e,t,r,o,i,s,a,l,c,u){super(e,t,r,o,i,s,a,c,u),this.spec=l}update(e,t,r,o){if(this.dirty==ht)return!1;if(this.spec.update){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,o),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,o){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function tu(n,e,t){let r=n.firstChild,o=!1;for(let i=0;i<e.length;i++){let s=e[i],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=Ra(r),o=!0;r=r.nextSibling}else o=!0,n.insertBefore(a,r);if(s instanceof Dn){let l=r?r.previousSibling:n.lastChild;tu(s.contentDOM,s.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=Ra(r),o=!0;o&&t.trackWrites==n&&(t.trackWrites=null)}const wr=function(n){n&&(this.nodeName=n)};wr.prototype=Object.create(null);const on=[new wr];function ts(n,e,t){if(n.length==0)return on;let r=t?on[0]:new wr,o=[r];for(let i=0;i<n.length;i++){let s=n[i].type.attrs;if(s){s.nodeName&&o.push(r=new wr(s.nodeName));for(let a in s){let l=s[a];l!=null&&(t&&o.length==1&&o.push(r=new wr(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return o}function nu(n,e,t,r){if(t==on&&r==on)return e;let o=e;for(let i=0;i<r.length;i++){let s=r[i],a=t[i];if(i){let l;a&&a.nodeName==s.nodeName&&o!=n&&(l=o.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(o),a=on[0]),o=l}zh(o,a||on[0],s)}return o}function zh(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)o.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<o.length;i++)r.indexOf(o[i])==-1&&n.classList.add(o[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=r.exec(e.style);)n.style.removeProperty(o[1])}t.style&&(n.style.cssText+=t.style)}}function ru(n,e,t){return nu(n,n,on,ts(e,t,n.nodeType!=1))}function ns(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Ra(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Hh{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=jh(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let o=0,i=this.stack.length>>1,s=Math.min(i,e.length);for(;o<s&&(o==i-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<i;)this.destroyRest(),this.top.dirty=qe,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Dn.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,o){let i=-1,s;if(o>=this.preMatch.index&&(s=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))i=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,o,i){let s=this.top.children[o];return s.dirty==ht&&s.dom==s.contentDOM&&(s.dirty=rn),s.update(e,t,r,i)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o}return-1}e=t}}updateNextNode(e,t,r,o,i,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Bt){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,d,p=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ht&&ns(t,l.outerDeco));if(!p&&l.update(e,t,r,o))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!p&&(d=this.recreateWrapper(l,e,t,r,o,s)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=rn,d.updateChildren(o,s+1),d.dirty=qe),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,o,i,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=Bt.create(this.top,t,r,o,i,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,o,i){let s=Bt.create(this.top,e,t,r,o,i);s.contentDOM&&s.updateChildren(o,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(e)&&(e==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let i=new Qc(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Dn;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof jo)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ae||ke)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let o=new eu(this.top,[],r,null);t!=this.top?t.children.push(o):t.children.splice(this.index++,0,o),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function jh(n,e){let t=e,r=t.children.length,o=n.childCount,i=new Map,s=[];e:for(;o>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Dn)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}function Uh(n,e){return n.type.side-e.type.side}function Vh(n,e,t,r){let o=e.locals(n),i=0;if(o.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,o,e.forChild(i,u),c),i+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<o.length&&o[s].to==i;){let g=o[s++];g.widget&&(u?(d||(d=[u])).push(g):u=g)}if(u)if(d){d.sort(Uh);for(let g=0;g<d.length;g++)t(d[g],c,!!l)}else t(u,c,!!l);let p,h;if(l)h=-1,p=l,l=null;else if(c<n.childCount)h=c,p=n.child(c++);else break;for(let g=0;g<a.length;g++)a[g].to<=i&&a.splice(g--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);let f=i+p.nodeSize;if(p.isText){let g=f;s<o.length&&o[s].from<g&&(g=o[s].from);for(let y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<f&&(l=p.cut(g-i),p=p.cut(0,g-i),f=g,h=-1)}let m=p.isInline&&!p.isLeaf?a.filter(g=>!g.inline):a.slice();r(p,m,e.forChild(i,p),h),i=f}}function Gh(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function Wh(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=lt(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function Yh(n,e,t,r){for(let o=0,i=0;o<n.childCount&&i<=r;){let s=n.child(o++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<n.childCount;){let c=n.child(o++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function rs(n,e,t,r,o){let i=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),o&&(i.push(o),o=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function Ss(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let o=n.docView.nearestDesc(t.focusNode),i=o&&o.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(Ho(t)){for(l=a;o&&!o.node;)o=o.parent;let u=o.node;if(o&&u.isAtom&&N.isSelectable(u)&&o.parent&&!(u.isInline&&yh(t.focusNode,t.focusOffset,o.dom))){let d=o.posBefore;c=new N(s==d?a:r.resolve(d))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=Fs(n,l,a,u)}return c}function ou(n){return n.editable?n.hasFocus():su(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function xt(n,e=!1){let t=n.state.selection;if(iu(n,t),!!ou(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&ke){let r=n.domSelectionRange(),o=n.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&vn(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)qh(n);else{let{anchor:r,head:o}=t,i,s;Ba&&!(t instanceof R)&&(t.$from.parent.inlineContent||(i=_a(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=_a(n,t.to))),n.docView.setSelection(r,o,n.root,e),Ba&&(i&&za(i),s&&za(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Kh(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Ba=Ae||ke&&Dh<63;function _a(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),o=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(Ae&&o&&o.contentEditable=="false")return Ti(o);if((!o||o.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(o)return Ti(o);if(i)return Ti(i)}}function Ti(n){return n.contentEditable="true",Ae&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function za(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Kh(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,o=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=o)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!ou(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function qh(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,o=r.nodeName=="IMG";o?t.setEnd(r.parentNode,Fe(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!o&&!n.state.selection.visible&&Be&&Rt<=11&&(r.disabled=!0,r.disabled=!1)}function iu(n,e){if(e instanceof N){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Ha(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Ha(n)}function Ha(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Fs(n,e,t,r){return n.someProp("createSelectionBetween",o=>o(n,e,t))||R.between(e,t,r)}function ja(n){return n.editable&&!n.hasFocus()?!1:su(n)}function su(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Jh(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return vn(e.node,e.offset,t.anchorNode,t.anchorOffset)}function is(n,e){let{$anchor:t,$head:r}=n.selection,o=e>0?t.max(r):t.min(r),i=o.parent.inlineContent?o.depth?n.doc.resolve(e>0?o.after():o.before()):null:o;return i&&_.findFrom(i,e)}function St(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Ua(n,e,t){let r=n.state.selection;if(r instanceof R)if(t.indexOf("s")>-1){let{$head:o}=r,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=n.state.doc.resolve(o.pos+i.nodeSize*(e<0?-1:1));return St(n,new R(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let o=is(n.state,e);return o&&o instanceof N?St(n,o):!1}else if(!(Ke&&t.indexOf("m")>-1)){let o=r.$head,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter,s;if(!i||i.isText)return!1;let a=e<0?o.pos-i.nodeSize:o.pos;return i.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?N.isSelectable(i)?St(n,new N(e<0?n.state.doc.resolve(o.pos-i.nodeSize):o)):Hr?St(n,new R(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof N&&r.node.isInline)return St(n,new R(e>0?r.$to:r.$from));{let o=is(n.state,e);return o?St(n,o):!1}}}function bo(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function xr(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Fn(n,e){return e<0?Zh(n):Xh(n)}function Zh(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let o,i,s=!1;for(st&&t.nodeType==1&&r<bo(t)&&xr(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(xr(a,-1))o=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(au(t))break;{let a=t.previousSibling;for(;a&&xr(a,-1);)o=t.parentNode,i=Fe(a),a=a.previousSibling;if(a)t=a,r=bo(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?ss(n,t,r):o&&ss(n,o,i)}function Xh(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let o=bo(t),i,s;for(;;)if(r<o){if(t.nodeType!=1)break;let a=t.childNodes[r];if(xr(a,1))i=t,s=++r;else break}else{if(au(t))break;{let a=t.nextSibling;for(;a&&xr(a,1);)i=a.parentNode,s=Fe(a)+1,a=a.nextSibling;if(a)t=a,r=0,o=bo(t);else{if(t=t.parentNode,t==n.dom)break;r=o=0}}}i&&ss(n,i,s)}function au(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Qh(n,e){for(;n&&e==n.childNodes.length&&!Ms(n);)e=Fe(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function ef(n,e){for(;n&&!e&&!Ms(n);)e=Fe(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function ss(n,e,t){if(e.nodeType!=3){let i,s;(s=Qh(e,t))?(e=s,t=0):(i=ef(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(Ho(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:o}=n;setTimeout(()=>{n.state==o&&xt(n)},50)}function Va(n,e){let t=n.state.doc.resolve(e);if(!(ke||wh)&&t.parent.inlineContent){let o=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),s=(i.top+i.bottom)/2;if(s>o.top&&s<o.bottom&&Math.abs(i.left-o.left)>1)return i.left<o.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),s=(i.top+i.bottom)/2;if(s>o.top&&s<o.bottom&&Math.abs(i.left-o.left)>1)return i.left>o.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Ga(n,e,t){let r=n.state.selection;if(r instanceof R&&!r.empty||t.indexOf("s")>-1||Ke&&t.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=is(n.state,e);if(s&&s instanceof N)return St(n,s)}if(!o.parent.inlineContent){let s=e<0?o:i,a=r instanceof it?_.near(s,e):_.findFrom(s,e);return a?St(n,a):!1}return!1}function Wa(n,e){if(!(n.state.selection instanceof R))return!0;let{$head:t,$anchor:r,empty:o}=n.state.selection;if(!t.sameParent(r))return!0;if(!o)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let s=n.state.tr;return e<0?s.delete(t.pos-i.nodeSize,t.pos):s.delete(t.pos,t.pos+i.nodeSize),n.dispatch(s),!0}return!1}function Ya(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function tf(n){if(!Ae||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Ya(n,r,"true"),setTimeout(()=>Ya(n,r,"false"),20)}return!1}function nf(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function rf(n,e){let t=e.keyCode,r=nf(e);if(t==8||Ke&&t==72&&r=="c")return Wa(n,-1)||Fn(n,-1);if(t==46&&!e.shiftKey||Ke&&t==68&&r=="c")return Wa(n,1)||Fn(n,1);if(t==13||t==27)return!0;if(t==37||Ke&&t==66&&r=="c"){let o=t==37?Va(n,n.state.selection.from)=="ltr"?-1:1:-1;return Ua(n,o,r)||Fn(n,o)}else if(t==39||Ke&&t==70&&r=="c"){let o=t==39?Va(n,n.state.selection.from)=="ltr"?1:-1:1;return Ua(n,o,r)||Fn(n,o)}else{if(t==38||Ke&&t==80&&r=="c")return Ga(n,-1,r)||Fn(n,-1);if(t==40||Ke&&t==78&&r=="c")return tf(n)||Ga(n,1,r)||Fn(n,1);if(r==(Ke?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function lu(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:o,openEnd:i}=e;for(;o>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){o--,i--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||ut.fromSchema(n.state.schema),a=fu(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=hu[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let f=a.createElement(u[h]);for(;l.firstChild;)f.appendChild(l.firstChild);l.appendChild(f),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${o} ${i}${d?` -${d}`:""} ${JSON.stringify(t)}`);let p=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:p}}function cu(n,e,t,r,o){let i=o.parent.type.spec.code,s,a;if(!t&&!e)return null;let l=e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",p=>{e=p(e,i||r,n)}),i)return e?new T(D.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):T.empty;let d=n.someProp("clipboardTextParser",p=>p(e,o,r,n));if(d)a=d;else{let p=o.marks(),{schema:h}=n.state,f=ut.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=s.appendChild(document.createElement("p"));m&&g.appendChild(f.serializeNode(h.text(m,p)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),s=af(t),Hr&&lf(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let p=s.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;s=p}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Gn.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:o,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!of.test(p.parentNode.nodeName)?{ignore:!0}:null}})),u)a=cf(Ka(a,+u[1],+u[2]),u[4]);else if(a=T.maxOpen(sf(a.content,o),!0),a.openStart||a.openEnd){let d=0,p=0;for(let h=a.content.firstChild;d<a.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=a.content.lastChild;p<a.openEnd&&!h.type.spec.isolating;p++,h=h.lastChild);a=Ka(a,d,p)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const of=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function sf(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let o=e.node(t).contentMatchAt(e.index(t)),i,s=[];if(n.forEach(a=>{if(!s)return;let l=o.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&i.length&&du(l,i,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=pu(s[s.length-1],i.length));let u=uu(a,l);s.push(u),o=o.matchType(u.type),i=l}}),s)return D.from(s)}return n}function uu(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,D.from(n));return n}function du(n,e,t,r,o){if(o<n.length&&o<e.length&&n[o]==e[o]){let i=du(n,e,t,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==n.length-1?t.type:n[o+1]))return r.copy(r.content.append(D.from(uu(t,n,o+1))))}}function pu(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,pu(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(D.empty,!0);return n.copy(t.append(r))}function as(n,e,t,r,o,i){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(i=0),o<r-1&&(a=as(a,e,t,r,o+1,i)),o>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(D.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function Ka(n,e,t){return e<n.openStart&&(n=new T(as(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new T(as(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const hu={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let qa=null;function fu(){return qa||(qa=document.implementation.createHTMLDocument("title"))}function af(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=fu().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),o;if((o=r&&hu[r[1].toLowerCase()])&&(n=o.map(i=>"<"+i+">").join("")+n+o.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=n,o)for(let i=0;i<o.length;i++)t=t.querySelector(o[i])||t;return t}function lf(n){let e=n.querySelectorAll(ke?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function cf(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:o,openStart:i,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;o=D.from(l.create(r[a+1],o)),i++,s++}return new T(o,i,s)}const Oe={},Ie={},uf={touchstart:!0,touchmove:!0};class df{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function pf(n){for(let e in Oe){let t=Oe[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{ff(n,r)&&!Ps(n,r)&&(n.editable||!(r.type in Ie))&&t(n,r)},uf[e]?{passive:!0}:void 0)}Ae&&n.dom.addEventListener("input",()=>null),ls(n)}function $t(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function hf(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function ls(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Ps(n,r))})}function Ps(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function ff(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function mf(n,e){!Ps(n,e)&&Oe[e.type]&&(n.editable||!(e.type in Ie))&&Oe[e.type](n,e)}Ie.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!gu(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(rt&&ke&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Kn&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",o=>o(n,tn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||rf(n,t)?t.preventDefault():$t(n,"key")};Ie.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Ie.keypress=(n,e)=>{let t=e;if(gu(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Ke&&t.metaKey)return;if(n.someProp("handleKeyPress",o=>o(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof R)||!r.$from.sameParent(r.$to)){let o=String.fromCharCode(t.charCode);!/[\r\n]/.test(o)&&!n.someProp("handleTextInput",i=>i(n,r.$from.pos,r.$to.pos,o))&&n.dispatch(n.state.tr.insertText(o).scrollIntoView()),t.preventDefault()}};function Uo(n){return{left:n.clientX,top:n.clientY}}function gf(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function As(n,e,t,r,o){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let s=i.depth+1;s>0;s--)if(n.someProp(e,a=>s>i.depth?a(n,t,i.nodeAfter,i.before(s),o,!0):a(n,t,i.node(s),i.before(s),o,!1)))return!0;return!1}function Hn(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function yf(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&N.isSelectable(r)?(Hn(n,new N(t),"pointer"),!0):!1}function bf(n,e){if(e==-1)return!1;let t=n.state.selection,r,o;t instanceof N&&(r=t.node);let i=n.state.doc.resolve(e);for(let s=i.depth+1;s>0;s--){let a=s>i.depth?i.nodeAfter:i.node(s);if(N.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?o=i.before(t.$from.depth):o=i.before(s);break}}return o!=null?(Hn(n,N.create(n.state.doc,o),"pointer"),!0):!1}function vf(n,e,t,r,o){return As(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(o?bf(n,t):yf(n,t))}function Df(n,e,t,r){return As(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",o=>o(n,e,r))}function wf(n,e,t,r){return As(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",o=>o(n,e,r))||xf(n,t,r)}function xf(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Hn(n,R.create(r,0,r.content.size),"pointer"),!0):!1;let o=r.resolve(e);for(let i=o.depth+1;i>0;i--){let s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)Hn(n,R.create(r,a+1,a+1+s.content.size),"pointer");else if(N.isSelectable(s))Hn(n,N.create(r,a),"pointer");else continue;return!0}}function Os(n){return vo(n)}const mu=Ke?"metaKey":"ctrlKey";Oe.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Os(n),o=Date.now(),i="singleClick";o-n.input.lastClick.time<500&&gf(t,n.input.lastClick)&&!t[mu]&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:o,x:t.clientX,y:t.clientY,type:i};let s=n.posAtCoords(Uo(t));s&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Cf(n,s,t,!!r)):(i=="doubleClick"?Df:wf)(n,s.pos,s.inside,t)?t.preventDefault():$t(n,"pointer"))};class Cf{constructor(e,t,r,o){this.view=e,this.pos=t,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[mu],this.allowDefault=r.shiftKey;let i,s;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,s=u.depth?u.before():0}const a=o?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof N&&c.from<=s&&c.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&st&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),$t(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>xt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Uo(e))),this.updateAllowDefault(e),this.allowDefault||!t?$t(this.view,"pointer"):vf(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ae&&this.mightDrag&&!this.mightDrag.node.isAtom||ke&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Hn(this.view,_.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):$t(this.view,"pointer")}move(e){this.updateAllowDefault(e),$t(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Oe.touchstart=n=>{n.input.lastTouch=Date.now(),Os(n),$t(n,"pointer")};Oe.touchmove=n=>{n.input.lastTouch=Date.now(),$t(n,"pointer")};Oe.contextmenu=n=>Os(n);function gu(n,e){return n.composing?!0:Ae&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const kf=rt?5e3:-1;Ie.compositionstart=Ie.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),vo(n,!0),n.markCursor=null;else if(vo(n),st&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let o=r.focusNode,i=r.focusOffset;o&&o.nodeType==1&&i!=0;){let s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(s.nodeType==3){n.domSelection().collapse(s,s.nodeValue.length);break}else o=s,i=-1}}n.input.composing=!0}yu(n,kf)};Ie.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,yu(n,20))};function yu(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>vo(n),e))}function bu(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=Ef());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function Ef(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function vo(n,e=!1){if(!(rt&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),bu(n),e||n.docView&&n.docView.dirty){let t=Ss(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function Mf(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const qn=Be&&Rt<15||Kn&&xh<604;Oe.copy=Ie.cut=(n,e)=>{let t=e,r=n.state.selection,o=t.type=="cut";if(r.empty)return;let i=qn?null:t.clipboardData,s=r.content(),{dom:a,text:l}=lu(n,s);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):Mf(n,a),o&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Tf(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function Sf(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Fr(n,r.value,null,o,e):Fr(n,r.textContent,r.innerHTML,o,e)},50)}function Fr(n,e,t,r,o){let i=cu(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,o,i||T.empty)))return!0;if(!i)return!1;let s=Tf(i),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Ie.paste=(n,e)=>{let t=e;if(n.composing&&!rt)return;let r=qn?null:t.clipboardData,o=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Fr(n,r.getData("text/plain"),r.getData("text/html"),o,t)?t.preventDefault():Sf(n,t)};class Ff{constructor(e,t){this.slice=e,this.move=t}}const vu=Ke?"altKey":"ctrlKey";Oe.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let o=n.state.selection,i=o.empty?null:n.posAtCoords(Uo(t));if(!(i&&i.pos>=o.from&&i.pos<=(o instanceof N?o.to-1:o.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(N.create(n.state.doc,r.mightDrag.pos)));else if(t.target&&t.target.nodeType==1){let c=n.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&n.dispatch(n.state.tr.setSelection(N.create(n.state.doc,c.posBefore)))}}let s=n.state.selection.content(),{dom:a,text:l}=lu(n,s);t.dataTransfer.clearData(),t.dataTransfer.setData(qn?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",qn||t.dataTransfer.setData("text/plain",l),n.dragging=new Ff(s,!t[vu])};Oe.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Ie.dragover=Ie.dragenter=(n,e)=>e.preventDefault();Ie.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let o=n.posAtCoords(Uo(t));if(!o)return;let i=n.state.doc.resolve(o.pos),s=r&&r.slice;s?n.someProp("transformPasted",f=>{s=f(s,n)}):s=cu(n,t.dataTransfer.getData(qn?"Text":"text/plain"),qn?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&!t[vu]);if(n.someProp("handleDrop",f=>f(n,t,s||T.empty,a))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?_c(n.state.doc,i.pos,s):i.pos;l==null&&(l=i.pos);let c=n.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,p=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(p))return;let h=c.doc.resolve(u);if(d&&N.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new N(h));else{let f=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,y,b)=>f=b),c.setSelection(Fs(n,h,c.doc.resolve(f)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Oe.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&xt(n)},20))};Oe.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Oe.beforeinput=(n,e)=>{if(ke&&rt&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,tn(8,"Backspace")))))return;let{$cursor:o}=n.state.selection;o&&o.pos>0&&n.dispatch(n.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let n in Ie)Oe[n]=Ie[n];function Pr(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Do{constructor(e,t){this.toDOM=e,this.spec=t||pn,this.side=this.spec.side||0}map(e,t,r,o){let{pos:i,deleted:s}=e.mapResult(t.from+o,this.side<0?-1:1);return s?null:new Ge(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Do&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Pr(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class _t{constructor(e,t){this.attrs=e,this.spec=t||pn}map(e,t,r,o){let i=e.map(t.from+o,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+o,this.spec.inclusiveEnd?1:-1)-r;return i>=s?null:new Ge(i,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof _t&&Pr(this.attrs,e.attrs)&&Pr(this.spec,e.spec)}static is(e){return e.type instanceof _t}destroy(){}}class Is{constructor(e,t){this.attrs=e,this.spec=t||pn}map(e,t,r,o){let i=e.mapResult(t.from+o,1);if(i.deleted)return null;let s=e.mapResult(t.to+o,-1);return s.deleted||s.pos<=i.pos?null:new Ge(i.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:o}=e.content.findIndex(t.from),i;return o==t.from&&!(i=e.child(r)).isText&&o+i.nodeSize==t.to}eq(e){return this==e||e instanceof Is&&Pr(this.attrs,e.attrs)&&Pr(this.spec,e.spec)}destroy(){}}class Ge{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Ge(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Ge(e,e,new Do(t,r))}static inline(e,t,r,o){return new Ge(e,t,new _t(r,o))}static node(e,t,r,o){return new Ge(e,t,new Is(r,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof _t}get widget(){return this.type instanceof Do}}const $n=[],pn={};class te{constructor(e,t){this.local=e.length?e:$n,this.children=t.length?t:$n}static create(e,t){return t.length?wo(t,e,0,pn):Ce}find(e,t,r){let o=[];return this.findInner(e??0,t??1e9,o,0,r),o}findInner(e,t,r,o,i){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+o,a.to+o))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,o+a,i)}}map(e,t,r){return this==Ce||e.maps.length==0?this:this.mapInner(e,t,0,0,r||pn)}mapInner(e,t,r,o,i){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,o);l&&l.type.valid(t,l)?(s||(s=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?Pf(this.children,s||[],e,t,r,o,i):s?new te(s.sort(hn),$n):Ce}add(e,t){return t.length?this==Ce?te.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let o,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=wu(t,a,c)){for(o||(o=this.children.slice());i<o.length&&o[i]<l;)i+=3;o[i]==l?o[i+2]=o[i+2].addInner(a,u,c+1):o.splice(i,0,l,l+a.nodeSize,wo(u,a,c+1,pn)),i+=3}});let s=Du(i?xu(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new te(s.length?this.local.concat(s).sort(hn):this.local,o||this.children)}remove(e){return e.length==0||this==Ce?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,o=this.local;for(let i=0;i<r.length;i+=3){let s,a=r[i]+t,l=r[i+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(s,a+1);c!=Ce?r[i+2]=c:(r.splice(i,3),i-=3)}if(o.length){for(let i=0,s;i<e.length;i++)if(s=e[i])for(let a=0;a<o.length;a++)o[a].eq(s,t)&&(o==this.local&&(o=this.local.slice()),o.splice(a--,1))}return r==this.children&&o==this.local?this:o.length||r.length?new te(o,r):Ce}forChild(e,t){if(this==Ce)return this;if(t.isLeaf)return te.empty;let r,o;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,s=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>i&&l.type instanceof _t){let c=Math.max(i,l.from)-i,u=Math.min(s,l.to)-i;c<u&&(o||(o=[])).push(l.copy(c,u))}}if(o){let a=new te(o.sort(hn),$n);return r?new At([a,r]):a}return r||Ce}eq(e){if(this==e)return!0;if(!(e instanceof te)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return $s(this.localsInner(e))}localsInner(e){if(this==Ce)return $n;if(e.inlineContent||!this.local.some(_t.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof _t||t.push(this.local[r]);return t}}te.empty=new te([],[]);te.removeOverlap=$s;const Ce=te.empty;class At{constructor(e){this.members=e}map(e,t){const r=this.members.map(o=>o.map(e,t,pn));return At.from(r)}forChild(e,t){if(t.isLeaf)return te.empty;let r=[];for(let o=0;o<this.members.length;o++){let i=this.members[o].forChild(e,t);i!=Ce&&(i instanceof At?r=r.concat(i.members):r.push(i))}return At.from(r)}eq(e){if(!(e instanceof At)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let o=0;o<this.members.length;o++){let i=this.members[o].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let s=0;s<i.length;s++)t.push(i[s])}}return t?$s(r?t:t.sort(hn)):$n}static from(e){switch(e.length){case 0:return Ce;case 1:return e[0];default:return new At(e.every(t=>t instanceof te)?e:e.reduce((t,r)=>t.concat(r instanceof te?r:r.members),[]))}}}function Pf(n,e,t,r,o,i,s){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let d=0;t.maps[c].forEach((p,h,f,m)=>{let g=m-f-(h-p);for(let y=0;y<a.length;y+=3){let b=a[y+1];if(b<0||p>b+u-d)continue;let v=a[y]+u-d;h>=v?a[y+1]=p<=v?-2:-1:f>=o&&g&&(a[y]+=g,a[y+1]+=g)}d+=g}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),d=u-o;if(d<0||d>=r.content.size){l=!0;continue}let p=t.map(n[c+1]+i,-1),h=p-o,{index:f,offset:m}=r.content.findIndex(d),g=r.maybeChild(f);if(g&&m==d&&m+g.nodeSize==h){let y=a[c+2].mapInner(t,g,u+1,n[c]+i+1,s);y!=Ce?(a[c]=d,a[c+1]=h,a[c+2]=y):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=Af(a,n,e,t,o,i,s),u=wo(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,p=0;d<u.children.length;d+=3){let h=u.children[d];for(;p<a.length&&a[p]<h;)p+=3;a.splice(p,0,u.children[d],u.children[d+1],u.children[d+2])}}return new te(e.sort(hn),a)}function Du(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let o=n[r];t.push(new Ge(o.from+e,o.to+e,o.type))}return t}function Af(n,e,t,r,o,i,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,o,c);d?t.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function wu(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,o=null;for(let i=0,s;i<n.length;i++)(s=n[i])&&s.from>t&&s.to<r&&((o||(o=[])).push(s),n[i]=null);return o}function xu(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function wo(n,e,t,r){let o=[],i=!1;e.forEach((a,l)=>{let c=wu(n,a,l+t);if(c){i=!0;let u=wo(c,a,t+l+1,r);u!=Ce&&o.push(l,l+a.nodeSize,u)}});let s=Du(i?xu(n):n,-t).sort(hn);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new te(s,o):Ce}function hn(n,e){return n.from-e.from||n.to-e.to}function $s(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let o=t+1;o<e.length;o++){let i=e[o];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[o]=i.copy(i.from,r.to),Ja(e,o+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),Ja(e,o,r.copy(i.from,r.to)));break}}}return e}function Ja(n,e,t){for(;e<n.length&&hn(t,n[e])>0;)e++;n.splice(e,0,t)}function Si(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ce&&e.push(r)}),n.cursorWrapper&&e.push(te.create(n.state.doc,[n.cursorWrapper.deco])),At.from(e)}const Of={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},If=Be&&Rt<=11;class $f{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Nf{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new $f,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let o=0;o<r.length;o++)this.queue.push(r[o]);Be&&Rt<=11&&r.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),If&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Of)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(ja(this.view)){if(this.suppressingSelectionUpdates)return xt(this.view);if(Be&&Rt<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&vn(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=Sr(i))t.add(i);for(let i=e.anchorNode;i;i=Sr(i))if(t.has(i)){r=i;break}let o=r&&this.view.docView.nearestDesc(r);if(o&&o.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&ja(e)&&!this.ignoreSelectionChange(r),i=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(i=i<0?d.from:Math.min(d.from,i),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(st&&l.length>1){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let d=u[0],p=u[1];d.parentNode&&d.parentNode.parentNode==p.parentNode?p.remove():d.remove()}}let c=null;i<0&&o&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ho(r)&&(c=Ss(e))&&c.eq(_.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,xt(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||o)&&(i>-1&&(e.docView.markDirty(i,s),Lf(e)),this.handleDOMChange(i,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||xt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++)t.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let o=e.previousSibling,i=e.nextSibling;if(Be&&Rt<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:p}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(i=p)}let s=o&&o.parentNode==e.target?Fe(o)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=i&&i.parentNode==e.target?Fe(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let Za=new WeakMap,Xa=!1;function Lf(n){if(!Za.has(n)&&(Za.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=st,Xa)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Xa=!0}}function Rf(n){let e;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,o=e.startOffset,i=e.endContainer,s=e.endOffset,a=n.domAtPos(n.state.selection.anchor);return vn(a.node,a.offset,i,s)&&([r,o,i,s]=[i,s,r,o]),{anchorNode:r,anchorOffset:o,focusNode:i,focusOffset:s}}function Bf(n,e,t){let{node:r,fromOffset:o,toOffset:i,from:s,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Ho(l)||c.push({node:l.focusNode,offset:l.focusOffset})),ke&&n.input.lastKeyCode===8)for(let g=i;g>o;g--){let y=r.childNodes[g-1],b=y.pmViewDesc;if(y.nodeName=="BR"&&!b){i=g;break}if(!b||b.size)break}let d=n.state.doc,p=n.someProp("domParser")||Gn.fromSchema(n.state.schema),h=d.resolve(s),f=null,m=p.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:o,to:i,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:_f,context:h});if(c&&c[0].pos!=null){let g=c[0].pos,y=c[1]&&c[1].pos;y==null&&(y=g),f={anchor:g+s,head:y+s}}return{doc:m,sel:f,from:s,to:a}}function _f(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ae&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Ae&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const zf=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Hf(n,e,t,r,o){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let E=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,z=Ss(n,E);if(z&&!n.state.selection.eq(z)){if(ke&&rt&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",L=>L(n,tn(13,"Enter"))))return;let S=n.state.tr.setSelection(z);E=="pointer"?S.setMeta("pointer",!0):E=="key"&&S.scrollIntoView(),i&&S.setMeta("composition",i),n.dispatch(S)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=Bf(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),p,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(p=n.state.selection.to,h="end"):(p=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let f=Vf(d.content,c.doc.content,c.from,p,h);if((Kn&&n.input.lastIOSEnter>Date.now()-225||rt)&&o.some(E=>E.nodeType==1&&!zf.test(E.nodeName))&&(!f||f.endA>=f.endB)&&n.someProp("handleKeyDown",E=>E(n,tn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!f)if(r&&l instanceof R&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))f={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let E=Qa(n,n.state.doc,c.sel);if(E&&!E.eq(n.state.selection)){let z=n.state.tr.setSelection(E);i&&z.setMeta("composition",i),n.dispatch(z)}}return}if(ke&&n.cursorWrapper&&c.sel&&c.sel.anchor==n.cursorWrapper.deco.from&&c.sel.head==c.sel.anchor){let E=f.endB-f.start;c.sel={anchor:c.sel.anchor+E,head:c.sel.anchor+E}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&f.start==f.endB&&n.state.selection instanceof R&&(f.start>n.state.selection.from&&f.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?f.start=n.state.selection.from:f.endA<n.state.selection.to&&f.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(f.endB+=n.state.selection.to-f.endA,f.endA=n.state.selection.to)),Be&&Rt<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>c.from&&c.doc.textBetween(f.start-c.from-1,f.start-c.from+1)=="  "&&(f.start--,f.endA--,f.endB--);let m=c.doc.resolveNoCache(f.start-c.from),g=c.doc.resolveNoCache(f.endB-c.from),y=u.resolve(f.start),b=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=f.endA,v;if((Kn&&n.input.lastIOSEnter>Date.now()-225&&(!b||o.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!b&&m.pos<c.doc.content.size&&!m.sameParent(g)&&(v=_.findFrom(c.doc.resolve(m.pos+1),1,!0))&&v.head==g.pos)&&n.someProp("handleKeyDown",E=>E(n,tn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>f.start&&Uf(u,f.start,f.endA,m,g)&&n.someProp("handleKeyDown",E=>E(n,tn(8,"Backspace")))){rt&&ke&&n.domObserver.suppressSelectionUpdates();return}ke&&rt&&f.endB==f.start&&(n.input.lastAndroidDelete=Date.now()),rt&&!b&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==f.endA&&(f.endB-=2,g=c.doc.resolveNoCache(f.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(E){return E(n,tn(13,"Enter"))})},20));let k=f.start,x=f.endA,C,A,$;if(b){if(m.pos==g.pos)Be&&Rt<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>xt(n),20)),C=n.state.tr.delete(k,x),A=u.resolve(f.start).marksAcross(u.resolve(f.endA));else if(f.endA==f.endB&&($=jf(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,f.endA-y.start()))))C=n.state.tr,$.type=="add"?C.addMark(k,x,$.mark):C.removeMark(k,x,$.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let E=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",z=>z(n,k,x,E)))return;C=n.state.tr.insertText(E,k,x)}}if(C||(C=n.state.tr.replace(k,x,c.doc.slice(f.start-c.from,f.endB-c.from))),c.sel){let E=Qa(n,C.doc,c.sel);E&&!(ke&&rt&&n.composing&&E.empty&&(f.start!=f.endB||n.input.lastAndroidDelete<Date.now()-100)&&(E.head==k||E.head==C.mapping.map(x)-1)||Be&&E.empty&&E.head==k)&&C.setSelection(E)}A&&C.ensureMarks(A),i&&C.setMeta("composition",i),n.dispatch(C.scrollIntoView())}function Qa(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Fs(n,e.resolve(t.anchor),e.resolve(t.head))}function jf(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,o=t,i=r,s,a,l;for(let u=0;u<r.length;u++)o=r[u].removeFromSet(o);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(o.length==1&&i.length==0)a=o[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(o.length==0&&i.length==1)a=i[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(D.from(c).eq(n))return{mark:a,type:s}}function Uf(n,e,t,r,o){if(!r.parent.isTextblock||t-e<=o.pos-r.pos||Fi(r,!0,!1)<o.pos)return!1;let i=n.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=n.resolve(Fi(i,!0,!0));return!s.parent.isTextblock||s.pos>t||Fi(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Fi(n,e,t){let r=n.depth,o=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,o++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,o++}return o}function Vf(n,e,t,r,o){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(o=="end"){let l=Math.max(0,i-Math.min(s,a));r-=s+l-i}if(s<i&&n.size<e.size){let l=r<=i&&r>=s?i-r:0;i-=l,a=i+(a-s),s=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}class Gf{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new df,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(ol),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=nl(this),tl(this),this.nodeViews=rl(this),this.docView=La(this.state.doc,el(this),Si(this),this.dom,this),this.domObserver=new Nf(this,(r,o,i,s)=>Hf(this,r,o,i,s)),this.domObserver.start(),pf(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ls(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(ol),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){let r=this.state,o=!1,i=!1;e.storedMarks&&this.composing&&(bu(this),i=!0),this.state=e;let s=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(s||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=rl(this);Yf(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(s||t.handleDOMEvents!=this._props.handleDOMEvents)&&ls(this),this.editable=nl(this),tl(this);let a=Si(this),l=el(this),c=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,l,a);(u||!e.selection.eq(r.selection))&&(i=!0);let d=c=="preserve"&&i&&this.dom.style.overflowAnchor==null&&Eh(this);if(i){this.domObserver.stop();let p=u&&(Be||ke)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&Wf(r.selection,e.selection);if(u){let h=ke?this.trackWrites=this.domSelectionRange().focusNode:null;(o||!this.docView.update(e.doc,l,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=La(e.doc,l,a,this.dom,this)),h&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Jh(this))?xt(this,p):(iu(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&Mh(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof N){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Pa(this,t.getBoundingClientRect(),e)}else Pa(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}someProp(e,t){let r=this._props&&this._props[e],o;if(r!=null&&(o=t?t(r):r))return o;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(o=t?t(a):a))return o}let i=this.state.plugins;if(i)for(let s=0;s<i.length;s++){let a=i[s].props[e];if(a!=null&&(o=t?t(a):a))return o}}hasFocus(){if(Be){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&Th(this.dom),xt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Oh(this,e)}coordsAtPos(e,t=1){return Zc(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let o=this.docView.posFromDOM(e,t,r);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,t){return Rh(this,t||this.state,e)}pasteHTML(e,t){return Fr(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Fr(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(hf(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Si(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return mf(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Ae&&this.root.nodeType===11&&bh(this.dom.ownerDocument)==this.dom?Rf(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function el(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Ge.node(0,n.state.doc.content.size,e)]}function tl(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Ge.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function nl(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Wf(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function rl(n){let e=Object.create(null);function t(r){for(let o in r)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=r[o])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function Yf(n,e){let t=0,r=0;for(let o in n){if(n[o]!=e[o])return!0;t++}for(let o in e)r++;return t!=r}function ol(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var jt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},xo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Kf=typeof navigator<"u"&&/Mac/.test(navigator.platform),qf=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ye=0;ye<10;ye++)jt[48+ye]=jt[96+ye]=String(ye);for(var ye=1;ye<=24;ye++)jt[ye+111]="F"+ye;for(var ye=65;ye<=90;ye++)jt[ye]=String.fromCharCode(ye+32),xo[ye]=String.fromCharCode(ye);for(var Pi in jt)xo.hasOwnProperty(Pi)||(xo[Pi]=jt[Pi]);function Jf(n){var e=Kf&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||qf&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?xo:jt)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Zf=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Xf(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,o,i,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Zf?s=!0:o=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),o&&(t="Ctrl-"+t),s&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function Qf(n){let e=Object.create(null);for(let t in n)e[Xf(t)]=n[t];return e}function Ai(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function em(n){return new Ne({props:{handleKeyDown:Cu(n)}})}function Cu(n){let e=Qf(n);return function(t,r){let o=Jf(r),i,s=e[Ai(o,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(o.length==1&&o!=" "){if(r.shiftKey){let a=e[Ai(o,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||o.charCodeAt(0)>127)&&(i=jt[r.keyCode])&&i!=o){let a=e[Ai(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const tm=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function nm(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const rm=(n,e,t)=>{let r=nm(n,t);if(!r)return!1;let o=ku(r);if(!o){let s=r.blockRange(),a=s&&or(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let i=o.nodeBefore;if(!i.type.spec.isolating&&Tu(n,o,e))return!0;if(r.parent.content.size==0&&(Jn(i,"end")||N.isSelectable(i))){let s=ks(n.doc,r.before(),r.after(),T.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(Jn(i,"end")?_.findFrom(a.doc.resolve(a.mapping.map(o.pos,-1)),-1):N.create(a.doc,o.pos-i.nodeSize)),e(a.scrollIntoView())}return!0}}return i.isAtom&&o.depth==r.depth-1?(e&&e(n.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0):!1};function Jn(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const om=(n,e,t)=>{let{$head:r,empty:o}=n.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=ku(r)}let s=i&&i.nodeBefore;return!s||!N.isSelectable(s)?!1:(e&&e(n.tr.setSelection(N.create(n.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function ku(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function im(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const sm=(n,e,t)=>{let r=im(n,t);if(!r)return!1;let o=Eu(r);if(!o)return!1;let i=o.nodeAfter;if(Tu(n,o,e))return!0;if(r.parent.content.size==0&&(Jn(i,"start")||N.isSelectable(i))){let s=ks(n.doc,r.before(),r.after(),T.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(Jn(i,"start")?_.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):N.create(a.doc,a.mapping.map(o.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&o.depth==r.depth-1?(e&&e(n.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0):!1},am=(n,e,t)=>{let{$head:r,empty:o}=n.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=Eu(r)}let s=i&&i.nodeAfter;return!s||!N.isSelectable(s)?!1:(e&&e(n.tr.setSelection(N.create(n.doc,i.pos)).scrollIntoView()),!0)};function Eu(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const lm=(n,e)=>{let t=n.selection,r=t instanceof N,o;if(r){if(t.node.isTextblock||!Yt(n.doc,t.from))return!1;o=t.from}else if(o=_o(n.doc,t.from,-1),o==null)return!1;if(e){let i=n.tr.join(o);r&&i.setSelection(N.create(i.doc,o-n.doc.resolve(o).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},cm=(n,e)=>{let t=n.selection,r;if(t instanceof N){if(t.node.isTextblock||!Yt(n.doc,t.to))return!1;r=t.to}else if(r=_o(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},um=(n,e)=>{let{$from:t,$to:r}=n.selection,o=t.blockRange(r),i=o&&or(o);return i==null?!1:(e&&e(n.tr.lift(o,i).scrollIntoView()),!0)},dm=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Mu(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const pm=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let o=t.node(-1),i=t.indexAfter(-1),s=Mu(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(_.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},hm=(n,e)=>{let t=n.selection,{$from:r,$to:o}=t;if(t instanceof it||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=Mu(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=n.tr.insert(s,i.createAndFill());a.setSelection(R.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},fm=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(_n(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),o=r&&or(r);return o==null?!1:(e&&e(n.tr.lift(r,o).scrollIntoView()),!0)},mm=(n,e)=>{let{$from:t,to:r}=n.selection,o,i=t.sharedDepth(r);return i==0?!1:(o=t.before(i),e&&e(n.tr.setSelection(N.create(n.doc,o))),!0)};function gm(n,e,t){let r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!r||!o||!r.type.compatibleContent(o.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(o.isTextblock||Yt(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Tu(n,e,t){let r=e.nodeBefore,o=e.nodeAfter,i,s;if(r.type.spec.isolating||o.type.spec.isolating)return!1;if(gm(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(i=(s=r.contentMatchAt(r.childCount)).findWrapping(o.type))&&s.matchType(i[0]||o.type).validEnd){if(t){let d=e.pos+o.nodeSize,p=D.empty;for(let m=i.length-1;m>=0;m--)p=D.from(i[m].create(null,p));p=D.from(r.copy(p));let h=n.tr.step(new ae(e.pos-1,d,e.pos,d,new T(p,1,0),i.length,!0)),f=d+2*i.length;Yt(h.doc,f)&&h.join(f),t(h.scrollIntoView())}return!0}let l=_.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&or(c);if(u!=null&&u>=e.depth)return t&&t(n.tr.lift(c,u).scrollIntoView()),!0;if(a&&Jn(o,"start",!0)&&Jn(r,"end")){let d=r,p=[];for(;p.push(d),!d.isTextblock;)d=d.lastChild;let h=o,f=1;for(;!h.isTextblock;h=h.firstChild)f++;if(d.canReplace(d.childCount,d.childCount,h.content)){if(t){let m=D.empty;for(let y=p.length-1;y>=0;y--)m=D.from(p[y].copy(m));let g=n.tr.step(new ae(e.pos-p.length,e.pos+o.nodeSize,e.pos+f,e.pos+o.nodeSize-f,new T(m,p.length,0),0,!0));t(g.scrollIntoView())}return!0}}return!1}function Su(n){return function(e,t){let r=e.selection,o=n<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return o.node(i).isTextblock?(t&&t(e.tr.setSelection(R.create(e.doc,n<0?o.start(i):o.end(i)))),!0):!1}}const ym=Su(-1),bm=Su(1);function vm(n,e=null){return function(t,r){let{$from:o,$to:i}=t.selection,s=o.blockRange(i),a=s&&Cs(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function il(n,e=null){return function(t,r){let o=!1;for(let i=0;i<t.selection.ranges.length&&!o;i++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(s,a,(l,c)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)o=!0;else{let u=t.doc.resolve(c),d=u.index();o=u.parent.canReplaceWith(d,d+1,n)}})}if(!o)return!1;if(r){let i=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Dm(n,e=null){return function(t,r){let{$from:o,$to:i}=t.selection,s=o.blockRange(i),a=!1,l=s;if(!s)return!1;if(s.depth>=2&&o.node(s.depth-1).type.compatibleContent(n)&&s.startIndex==0){if(o.index(s.depth-1)==0)return!1;let u=t.doc.resolve(s.start-2);l=new fo(u,u,s.depth),s.endIndex<s.parent.childCount&&(s=new fo(o,t.doc.resolve(i.end(s.depth)),s.depth)),a=!0}let c=Cs(l,n,e,s);return c?(r&&r(wm(t.tr,s,c,a,n).scrollIntoView()),!0):!1}}function wm(n,e,t,r,o){let i=D.empty;for(let u=t.length-1;u>=0;u--)i=D.from(t[u].type.create(t[u].attrs,i));n.step(new ae(e.start-(r?2:0),e.end,e.start,e.end,new T(i,0,0),t.length,!0));let s=0;for(let u=0;u<t.length;u++)t[u].type==o&&(s=u+1);let a=t.length-s,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,p=!0;u<d;u++,p=!1)!p&&_n(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function xm(n){return function(e,t){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,s=>s.childCount>0&&s.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?Cm(e,t,n,i):km(e,t,i):!0:!1}}function Cm(n,e,t,r){let o=n.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new ae(i-1,s,i,s,new T(D.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new fo(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));const a=or(r);if(a==null)return!1;o.lift(r,a);let l=o.mapping.map(i,-1)-1;return Yt(o.doc,l)&&o.join(l),e(o.scrollIntoView()),!0}function km(n,e,t){let r=n.tr,o=t.parent;for(let h=t.end,f=t.endIndex-1,m=t.startIndex;f>m;f--)h-=o.child(f).nodeSize,r.delete(h-1,h+1);let i=r.doc.resolve(t.start),s=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==o.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?D.empty:D.from(o))))return!1;let d=i.pos,p=d+s.nodeSize;return r.step(new ae(d-(a?1:0),p+(l?1:0),d+1,p-1,new T((a?D.empty:D.from(o.copy(D.empty))).append(l?D.empty:D.from(o.copy(D.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function Em(n){return function(e,t){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let s=i.startIndex;if(s==0)return!1;let a=i.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=D.from(c?n.create():null),d=new T(D.from(n.create(null,D.from(a.type.create(null,u)))),c?3:1,0),p=i.start,h=i.end;t(e.tr.step(new ae(p-(c?3:1),h,p,h,d,1,!0)).scrollIntoView())}return!0}}function Vo(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:o}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=t.selection,o=t.doc,i=t.storedMarks,t}}}class Go{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:o}=t,{tr:i}=r,s=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:o,state:i}=this,{view:s}=o,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(r).map(([p,h])=>[p,(...m)=>{const g=this.buildProps(c,t),y=h(...m)(g);return a.push(y),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,o=!1,i=e||r.tr,s=this.buildProps(i,o);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,o)}}buildProps(e,t=!0){const{rawCommands:r,editor:o,state:i}=this,{view:s}=o,a={tr:e,editor:o,view:s,state:Vo({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class Mm{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(o=>o.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(o=>o!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function F(n,e,t){return n.config[e]===void 0&&n.parent?F(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?F(n.parent,e,t):null}):n.config[e]}function Wo(n){const e=n.filter(o=>o.type==="extension"),t=n.filter(o=>o.type==="node"),r=n.filter(o=>o.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Fu(n){const e=[],{nodeExtensions:t,markExtensions:r}=Wo(n),o=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=F(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([p,h])=>{e.push({type:d,name:p,attribute:{...i,...h}})})})})}),o.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=F(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const p={...i,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:s.name,name:u,attribute:p})})}),e}function ce(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function X(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([o,i])=>{if(!r[o]){r[o]=i;return}if(o==="class"){const a=i?i.split(" "):[],l=r[o]?r[o].split(" "):[],c=a.filter(u=>!l.includes(u));r[o]=[...l,...c].join(" ")}else o==="style"?r[o]=[r[o],i].join("; "):r[o]=i}),r},{})}function cs(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>X(t,r),{})}function Pu(n){return typeof n=="function"}function B(n,e=void 0,...t){return Pu(n)?e?n.bind(e)(...t):n(...t):n}function Tm(n={}){return Object.keys(n).length===0&&n.constructor===Object}function Sm(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function sl(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const o=e.reduce((i,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):Sm(t.getAttribute(s.name));return a==null?i:{...i,[s.name]:a}},{});return{...r,...o}}}}function al(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&Tm(t)?!1:t!=null))}function Fm(n,e){var t;const r=Fu(n),{nodeExtensions:o,markExtensions:i}=Wo(n),s=(t=o.find(c=>F(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(o.map(c=>{const u=r.filter(y=>y.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},p=n.reduce((y,b)=>{const v=F(b,"extendNodeSchema",d);return{...y,...v?v(c):{}}},{}),h=al({...p,content:B(F(c,"content",d)),marks:B(F(c,"marks",d)),group:B(F(c,"group",d)),inline:B(F(c,"inline",d)),atom:B(F(c,"atom",d)),selectable:B(F(c,"selectable",d)),draggable:B(F(c,"draggable",d)),code:B(F(c,"code",d)),defining:B(F(c,"defining",d)),isolating:B(F(c,"isolating",d)),attrs:Object.fromEntries(u.map(y=>{var b;return[y.name,{default:(b=y==null?void 0:y.attribute)===null||b===void 0?void 0:b.default}]}))}),f=B(F(c,"parseHTML",d));f&&(h.parseDOM=f.map(y=>sl(y,u)));const m=F(c,"renderHTML",d);m&&(h.toDOM=y=>m({node:y,HTMLAttributes:cs(y,u)}));const g=F(c,"renderText",d);return g&&(h.toText=g),[c.name,h]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(g=>g.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},p=n.reduce((g,y)=>{const b=F(y,"extendMarkSchema",d);return{...g,...b?b(c):{}}},{}),h=al({...p,inclusive:B(F(c,"inclusive",d)),excludes:B(F(c,"excludes",d)),group:B(F(c,"group",d)),spanning:B(F(c,"spanning",d)),code:B(F(c,"code",d)),attrs:Object.fromEntries(u.map(g=>{var y;return[g.name,{default:(y=g==null?void 0:g.attribute)===null||y===void 0?void 0:y.default}]}))}),f=B(F(c,"parseHTML",d));f&&(h.parseDOM=f.map(g=>sl(g,u)));const m=F(c,"renderHTML",d);return m&&(h.toDOM=g=>m({mark:g,HTMLAttributes:cs(g,u)})),[c.name,h]}));return new Lp({topNode:s,nodes:a,marks:l})}function Oi(n,e){return e.nodes[n]||e.marks[n]||null}function ll(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const Pm=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(o,i,s,a)=>{var l,c;const u=((c=(l=o.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:o,pos:i,parent:s,index:a}))||o.textContent||"%leaf%";t+=u.slice(0,Math.max(0,r-i))}),t};function Ns(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Yo{constructor(e){this.find=e.find,this.handler=e.handler}}const Am=(n,e)=>{if(Ns(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Ii(n){var e;const{editor:t,from:r,to:o,text:i,rules:s,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let u=!1;const d=Pm(c)+i;return s.forEach(p=>{if(u)return;const h=Am(d,p.find);if(!h)return;const f=l.state.tr,m=Vo({state:l.state,transaction:f}),g={from:r-(h[0].length-i.length),to:o},{commands:y,chain:b,can:v}=new Go({editor:t,state:m});p.handler({state:m,range:g,match:h,commands:y,chain:b,can:v})===null||!f.steps.length||(f.setMeta(a,{transform:f,from:r,to:o,text:i}),l.dispatch(f),u=!0)}),u}function Om(n){const{editor:e,rules:t}=n,r=new Ne({state:{init(){return null},apply(o,i){const s=o.getMeta(r);return s||(o.selectionSet||o.docChanged?null:i)}},props:{handleTextInput(o,i,s,a){return Ii({editor:e,from:i,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{const{$cursor:i}=o.state.selection;i&&Ii({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(o,i){if(i.key!=="Enter")return!1;const{$cursor:s}=o.state.selection;return s?Ii({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function Im(n){return typeof n=="number"}class $m{constructor(e){this.find=e.find,this.handler=e.handler}}const Nm=(n,e)=>{if(Ns(e))return[...n.matchAll(e)];const t=e(n);return t?t.map(r=>{const o=[r.text];return o.index=r.index,o.input=n,o.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(r.replaceWith)),o}):[]};function Lm(n){const{editor:e,state:t,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=n,{commands:l,chain:c,can:u}=new Go({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,o,(h,f)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(r,f),g=Math.min(o,f+h.content.size),y=h.textBetween(m-f,g-f,void 0,"￼");Nm(y,i.find).forEach(v=>{if(v.index===void 0)return;const k=m+v.index+1,x=k+v[0].length,C={from:t.tr.mapping.map(k),to:t.tr.mapping.map(x)},A=i.handler({state:t,range:C,match:v,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(A)})}),d.every(h=>h!==null)}function Rm(n){const{editor:e,rules:t}=n;let r=null,o=!1,i=!1,s=new ClipboardEvent("paste"),a=new DragEvent("drop");return t.map(c=>new Ne({view(u){const d=p=>{var h;r=!((h=u.dom.parentElement)===null||h===void 0)&&h.contains(p.target)?u.dom.parentElement:null};return window.addEventListener("dragstart",d),{destroy(){window.removeEventListener("dragstart",d)}}},props:{handleDOMEvents:{drop:(u,d)=>(i=r===u.dom.parentElement,a=d,!1),paste:(u,d)=>{var p;const h=(p=d.clipboardData)===null||p===void 0?void 0:p.getData("text/html");return s=d,o=!!(h!=null&&h.includes("data-pm-slice")),!1}}},appendTransaction:(u,d,p)=>{const h=u[0],f=h.getMeta("uiEvent")==="paste"&&!o,m=h.getMeta("uiEvent")==="drop"&&!i;if(!f&&!m)return;const g=d.doc.content.findDiffStart(p.doc.content),y=d.doc.content.findDiffEnd(p.doc.content);if(!Im(g)||!y||g===y.b)return;const b=p.tr,v=Vo({state:p,transaction:b});if(!(!Lm({editor:e,state:v,from:Math.max(g-1,0),to:y.b-1,rule:c,pasteEvent:s,dropEvent:a})||!b.steps.length))return a=new DragEvent("drop"),s=new ClipboardEvent("paste"),b}}))}function Bm(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class Ln{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Ln.resolve(e),this.schema=Fm(this.extensions,t),this.extensions.forEach(r=>{var o;this.editor.extensionStorage[r.name]=r.storage;const i={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:Oi(r.name,this.schema)};r.type==="mark"&&(!((o=B(F(r,"keepOnSplit",i)))!==null&&o!==void 0)||o)&&this.splittableMarks.push(r.name);const s=F(r,"onBeforeCreate",i);s&&this.editor.on("beforeCreate",s);const a=F(r,"onCreate",i);a&&this.editor.on("create",a);const l=F(r,"onUpdate",i);l&&this.editor.on("update",l);const c=F(r,"onSelectionUpdate",i);c&&this.editor.on("selectionUpdate",c);const u=F(r,"onTransaction",i);u&&this.editor.on("transaction",u);const d=F(r,"onFocus",i);d&&this.editor.on("focus",d);const p=F(r,"onBlur",i);p&&this.editor.on("blur",p);const h=F(r,"onDestroy",i);h&&this.editor.on("destroy",h)})}static resolve(e){const t=Ln.sort(Ln.flatten(e)),r=Bm(t.map(o=>o.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(o=>`'${o}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},o=F(t,"addExtensions",r);return o?[t,...this.flatten(o())]:t}).flat(10)}static sort(e){return e.sort((r,o)=>{const i=F(r,"priority")||100,s=F(o,"priority")||100;return i>s?-1:i<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Oi(t.name,this.schema)},o=F(t,"addCommands",r);return o?{...e,...o()}:e},{})}get plugins(){const{editor:e}=this,t=Ln.sort([...this.extensions].reverse()),r=[],o=[],i=t.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:Oi(s.name,this.schema)},l=[],c=F(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&s.config.exitable&&(u.ArrowRight=()=>Je.handleExit({editor:e,mark:s})),c){const m=Object.fromEntries(Object.entries(c()).map(([g,y])=>[g,()=>y({editor:e})]));u={...u,...m}}const d=em(u);l.push(d);const p=F(s,"addInputRules",a);ll(s,e.options.enableInputRules)&&p&&r.push(...p());const h=F(s,"addPasteRules",a);ll(s,e.options.enablePasteRules)&&h&&o.push(...h());const f=F(s,"addProseMirrorPlugins",a);if(f){const m=f();l.push(...m)}return l}).flat();return[Om({editor:e,rules:r}),...Rm({editor:e,rules:o}),...i]}get attributes(){return Fu(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Wo(this.extensions);return Object.fromEntries(t.filter(r=>!!F(r,"addNodeView")).map(r=>{const o=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:ce(r.name,this.schema)},s=F(r,"addNodeView",i);if(!s)return[];const a=(l,c,u,d)=>{const p=cs(l,o);return s()({editor:e,node:l,getPos:u,decorations:d,HTMLAttributes:p,extension:r})};return[r.name,a]}))}}function _m(n){return Object.prototype.toString.call(n).slice(8,-1)}function $i(n){return _m(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Ko(n,e){const t={...n};return $i(n)&&$i(e)&&Object.keys(e).forEach(r=>{$i(e[r])?r in n?t[r]=Ko(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class Ee{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=B(F(this,"addOptions",{name:this.name}))),this.storage=B(F(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ee(e)}configure(e={}){const t=this.extend();return t.options=Ko(this.options,e),t.storage=B(F(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Ee(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=B(F(t,"addOptions",{name:t.name})),t.storage=B(F(t,"addStorage",{name:t.name,options:t.options})),t}}function Au(n,e,t){const{from:r,to:o}=e,{blockSeparator:i=`

`,textSerializers:s={}}=t||{};let a="",l=!0;return n.nodesBetween(r,o,(c,u,d,p)=>{var h;const f=s==null?void 0:s[c.type.name];f?(c.isBlock&&!l&&(a+=i,l=!0),d&&(a+=f({node:c,pos:u,parent:d,index:p,range:e}))):c.isText?(a+=(h=c==null?void 0:c.text)===null||h===void 0?void 0:h.slice(Math.max(r,u)-u,o-u),l=!1):c.isBlock&&!l&&(a+=i,l=!0)}),a}function Ou(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const zm=Ee.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Ne({key:new et("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:o}=e,{ranges:i}=o,s=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=Ou(t);return Au(r,{from:s,to:a},{textSerializers:l})}}})]}}),Hm=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),jm=(n=!1)=>({commands:e})=>e.setContent("",n),Um=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:o}=r;return t&&o.forEach(({$from:i,$to:s})=>{n.doc.nodesBetween(i.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),h=d.blockRange(p);if(!h)return;const f=or(h);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(f||f===0)&&e.lift(h,f)})}),!0},Vm=n=>e=>n(e),Gm=()=>({state:n,dispatch:e})=>hm(n,e),Wm=(n,e)=>({editor:t,tr:r})=>{const{state:o}=t,i=o.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,i.content),r.setSelection(new R(r.doc.resolve(s-1))),!0},Ym=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const o=n.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===r.type){if(e){const a=o.before(i),l=o.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},Km=n=>({tr:e,state:t,dispatch:r})=>{const o=ce(n,t.schema),i=e.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===o){if(r){const l=i.before(s),c=i.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},qm=n=>({tr:e,dispatch:t})=>{const{from:r,to:o}=n;return t&&e.delete(r,o),!0},Jm=()=>({state:n,dispatch:e})=>tm(n,e),Zm=()=>({commands:n})=>n.keyboardShortcut("Enter"),Xm=()=>({state:n,dispatch:e})=>pm(n,e);function Co(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(o=>t.strict?e[o]===n[o]:Ns(e[o])?e[o].test(n[o]):e[o]===n[o]):!0}function us(n,e,t={}){return n.find(r=>r.type===e&&Co(r.attrs,t))}function Qm(n,e,t={}){return!!us(n,e,t)}function Ls(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const o=us([...r.node.marks],e,t);if(!o)return;let i=r.index,s=n.start()+r.offset,a=i+1,l=s+r.node.nodeSize;for(us([...r.node.marks],e,t);i>0&&o.isInSet(n.parent.child(i-1).marks);)i-=1,s-=n.parent.child(i).nodeSize;for(;a<n.parent.childCount&&Qm([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function qt(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const eg=(n,e={})=>({tr:t,state:r,dispatch:o})=>{const i=qt(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:c,to:u}=a;if(o){const d=Ls(l,i,e);if(d&&d.from<=c&&d.to>=u){const p=R.create(s,d.from,d.to);t.setSelection(p)}}return!0},tg=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Iu(n){return n instanceof R}function sn(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function $u(n,e=null){if(!e)return null;const t=_.atStart(n),r=_.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const o=t.from,i=r.to;return e==="all"?R.create(n,sn(0,o,i),sn(n.content.size,o,i)):R.create(n,sn(e,o,i),sn(e,o,i))}function Rs(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const ng=(n=null,e={})=>({editor:t,view:r,tr:o,dispatch:i})=>{e={scrollIntoView:!0,...e};const s=()=>{Rs()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!Iu(t.state.selection))return s(),!0;const a=$u(o.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},rg=(n,e)=>t=>n.every((r,o)=>e(r,{...t,index:o})),og=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e);function cl(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function ko(n,e,t){if(t={slice:!0,parseOptions:{},...t},typeof n=="object"&&n!==null)try{return Array.isArray(n)&&n.length>0?D.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),ko("",e,t)}if(typeof n=="string"){const r=Gn.fromSchema(e);return t.slice?r.parseSlice(cl(n),t.parseOptions).content:r.parse(cl(n),t.parseOptions)}return ko("",e,t)}function ig(n,e,t){const r=n.steps.length-1;if(r<e)return;const o=n.steps[r];if(!(o instanceof ge||o instanceof ae))return;const i=n.mapping.maps[r];let s=0;i.forEach((a,l,c,u)=>{s===0&&(s=u)}),n.setSelection(_.near(n.doc.resolve(s),t))}const sg=n=>n.toString().startsWith("<"),ag=(n,e,t)=>({tr:r,dispatch:o,editor:i})=>{if(o){t={parseOptions:{},updateSelection:!0,...t};const s=ko(e,i.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(s.toString()==="<>")return!0;let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},c=!0,u=!0;if((sg(s)?s:[s]).forEach(p=>{p.check(),c=c?p.isText&&p.marks.length===0:!1,u=u?p.isBlock:!1}),a===l&&u){const{parent:p}=r.doc.resolve(a);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(a-=1,l+=1)}c?Array.isArray(e)?r.insertText(e.map(p=>p.text||"").join(""),a,l):typeof e=="object"&&e&&e.text?r.insertText(e.text,a,l):r.insertText(e,a,l):r.replaceWith(a,l,s),t.updateSelection&&ig(r,r.steps.length-1,-1)}return!0},lg=()=>({state:n,dispatch:e})=>lm(n,e),cg=()=>({state:n,dispatch:e})=>cm(n,e),ug=()=>({state:n,dispatch:e})=>rm(n,e),dg=()=>({state:n,dispatch:e})=>sm(n,e),pg=()=>({tr:n,state:e,dispatch:t})=>{try{const r=_o(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},hg=()=>({state:n,dispatch:e,tr:t})=>{try{const r=_o(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}};function Bs(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function fg(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,o,i,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Rs()||Bs()?s=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),o&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const mg=n=>({editor:e,view:t,tr:r,dispatch:o})=>{const i=fg(n).split(/-(?!$)/),s=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&o&&r.maybeStep(u)}),!0};function Ar(n,e,t={}){const{from:r,to:o,empty:i}=n.selection,s=e?ce(e,n.schema):null,a=[];n.doc.nodesBetween(r,o,(d,p)=>{if(d.isText)return;const h=Math.max(r,p),f=Math.min(o,p+d.nodeSize);a.push({node:d,from:h,to:f})});const l=o-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>Co(d.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((d,p)=>d+p.to-p.from,0)>=l}const gg=(n,e={})=>({state:t,dispatch:r})=>{const o=ce(n,t.schema);return Ar(t,o,e)?um(t,r):!1},yg=()=>({state:n,dispatch:e})=>fm(n,e),bg=n=>({state:e,dispatch:t})=>{const r=ce(n,e.schema);return xm(r)(e,t)},vg=()=>({state:n,dispatch:e})=>dm(n,e);function qo(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function ul(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,o)=>(t.includes(o)||(r[o]=n[o]),r),{})}const Dg=(n,e)=>({tr:t,state:r,dispatch:o})=>{let i=null,s=null;const a=qo(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=ce(n,r.schema)),a==="mark"&&(s=qt(n,r.schema)),o&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,ul(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&t.addMark(u,u+c.nodeSize,s.create(ul(d.attrs,e)))})})}),!0):!1},wg=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),xg=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),Cg=()=>({state:n,dispatch:e})=>om(n,e),kg=()=>({state:n,dispatch:e})=>am(n,e),Eg=()=>({state:n,dispatch:e})=>mm(n,e),Mg=()=>({state:n,dispatch:e})=>bm(n,e),Tg=()=>({state:n,dispatch:e})=>ym(n,e);function Nu(n,e,t={}){return ko(n,e,{slice:!1,parseOptions:t})}const Sg=(n,e=!1,t={})=>({tr:r,editor:o,dispatch:i})=>{const{doc:s}=r,a=Nu(n,o.schema,t);return i&&r.replaceWith(0,s.content.size,a).setMeta("preventUpdate",!e),!0};function Jo(n,e){const t=qt(e,n.schema),{from:r,to:o,empty:i}=n.selection,s=[];i?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,o,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function Fg(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Pg(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function _s(n){return e=>Pg(e.$from,n)}function Ag(n,e){const t=ut.fromSchema(e).serializeFragment(n),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(t),o.innerHTML}function Og(n,e){const t={from:0,to:n.content.size};return Au(n,t,e)}function Ig(n,e){const t=ce(e,n.schema),{from:r,to:o}=n.selection,i=[];n.doc.nodesBetween(r,o,a=>{i.push(a)});const s=i.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function $g(n,e){const t=qo(typeof e=="string"?e:e.name,n.schema);return t==="node"?Ig(n,e):t==="mark"?Jo(n,e):{}}function Lu(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(o=>{const i=t.resolve(n-1),s=Ls(i,o.type);s&&r.push({mark:o,...s})}):t.nodesBetween(n,e,(o,i)=>{r.push(...o.marks.map(s=>({from:i,to:i+o.nodeSize,mark:s})))}),r}function oo(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const o=n.find(i=>i.type===e&&i.name===r);return o?o.attribute.keepOnSplit:!1}))}function ds(n,e,t={}){const{empty:r,ranges:o}=n.selection,i=e?qt(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>Co(d.attrs,t,{strict:!1}));let s=0;const a=[];if(o.forEach(({$from:d,$to:p})=>{const h=d.pos,f=p.pos;n.doc.nodesBetween(h,f,(m,g)=>{if(!m.isText&&!m.marks.length)return;const y=Math.max(h,g),b=Math.min(f,g+m.nodeSize),v=b-y;s+=v,a.push(...m.marks.map(k=>({mark:k,from:y,to:b})))})}),s===0)return!1;const l=a.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>Co(d.mark.attrs,t,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),c=a.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+c:l)>=s}function Ng(n,e,t={}){if(!e)return Ar(n,null,t)||ds(n,null,t);const r=qo(e,n.schema);return r==="node"?Ar(n,e,t):r==="mark"?ds(n,e,t):!1}function dl(n,e){const{nodeExtensions:t}=Wo(e),r=t.find(s=>s.name===n);if(!r)return!1;const o={name:r.name,options:r.options,storage:r.storage},i=B(F(r,"group",o));return typeof i!="string"?!1:i.split(" ").includes("list")}function Lg(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function Rg(n,e,t){var r;const{selection:o}=e;let i=null;if(Iu(o)&&(i=o.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:s}=o;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,p)=>{if(c)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(t),f=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=h&&f}return!c}),c})}const Bg=(n,e={})=>({tr:t,state:r,dispatch:o})=>{const{selection:i}=t,{empty:s,ranges:a}=i,l=qt(n,r.schema);if(o)if(s){const c=Jo(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(p,h)=>{const f=Math.max(h,u),m=Math.min(h+p.nodeSize,d);p.marks.find(y=>y.type===l)?p.marks.forEach(y=>{l===y.type&&t.addMark(f,m,l.create({...y.attrs,...e}))}):t.addMark(f,m,l.create(e))})});return Rg(r,t,l)},_g=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),zg=(n,e={})=>({state:t,dispatch:r,chain:o})=>{const i=ce(n,t.schema);return i.isTextblock?o().command(({commands:s})=>il(i,e)(t)?!0:s.clearNodes()).command(({state:s})=>il(i,e)(s,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Hg=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,o=sn(n,0,r.content.size),i=N.create(r,o);e.setSelection(i)}return!0},jg=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:o,to:i}=typeof n=="number"?{from:n,to:n}:n,s=R.atStart(r).from,a=R.atEnd(r).to,l=sn(o,s,a),c=sn(i,s,a),u=R.create(r,l,c);e.setSelection(u)}return!0},Ug=n=>({state:e,dispatch:t})=>{const r=ce(n,e.schema);return Em(r)(e,t)};function pl(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(o=>e==null?void 0:e.includes(o.type.name));n.tr.ensureMarks(r)}}const Vg=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:o})=>{const{selection:i,doc:s}=e,{$from:a,$to:l}=i,c=o.extensionManager.attributes,u=oo(c,a.node().type.name,a.node().attrs);if(i instanceof N&&i.node.isBlock)return!a.parentOffset||!_n(s,a.pos)?!1:(r&&(n&&pl(t,o.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;i instanceof R&&e.deleteSelection();const p=a.depth===0?void 0:Fg(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&p?[{type:p,attrs:u}]:void 0,f=_n(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!f&&_n(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(f=!0,h=p?[{type:p,attrs:u}]:void 0),f&&(e.split(e.mapping.map(a.pos),1,h),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const m=e.mapping.map(a.before()),g=e.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}n&&pl(t,o.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Gg=n=>({tr:e,state:t,dispatch:r,editor:o})=>{var i;const s=ce(n,t.schema),{$from:a,$to:l}=t.selection,c=t.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==s)return!1;const d=o.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let g=D.empty;const y=a.index(-1)?1:a.index(-2)?2:3;for(let A=a.depth-y;A>=a.depth-3;A-=1)g=D.from(a.node(A).copy(g));const b=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,v=oo(d,a.node().type.name,a.node().attrs),k=((i=s.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(v))||void 0;g=g.append(D.from(s.createAndFill(null,k)||void 0));const x=a.before(a.depth-(y-1));e.replace(x,a.after(-b),new T(g,4-y,0));let C=-1;e.doc.nodesBetween(x,e.doc.content.size,(A,$)=>{if(C>-1)return!1;A.isTextblock&&A.content.size===0&&(C=$+1)}),C>-1&&e.setSelection(R.near(e.doc.resolve(C))),e.scrollIntoView()}return!0}const p=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,h=oo(d,u.type.name,u.attrs),f=oo(d,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const m=p?[{type:s,attrs:h},{type:p,attrs:f}]:[{type:s,attrs:h}];if(!_n(e.doc,a.pos,2))return!1;if(r){const{selection:g,storedMarks:y}=t,{splittableMarks:b}=o.extensionManager,v=y||g.$to.parentOffset&&g.$from.marks();if(e.split(a.pos,2,m).scrollIntoView(),!v||!r)return!0;const k=v.filter(x=>b.includes(x.type.name));e.ensureMarks(k)}return!0},Ni=(n,e)=>{const t=_s(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const o=n.doc.nodeAt(r);return t.node.type===(o==null?void 0:o.type)&&Yt(n.doc,t.pos)&&n.join(t.pos),!0},Li=(n,e)=>{const t=_s(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const o=n.doc.nodeAt(r);return t.node.type===(o==null?void 0:o.type)&&Yt(n.doc,r)&&n.join(r),!0},Wg=(n,e,t,r={})=>({editor:o,tr:i,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=o.extensionManager,h=ce(n,s.schema),f=ce(e,s.schema),{selection:m,storedMarks:g}=s,{$from:y,$to:b}=m,v=y.blockRange(b),k=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;const x=_s(C=>dl(C.type.name,d))(m);if(v.depth>=1&&x&&v.depth-x.depth<=1){if(x.node.type===h)return c.liftListItem(f);if(dl(x.node.type.name,d)&&h.validContent(x.node.content)&&a)return l().command(()=>(i.setNodeMarkup(x.pos,h),!0)).command(()=>Ni(i,h)).command(()=>Li(i,h)).run()}return!t||!k||!a?l().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>Ni(i,h)).command(()=>Li(i,h)).run():l().command(()=>{const C=u().wrapInList(h,r),A=k.filter($=>p.includes($.type.name));return i.ensureMarks(A),C?!0:c.clearNodes()}).wrapInList(h,r).command(()=>Ni(i,h)).command(()=>Li(i,h)).run()},Yg=(n,e={},t={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:i=!1}=t,s=qt(n,r.schema);return ds(r,s,e)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,e)},Kg=(n,e,t={})=>({state:r,commands:o})=>{const i=ce(n,r.schema),s=ce(e,r.schema);return Ar(r,i,t)?o.setNode(s):o.setNode(i,t)},qg=(n,e={})=>({state:t,commands:r})=>{const o=ce(n,t.schema);return Ar(t,o,e)?r.lift(o):r.wrapIn(o,e)},Jg=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const o=t[r];let i;if(o.spec.isInputRules&&(i=o.getState(n))){if(e){const s=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else s.delete(i.from,i.to)}return!0}}return!1},Zg=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:o}=t;return r||e&&o.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},Xg=(n,e={})=>({tr:t,state:r,dispatch:o})=>{var i;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=qt(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!o)return!0;if(u&&s){let{from:p,to:h}=a;const f=(i=c.marks().find(g=>g.type===l))===null||i===void 0?void 0:i.attrs,m=Ls(c,l,f);m&&(p=m.from,h=m.to),t.removeMark(p,h,l)}else d.forEach(p=>{t.removeMark(p.$from.pos,p.$to.pos,l)});return t.removeStoredMark(l),!0},Qg=(n,e={})=>({tr:t,state:r,dispatch:o})=>{let i=null,s=null;const a=qo(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=ce(n,r.schema)),a==="mark"&&(s=qt(n,r.schema)),o&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(d,p)=>{i&&i===d.type&&t.setNodeMarkup(p,void 0,{...d.attrs,...e}),s&&d.marks.length&&d.marks.forEach(h=>{if(s===h.type){const f=Math.max(p,c),m=Math.min(p+d.nodeSize,u);t.addMark(f,m,s.create({...h.attrs,...e}))}})})}),!0):!1},e0=(n,e={})=>({state:t,dispatch:r})=>{const o=ce(n,t.schema);return vm(o,e)(t,r)},t0=(n,e={})=>({state:t,dispatch:r})=>{const o=ce(n,t.schema);return Dm(o,e)(t,r)};var n0=Object.freeze({__proto__:null,blur:Hm,clearContent:jm,clearNodes:Um,command:Vm,createParagraphNear:Gm,cut:Wm,deleteCurrentNode:Ym,deleteNode:Km,deleteRange:qm,deleteSelection:Jm,enter:Zm,exitCode:Xm,extendMarkRange:eg,first:tg,focus:ng,forEach:rg,insertContent:og,insertContentAt:ag,joinUp:lg,joinDown:cg,joinBackward:ug,joinForward:dg,joinItemBackward:pg,joinItemForward:hg,keyboardShortcut:mg,lift:gg,liftEmptyBlock:yg,liftListItem:bg,newlineInCode:vg,resetAttributes:Dg,scrollIntoView:wg,selectAll:xg,selectNodeBackward:Cg,selectNodeForward:kg,selectParentNode:Eg,selectTextblockEnd:Mg,selectTextblockStart:Tg,setContent:Sg,setMark:Bg,setMeta:_g,setNode:zg,setNodeSelection:Hg,setTextSelection:jg,sinkListItem:Ug,splitBlock:Vg,splitListItem:Gg,toggleList:Wg,toggleMark:Yg,toggleNode:Kg,toggleWrap:qg,undoInputRule:Jg,unsetAllMarks:Zg,unsetMark:Xg,updateAttributes:Qg,wrapIn:e0,wrapInList:t0});const r0=Ee.create({name:"commands",addCommands(){return{...n0}}}),o0=Ee.create({name:"editable",addProseMirrorPlugins(){return[new Ne({key:new et("editable"),props:{editable:()=>this.editor.options.editable}})]}}),i0=Ee.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Ne({key:new et("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),s0=Ee.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:p,parent:h}=d,f=d.parent.isTextblock?a.doc.resolve(p-1):d,m=f.parent.type.spec.isolating,g=d.pos-d.parentOffset,y=m&&f.parent.childCount===1?g===d.pos:_.atStart(c).from===p;return!u||!y||!h.type.isTextblock||h.textContent.length?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},o={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Rs()||Bs()?i:o},addProseMirrorPlugins(){return[new Ne({key:new et("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(f=>f.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:o,from:i,to:s}=e.selection,a=_.atStart(e.doc).from,l=_.atEnd(e.doc).to;if(o||!(i===a&&s===l)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const d=t.tr,p=Vo({state:t,transaction:d}),{commands:h}=new Go({editor:this.editor,state:p});if(h.clearNodes(),!!d.steps.length)return d}})]}}),a0=Ee.create({name:"tabindex",addProseMirrorPlugins(){return[new Ne({key:new et("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var l0=Object.freeze({__proto__:null,ClipboardTextSerializer:zm,Commands:r0,Editable:o0,FocusEvents:i0,Keymap:s0,Tabindex:a0});const c0=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function u0(n,e,t){const r=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(r!==null)return r;const o=document.createElement("style");return e&&o.setAttribute("nonce",e),o.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),o.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(o),o}class d0 extends Mm{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=u0(c0,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Pu(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],o=this.state.reconfigure({plugins:r});this.view.updateState(o)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(o=>!o.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(l0):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new Ln(t,this)}createCommandManager(){this.commandManager=new Go({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=Nu(this.options.content,this.schema,this.options.parseOptions),t=$u(e,this.options.autofocus);this.view=new Gf(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Nn.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const o=e.getMeta("focus"),i=e.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return $g(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,o=typeof e=="string"?t:e;return Ng(this.state,r,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ag(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Og(this.state.doc,{blockSeparator:t,textSerializers:{...Ou(this.schema),...r}})}get isEmpty(){return Lg(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}}function Ut(n){return new Yo({find:n.find,handler:({state:e,range:t,match:r})=>{const o=B(n.getAttributes,void 0,r);if(o===!1||o===null)return null;const{tr:i}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=t.from+a.indexOf(s),u=c+s.length;if(Lu(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===n.type&&m!==h.mark.type)).filter(h=>h.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const p=t.from+l+s.length;i.addMark(t.from+l,p,n.type.create(o||{})),i.removeStoredMark(n.type)}}})}function p0(n){return new Yo({find:n.find,handler:({state:e,range:t,match:r})=>{const o=B(n.getAttributes,void 0,r)||{},{tr:i}=e,s=t.from;let a=t.to;const l=n.type.create(o);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];i.insertText(d,s+r[0].length-1),i.replaceWith(u,a,l)}else r[0]&&i.insert(s-1,n.type.create(o)).delete(i.mapping.map(s),i.mapping.map(a));i.scrollIntoView()}})}function ps(n){return new Yo({find:n.find,handler:({state:e,range:t,match:r})=>{const o=e.doc.resolve(t.from),i=B(n.getAttributes,void 0,r)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function Or(n){return new Yo({find:n.find,handler:({state:e,range:t,match:r,chain:o})=>{const i=B(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),c=l&&Cs(l,n.type,i);if(!c)return null;if(s.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:p}=e,{splittableMarks:h}=n.editor.extensionManager,f=p||d.$to.parentOffset&&d.$from.marks();if(f){const m=f.filter(g=>h.includes(g.type.name));s.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";o().updateAttributes(d,i).run()}const u=s.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Yt(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&s.join(t.from-1)}})}class Je{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=B(F(this,"addOptions",{name:this.name}))),this.storage=B(F(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Je(e)}configure(e={}){const t=this.extend();return t.options=Ko(this.options,e),t.storage=B(F(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Je(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=B(F(t,"addOptions",{name:t.name})),t.storage=B(F(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,o=e.state.selection.$from;if(o.pos===o.end()){const s=o.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",o.pos),e.view.dispatch(r),!0}return!1}}let _e=class hs{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=B(F(this,"addOptions",{name:this.name}))),this.storage=B(F(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new hs(e)}configure(e={}){const t=this.extend();return t.options=Ko(this.options,e),t.storage=B(F(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new hs(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=B(F(t,"addOptions",{name:t.name})),t.storage=B(F(t,"addStorage",{name:t.name,options:t.options})),t}};function Vt(n){return new $m({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:o})=>{const i=B(n.getAttributes,void 0,r,o);if(i===!1||i===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),d=t.from+l.indexOf(a),p=d+a.length;if(Lu(t.from,t.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===n.type&&g!==f.mark.type)).filter(f=>f.to>d).length)return null;p<t.to&&s.delete(p,t.to),d>t.from&&s.delete(t.from+u,d),c=t.from+u+a.length,s.addMark(t.from+u,c,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}const Ru=_e.create({name:"text",group:"inline"}),Bu=_e.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),h0=/^\s*>\s$/,f0=_e.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Or({find:h0,type:this.type})]}}),m0=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,g0=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,y0=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,b0=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,v0=Je.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ut({find:m0,type:this.type}),Ut({find:y0,type:this.type})]},addPasteRules(){return[Vt({find:g0,type:this.type}),Vt({find:b0,type:this.type})]}}),D0=_e.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",X(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),hl=Je.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",X(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Jo(n,this.type);return Object.entries(t).some(([,o])=>!!o)?!0:e.unsetMark(this.name)}}}}),fl=/^\s*([-+*])\s$/,w0=_e.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",X(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(D0.name,this.editor.getAttributes(hl.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Or({find:fl,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Or({find:fl,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(hl.name),editor:this.editor})),[n]}}),x0=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,C0=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,k0=Je.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ut({find:x0,type:this.type})]},addPasteRules(){return[Vt({find:C0,type:this.type})]}}),E0=/^```([a-z]+)?[\s\n]$/,M0=/^~~~([a-z]+)?[\s\n]$/,T0=_e.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",X(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:o}=t;if(!o||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!i||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:o,empty:i}=t;if(!i||o.parent.type!==this.type||!(o.parentOffset===o.parent.nodeSize-2))return!1;const a=o.after();return a===void 0||r.nodeAt(a)?!1:n.commands.exitCode()}}},addInputRules(){return[ps({find:E0,type:this.type,getAttributes:n=>({language:n[1]})}),ps({find:M0,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Ne({key:new et("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=o==null?void 0:o.mode;if(!t||!i)return!1;const{tr:s}=n.state;return s.replaceSelectionWith(this.type.create({language:i})),s.setSelection(R.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(t.replace(/\r\n?/g,`
`)),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),S0=_e.create({name:"doc",topNode:!0,content:"block+"});function F0(n={}){return new Ne({view(e){return new P0(e,n)}})}class P0{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let i=s=>{this[o](s)};return e.dom.addEventListener(o,i),{name:o,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=a?u.bottom:u.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let o=this.editorView.dom.offsetParent;this.element||(this.element=o.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let i,s;if(!o||o==document.body&&getComputedStyle(o).position=="static")i=-pageXOffset,s=-pageYOffset;else{let a=o.getBoundingClientRect();i=a.left-o.scrollLeft,s=a.top-o.scrollTop}this.element.style.left=r.left-i+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),o=r&&r.type.spec.disableDropCursor,i=typeof o=="function"?o(this.editorView,t,e):o;if(t&&!i){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=_c(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const A0=Ee.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[F0(this.options)]}});class Z extends _{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Z.valid(r)?new Z(r):_.near(r)}content(){return T.empty}eq(e){return e instanceof Z&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Z(e.resolve(t.pos))}getBookmark(){return new zs(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!O0(e)||!I0(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let o=t.contentMatchAt(e.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Z.valid(e))return e;let o=e.pos,i=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){i=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;o+=t;let l=e.doc.resolve(o);if(Z.valid(l))return l}for(;;){let s=t>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!N.isSelectable(i)){e=e.doc.resolve(o+i.nodeSize*t),r=!1;continue e}break}i=s,o+=t;let a=e.doc.resolve(o);if(Z.valid(a))return a}return null}}}Z.prototype.visible=!1;Z.findFrom=Z.findGapCursorFrom;_.jsonID("gapcursor",Z);class zs{constructor(e){this.pos=e}map(e){return new zs(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Z.valid(t)?new Z(t):_.near(t)}}function O0(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let o=r.child(t-1);;o=o.lastChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}function I0(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let o=r.child(t);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}function $0(){return new Ne({props:{decorations:B0,createSelectionBetween(n,e,t){return e.pos==t.pos&&Z.valid(t)?new Z(t):null},handleClick:L0,handleKeyDown:N0,handleDOMEvents:{beforeinput:R0}}})}const N0=Cu({ArrowLeft:Xr("horiz",-1),ArrowRight:Xr("horiz",1),ArrowUp:Xr("vert",-1),ArrowDown:Xr("vert",1)});function Xr(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,o,i){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof R){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Z.findGapCursorFrom(a,e,l);return c?(o&&o(r.tr.setSelection(new Z(c))),!0):!1}}function L0(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Z.valid(r))return!1;let o=n.posAtCoords({left:t.clientX,top:t.clientY});return o&&o.inside>-1&&N.isSelectable(n.state.doc.nodeAt(o.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Z(r))),!0)}function R0(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Z))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let o=D.empty;for(let s=r.length-1;s>=0;s--)o=D.from(r[s].createAndFill(null,o));let i=n.state.tr.replace(t.pos,t.pos,new T(o,0,0));return i.setSelection(R.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function B0(n){if(!(n.selection instanceof Z))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",te.create(n.doc,[Ge.widget(n.selection.head,e,{key:"gapcursor"})])}const _0=Ee.create({name:"gapCursor",addProseMirrorPlugins(){return[$0()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=B(F(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),z0=_e.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",X(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:o,storedMarks:i}=t;if(o.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=i||o.$to.parentOffset&&o.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(p=>a.includes(p.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),H0=_e.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,X(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>ps({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Eo=200,le=function(){};le.prototype.append=function(e){return e.length?(e=le.from(e),!this.length&&e||e.length<Eo&&this.leafAppend(e)||this.length<Eo&&e.leafPrepend(this)||this.appendInner(e)):this};le.prototype.prepend=function(e){return e.length?le.from(e).append(this):this};le.prototype.appendInner=function(e){return new j0(this,e)};le.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?le.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};le.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};le.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};le.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var o=[];return this.forEach(function(i,s){return o.push(e(i,s))},t,r),o};le.from=function(e){return e instanceof le?e:e&&e.length?new _u(e):le.empty};var _u=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(o,i){return o==0&&i==this.length?this:new e(this.values.slice(o,i))},e.prototype.getInner=function(o){return this.values[o]},e.prototype.forEachInner=function(o,i,s,a){for(var l=i;l<s;l++)if(o(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(o,i,s,a){for(var l=i-1;l>=s;l--)if(o(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(o){if(this.length+o.length<=Eo)return new e(this.values.concat(o.flatten()))},e.prototype.leafPrepend=function(o){if(this.length+o.length<=Eo)return new e(o.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(le);le.empty=new _u([]);var j0=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,o,i,s){var a=this.left.length;if(o<a&&this.left.forEachInner(r,o,Math.min(i,a),s)===!1||i>a&&this.right.forEachInner(r,Math.max(o-a,0),Math.min(this.length,i)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,o,i,s){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(r,o-a,Math.max(i,a)-a,s+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(o,a),i,s)===!1)return!1},e.prototype.sliceInner=function(r,o){if(r==0&&o==this.length)return this;var i=this.left.length;return o<=i?this.left.slice(r,o):r>=i?this.right.slice(r-i,o-i):this.left.slice(r,i).append(this.right.slice(0,o-i))},e.prototype.leafAppend=function(r){var o=this.right.leafAppend(r);if(o)return new e(this.left,o)},e.prototype.leafPrepend=function(r){var o=this.left.leafPrepend(r);if(o)return new e(o,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(le);const U0=500;class ot{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let o,i;t&&(o=this.remapping(r,this.items.length),i=o.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,p)=>{if(!d.step){o||(o=this.remapping(r,p+1),i=o.maps.length),i--,u.push(d);return}if(o){u.push(new at(d.map));let h=d.step.map(o.slice(i)),f;h&&s.maybeStep(h).doc&&(f=s.mapping.maps[s.mapping.maps.length-1],c.push(new at(f,void 0,void 0,c.length+u.length))),i--,f&&o.appendMap(f,i)}else s.maybeStep(d.step);if(d.selection)return a=o?d.selection.map(o.slice(i)):d.selection,l=new ot(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,t,r,o){let i=[],s=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),p=new at(e.mapping.maps[u],d,t),h;(h=l&&l.merge(p))&&(p=h,u?i.pop():a=a.slice(0,a.length-1)),i.push(p),t&&(s++,t=void 0),o||(l=p)}let c=s-r.depth;return c>G0&&(a=V0(a,c),s-=c),new ot(a.append(i),s)}remapping(e,t){let r=new Bn;return this.items.forEach((o,i)=>{let s=o.mirrorOffset!=null&&i-o.mirrorOffset>=e?r.maps.length-o.mirrorOffset:void 0;r.appendMap(o.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new ot(this.items.append(e.map(t=>new at(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],o=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(p=>{p.selection&&a--},o);let l=t;this.items.forEach(p=>{let h=i.getMirror(--l);if(h==null)return;s=Math.min(s,h);let f=i.maps[h];if(p.step){let m=e.steps[h].invert(e.docs[h]),g=p.selection&&p.selection.map(i.slice(l+1,h));g&&a++,r.push(new at(f,m,g))}else r.push(new at(f))},o);let c=[];for(let p=t;p<s;p++)c.push(new at(i.maps[p]));let u=this.items.slice(0,o).append(c).append(r),d=new ot(u,a);return d.emptyItemCount()>U0&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,o=[],i=0;return this.items.forEach((s,a)=>{if(a>=e)o.push(s),s.selection&&i++;else if(s.step){let l=s.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=s.selection&&s.selection.map(t.slice(r));u&&i++;let d=new at(c.invert(),l,u),p,h=o.length-1;(p=o.length&&o[h].merge(d))?o[h]=p:o.push(d)}}else s.map&&r--},this.items.length,0),new ot(le.from(o.reverse()),i)}}ot.empty=new ot(le.empty,0);function V0(n,e){let t;return n.forEach((r,o)=>{if(r.selection&&e--==0)return t=o,!1}),n.slice(t)}class at{constructor(e,t,r,o){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=o}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new at(t.getMap().invert(),t,this.selection)}}}class Ft{constructor(e,t,r,o,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=o,this.prevComposition=i}}const G0=20;function W0(n,e,t,r){let o=t.getMeta(zt),i;if(o)return o.historyState;t.getMeta(K0)&&(n=new Ft(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(zt))return s.getMeta(zt).redo?new Ft(n.done.addTransform(t,void 0,r,io(e)),n.undone,ml(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new Ft(n.done,n.undone.addTransform(t,void 0,r,io(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Y0(t,n.prevRanges)),c=s?Ri(n.prevRanges,t.mapping):ml(t.mapping.maps[t.steps.length-1]);return new Ft(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,io(e)),ot.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Ft(n.done.rebased(t,i),n.undone.rebased(t,i),Ri(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Ft(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Ri(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Y0(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,o)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&o>=e[i]&&(t=!0)}),t}function ml(n){let e=[];return n.forEach((t,r,o,i)=>e.push(o,i)),e}function Ri(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let o=e.map(n[r],1),i=e.map(n[r+1],-1);o<=i&&t.push(o,i)}return t}function zu(n,e,t,r){let o=io(e),i=zt.get(e).spec.config,s=(r?n.undone:n.done).popEvent(e,o);if(!s)return;let a=s.selection.resolve(s.transform.doc),l=(r?n.done:n.undone).addTransform(s.transform,e.selection.getBookmark(),i,o),c=new Ft(r?l:s.remaining,r?s.remaining:l,null,0,-1);t(s.transform.setSelection(a).setMeta(zt,{redo:r,historyState:c}).scrollIntoView())}let Bi=!1,gl=null;function io(n){let e=n.plugins;if(gl!=e){Bi=!1,gl=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Bi=!0;break}}return Bi}const zt=new et("history"),K0=new et("closeHistory");function q0(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Ne({key:zt,state:{init(){return new Ft(ot.empty,ot.empty,null,0,-1)},apply(e,t,r){return W0(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,o=r=="historyUndo"?Hu:r=="historyRedo"?ju:null;return o?(t.preventDefault(),o(e.state,e.dispatch)):!1}}}})}const Hu=(n,e)=>{let t=zt.getState(n);return!t||t.done.eventCount==0?!1:(e&&zu(t,n,e,!1),!0)},ju=(n,e)=>{let t=zt.getState(n);return!t||t.undone.eventCount==0?!1:(e&&zu(t,n,e,!0),!0)},J0=Ee.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>Hu(n,e),redo:()=>({state:n,dispatch:e})=>ju(n,e)}},addProseMirrorPlugins(){return[q0(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Z0=_e.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",X(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{$to:t}=e.selection,r=n();return t.parentOffset===0?r.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:o,dispatch:i})=>{var s;if(i){const{$to:a}=o.selection,l=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?o.setSelection(R.create(o.doc,a.pos+1)):a.nodeAfter.isBlock?o.setSelection(N.create(o.doc,a.pos)):o.setSelection(R.create(o.doc,a.pos));else{const c=(s=a.parent.type.contentMatch.defaultType)===null||s===void 0?void 0:s.create();c&&(o.insert(l,c),o.setSelection(R.create(o.doc,l+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[p0({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),X0=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Q0=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,e1=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,t1=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,n1=Je.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ut({find:X0,type:this.type}),Ut({find:e1,type:this.type})]},addPasteRules(){return[Vt({find:Q0,type:this.type}),Vt({find:t1,type:this.type})]}}),r1=_e.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",X(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),o1=_e.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",X(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),yl=Je.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",X(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Jo(n,this.type);return Object.entries(t).some(([,o])=>!!o)?!0:e.unsetMark(this.name)}}}}),bl=/^(\d+)\.\s$/,i1=_e.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",X(this.options.HTMLAttributes,t),0]:["ol",X(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(o1.name,this.editor.getAttributes(yl.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Or({find:bl,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Or({find:bl,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(yl.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),s1=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,a1=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,l1=Je.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){const n={};return Bs()?n["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():n["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),n},addInputRules(){return[Ut({find:s1,type:this.type})]},addPasteRules(){return[Vt({find:a1,type:this.type})]}}),c1=Ee.create({name:"starterKit",addExtensions(){var n,e,t,r,o,i,s,a,l,c,u,d,p,h,f,m,g,y;const b=[];return this.options.blockquote!==!1&&b.push(f0.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&b.push(v0.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&b.push(w0.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&b.push(k0.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&b.push(T0.configure((o=this.options)===null||o===void 0?void 0:o.codeBlock)),this.options.document!==!1&&b.push(S0.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&b.push(A0.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&b.push(_0.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&b.push(z0.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&b.push(H0.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&b.push(J0.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&b.push(Z0.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&b.push(n1.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&b.push(r1.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&b.push(i1.configure((f=this.options)===null||f===void 0?void 0:f.orderedList)),this.options.paragraph!==!1&&b.push(Bu.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&b.push(l1.configure((g=this.options)===null||g===void 0?void 0:g.strike)),this.options.text!==!1&&b.push(Ru.configure((y=this.options)===null||y===void 0?void 0:y.text)),b}}),u1=Ee.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ne({key:new et("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,o=[];if(!t)return null;const i=n.type.createAndFill(),s=(i==null?void 0:i.sameMarkup(n))&&i.content.findDiffStart(n.content)===null;return n.descendants((a,l)=>{const c=r>=l&&r<=l+a.nodeSize,u=!a.isLeaf&&!a.childCount;if((c||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];s&&d.push(this.options.emptyEditorClass);const p=Ge.node(l,l+a.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:l,hasAnchor:c}):this.options.placeholder});o.push(p)}return this.options.includeChildren}),te.create(n,o)}}})]}}),d1=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,p1=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,h1=Je.create({name:"edit-highlight",addOptions(){return{multicolor:!0,HTMLAttributes:{color:"",oldText:"",id:""}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>({"data-color":n.color,style:`background-color: ${n.color}; color: inherit;`})},oldText:{default:"",parseHTML:n=>n.getAttribute("data-old-text"),renderHTML:n=>({"data-old-text":n.oldText})},id:{default:"",parseHTML:n=>n.getAttribute("id"),renderHTML:n=>({id:n.id})}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",X(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{}},addInputRules(){return[Ut({find:d1,type:this.type})]},addPasteRules(){return[Vt({find:p1,type:this.type})]}}),f1=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,m1=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,g1=Je.create({name:"loading-highlight",addOptions(){return{multicolor:!0,HTMLAttributes:{}}},addAttributes(){return{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",X(this.options.HTMLAttributes,n,{class:"loading-highlight"}),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{}},addInputRules(){return[Ut({find:f1,type:this.type})]},addPasteRules(){return[Vt({find:m1,type:this.type})]}});new et("collapse");const y1=_e.create({name:"collapse",addOptions(){return{HTMLAttributes:{"deleted-text":"",class:"collapse-item",id:""},renderLabel({options:n,node:e}){const t=e.attrs["deleted-text"];return t.length<=2?t:`${t.slice(0,1)}...`}}},group:"inline",inline:!0,selectable:!0,atom:!0,addAttributes(){return{"deleted-text":{default:null,parseHTML:n=>n.getAttribute("deleted-text"),renderHTML:n=>({class:n.class,"deleted-text":n["deleted-text"]})},id:{default:null,parseHTML:n=>n.getAttribute("id"),renderHTML:n=>({class:n.class,id:n.id})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:n,HTMLAttributes:e}){return["span",X({"data-type":this.name},this.options.HTMLAttributes,e,{style:`background-color: ${Ue.customColors.deletedColor};`}),this.options.renderLabel({options:this.options,node:n})]},renderText({node:n}){return""},addKeyboardShortcuts(){return{}}}),Uu=()=>({x:0,y:0,width:0,height:0,bottom:0,left:0,top:0,right:0,toJSON:()=>""});class b1{constructor(e){this.preventHide=!1,this.curShownActiveID=null,this.mode="add",this.oldText="",this.newText="",this.summaryCounter=null,this.curBoxPosition="left",this.focusHandler=({event:i})=>{setTimeout(()=>{this.update(this.editor.view)})},this.blurHandler=async({event:i})=>{var a;if(this.preventHide){this.preventHide=!1;return}const s=await this.popperOptions.popperSidebarBox;i!=null&&i.relatedTarget&&((a=s.parentNode)!=null&&a.contains(i.relatedTarget))||this.hide()};const{editor:t,popperOptions:r,view:o}=e;if(r===void 0)throw Error("popperOptions is null");this.editor=t,this.view=o,this.popperOptions=r,this.popperParentBBox=Uu(),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler)}async update(e,t){const{state:r}=e,{doc:o,selection:i}=r,{$from:s,$to:a}=i;if(t&&t.doc.eq(o)&&t.selection.eq(i))return;let c=!1;this.editor.isActive("edit-highlight")?s.marks().length>0&&(c=!0):this.editor.isActive("collapse")&&s.nodeAfter!==null&&(c=!0);const u={addMarks:[],replaceMarks:[],deleteNodes:[]};if(i&&(r.doc.nodesBetween(s.pos,a.pos,d=>{for(const p of d.marks){const h=p.attrs;if(p.type.name==="edit-highlight"){h.oldText.length===0?u.addMarks.push(p):u.replaceMarks.push(p);break}}d.type.name==="collapse"&&u.deleteNodes.push(d)}),u.addMarks.length+u.replaceMarks.length+u.deleteNodes.length>0&&(c=!0)),!c){this.hide();return}await this.updatePosition(e,u),this.show()}async updatePosition(e,t){const{state:r}=e,{doc:o,selection:i}=r,{$from:s}=i,a=e.coordsAtPos(i.$anchor.pos);let l="right";if(a.left<=this.popperOptions.containerBBox.x+this.popperOptions.containerBBox.width/2&&(l="left"),l="left",this.editor.isActive("edit-highlight")){const c=s.marks()[0];if(c===void 0)return;const u=c.attrs;u.id===this.curShownActiveID&&(l=this.curBoxPosition);let d;if(o.content.descendants(h=>{if(h.marks.some(f=>f.attrs.id===u.id))return d=h,!1}),d===void 0||d.text===void 0)throw Error("Cannot find mark node.");this.oldText=u.oldText,this.newText=d.text,u.oldText.length===0?this.mode="add":this.mode="replace";const p=this.editor.options.element.querySelector(`mark#${c.attrs.id}`);if(this.curShownActiveID=c.attrs.id,p===null)throw Error(`Can't find mark#${c.attrs.id}`);await this.popperOptions.updateSidebarMenu({anchor:p,boxPosition:l,editor:this.editor,newText:this.newText,oldText:this.oldText,mode:this.mode,summaryCounter:null}),this.curBoxPosition=l}else if(this.editor.isActive("collapse")){const c=s.nodeAfter;if(c===null)throw Error(`Can't find node at ${s.pos}`);const u=c.attrs;this.mode="delete",this.oldText=u["deleted-text"],this.newText="",u.id===this.curShownActiveID&&(l=this.curBoxPosition);const d=this.editor.options.element.querySelector(`span.collapse-item#${u.id}`);if(this.curShownActiveID=u.id,d===null)throw Error(`Can't find span#${u.id}`);this.popperOptions.updateSidebarMenu({anchor:d,boxPosition:l,editor:this.editor,newText:this.newText,oldText:this.oldText,mode:this.mode,summaryCounter:null}),this.curBoxPosition=l}else if(t.addMarks.length+t.replaceMarks.length+t.deleteNodes.length>0){this.mode="summary",this.oldText="",this.newText="";let c=null;if(t.addMarks.length>0||t.replaceMarks.length>0){const u=t.addMarks[0]||t.replaceMarks[0];if(c=this.editor.options.element.querySelector(`mark#${u.attrs.id}`),this.curBoxPosition=l,c===null)throw Error(`Can't find span#${u.attrs.id}`)}else{const u=t.deleteNodes[0];if(c=this.editor.options.element.querySelector(`span.collapse-item#${u.attrs.id}`),this.curBoxPosition=l,c===null)throw Error(`Can't find span#${u.attrs.id}`)}this.popperOptions.updateSidebarMenu({anchor:c,boxPosition:l,editor:this.editor,newText:this.newText,oldText:this.oldText,mode:this.mode,summaryCounter:{add:t.addMarks.length,replace:t.replaceMarks.length,delete:t.deleteNodes.length}})}}async show(){const e=await this.popperOptions.popperSidebarBox;e.classList.remove("hidden");const t=e.querySelector("wordflow-sidebar-menu");t==null||t.removeAttribute("isHidden")}async hide(){this.curShownActiveID=null;const e=await this.popperOptions.popperSidebarBox;e.classList.add("hidden");const t=e.querySelector("wordflow-sidebar-menu");t==null||t.setAttribute("isHidden","true")}destroy(){this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const v1=n=>new Ne({key:typeof n.pluginKey=="string"?new et(n.pluginKey):n.pluginKey,view:e=>new b1({view:e,...n})}),D1=Ee.create({name:"sidebar-menu",addOptions(){return{pluginKey:"sidebar-menu",popperOptions:(()=>{const e=document.createElement("div"),t=Promise.resolve(e);return{containerBBox:Uu(),popperSidebarBox:t,updateSidebarMenu:()=>Promise.resolve()}})()}},addProseMirrorPlugins(){return[v1({pluginKey:this.options.pluginKey,editor:this.editor,popperOptions:this.options.popperOptions})]}}),w1=Ee.create({name:"eventHandler",onSelectionUpdate(){x1(this.options,this.editor,this.editor.view)},addProseMirrorPlugins(){return[new Ne({key:new et("eventHandler"),props:{}})]}}),x1=async(n,e,t)=>{const r=await n.floatingMenuBox,o=t.state.selection.$from,i=t.coordsAtPos(o.pos),s=r.getBoundingClientRect(),a=window.innerHeight,l=window.scrollY,c=parseInt(window.getComputedStyle(e.options.element).lineHeight),u=5,d=l+s.height/2+u,p=a+l-s.height/2-u,h=i.top+l+c/2,f=Math.min(p,Math.max(d,h));r.style.marginTop=`${f}px`},C1=`.text-editor-container{width:100%;min-height:100vh;padding:60px 70px;background-color:#fff;display:flex;box-sizing:border-box;position:relative}.text-editor{width:100%;height:100%;display:flex;box-sizing:border-box}.tiptap{display:block;width:100%;height:100%;p.is-editor-empty:first-child::before {color: #adb5bd; content: attr(data-placeholder); float: left; height: 0; pointer-events: none;}}.tiptap:focus{outline:none}button{all:unset;font-size:14px;padding:2px 10px;background-color:var(--blue-400);color:#fff;display:flex;align-items:center;justify-content:center;border-radius:5px;cursor:pointer}button:hover{background-color:var(--blue-300)}button:active{background-color:color-mix(in lab,var(--blue-300),black 5%)}.collapse-item{position:relative;display:inline;color:var(--gray-700)}.collapse-item:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:calc(100% + 2px);height:1px;background-color:var(--gray-700)}.text-editor[is-hovering-floating-menu] p.is-highlighted{background:linear-gradient(135deg,white,hsla(0,0%,99%,1),hsla(0,0%,96%,1),hsla(0,0%,92%,1),hsla(0,0%,96%,1),hsla(0,0%,99%,1),white);background-size:900% 900%;animation:gradient 4s ease-in-out infinite}.text-editor[is-hovering-floating-menu] p,.text-editor p{margin:0;padding:0;transition:background linear .3s}.text-editor[is-hovering-floating-menu] p.is-loading,.text-editor p.is-loading{background:linear-gradient(135deg,color-mix(in lab,#f29350,transparent 75%),color-mix(in lab,#c76888,transparent 75%),color-mix(in lab,#8578cd,transparent 75%),color-mix(in lab,#3495dc,transparent 75%),color-mix(in lab,#8578cd,transparent 75%),color-mix(in lab,#c76888,transparent 75%),color-mix(in lab,#f29350,transparent 75%));background-size:500% 500%;animation:gradient 3.5s ease-in-out infinite normal both}@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}mark.loading-highlight{background:linear-gradient(135deg,color-mix(in lab,#f29350,transparent 75%),color-mix(in lab,#c76888,transparent 75%),color-mix(in lab,#8578cd,transparent 75%),color-mix(in lab,#3495dc,transparent 75%),color-mix(in lab,#8578cd,transparent 75%),color-mix(in lab,#c76888,transparent 75%),color-mix(in lab,#f29350,transparent 75%));background-size:500% 500%;animation:gradient 4.5s ease-in-out infinite normal both}mark.loading-highlight::selection{background-color:transparent}
`,k1=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;var E1=Object.defineProperty,M1=Object.getOwnPropertyDescriptor,yt=(n,e,t,r)=>{for(var o=r>1?void 0:r?M1(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&E1(e,t,o),o};const vl=Ue.customColors.addedColor,T1=Ue.customColors.replacedColor,S1="{{text}}",F1=!1,Pn=F1,Dl=new wp;let Ze=class extends Q{constructor(){super(),this.isHoveringFloatingMenu=!1,this.editor=null,this.curEditID=0,this.containerBBox={x:0,y:0,width:0,height:0,bottom:0,left:0,top:0,right:0,toJSON:()=>""}}firstUpdated(){if(this.initEditor(),this.floatingMenuBox===void 0){console.error("Text editor / select menu element is not added to DOM yet!");return}this.floatingMenuBox.then(n=>{n.style.marginTop="100px",n.classList.remove("hidden")}),window.addEventListener("beforeunload",()=>{if(this.editor!==null){const n=this.editor.getJSON();localStorage.setItem("last-editor-content",JSON.stringify(n))}})}initEditor(){if(this.editorElement===void 0||this.selectMenuElement===void 0||this.containerElement===void 0||this.floatingMenuBox===void 0||this.popperSidebarBox===void 0||this.updateSidebarMenu===void 0){console.error("Text editor / select menu element is not added to DOM yet!");return}this.containerBBox=this.containerElement.getBoundingClientRect();const n=Ru.extend({addKeyboardShortcuts(){return{}}}),e=Bu.extend({addAttributes(){var p;return{...(p=this.parent)==null?void 0:p.call(this),"is-highlighted":{default:null,parseHTML:h=>h.getAttribute("is-highlighted"),renderHTML:h=>({class:h["is-highlighted"]?"is-highlighted":null})},"is-loading":{default:null,parseHTML:h=>h.getAttribute("is-loading"),renderHTML:h=>({class:h["is-loading"]?"is-loading":null})}}}}),t=c1.configure({text:!1,paragraph:!1}),r=h1.configure({multicolor:!0}),o=g1.configure({}),i={popperSidebarBox:this.popperSidebarBox,containerBBox:this.containerBBox,updateSidebarMenu:this.updateSidebarMenu},s=D1.configure({popperOptions:i}),a=w1.configure({floatingMenuBox:this.floatingMenuBox});let l="";const c=localStorage.getItem("last-editor-content");c!==null&&(l=JSON.parse(c)),localStorage.getItem("has-run-a-prompt")===null&&(l=`${hp}`);const d=u1.configure({placeholder:"Type or paste your text here to start..."});this.editor=new d0({element:this.editorElement,extensions:[t,e,n,r,o,y1,s,a,d],content:l,autofocus:!0})}willUpdate(n){}async initData(){}diffParagraph(n,e){const t=Dl.diff_main(n,e);Dl.diff_cleanupSemantic(t);let r="",o="";const i=new Map;for(const[s,a]of t.entries())switch(a[0]){case 0:{r+=a[1],o="";break}case-1:{o=a[1],(s+1>=t.length||t[s+1][0]===0)&&(r+=`<span
              id="collapse-${this.curEditID++}"
              data-type="collapse"
              deleted-text="${a[1]}"
            ></span>`);break}case 1:{if(a[1]===`

`){r+=a[1];continue}s>=1&&t[s-1][0]===-1&&(r+=`<mark
              id="edit-highlight-${this.curEditID++}"
              data-color="${T1}"
              data-old-text="${o}"
            >${a[1]}</mark>`,i.set(a[1],o),o=""),s>=1&&t[s-1][0]===0&&(r+=`<mark
              id="edit-highlight-${this.curEditID++}"
              data-color="${vl}"
              data-old-text="${o}"
            >${a[1]}</mark>`,i.set(a[1],""),o=""),s===0&&(r+=`<mark
              id="edit-highlight-${this.curEditID++}"
              data-color="${vl}"
              data-old-text="${o}"
            >${a[1]}</mark>`,i.set(a[1],""),o="");break}default:console.error("Unknown diff code",a)}return r.slice(-7)==="</mark>"&&(r+="&nbsp;"),r}isEmptySelection(){if(this.editor===null){console.error("Editor is not initialized yet.");return}const{$from:n,$to:e}=this.editor.view.state.selection;let t=n.pos!==e.pos;if(Math.abs(n.pos-e.pos)===1){const r=n.nodeAfter;r&&r.type.name==="collapse"&&(t=!1)}return t}acceptChange(){if(this.editor===null)throw Error("Editor is not fully initialized");const n=this.editor.view,e=n.state,t=e.selection,{$from:r}=t;if(this._isEditActive()){if(this.editor.isActive("edit-highlight"))this.editor.chain().focus().unsetMark("edit-highlight",{extendEmptyMarkRange:!0}).run();else if(this.editor.isActive("collapse")){const i=R.create(e.doc,r.pos),s=e.tr;s.setSelection(i),s.delete(r.pos,r.pos+1),n.dispatch(s),n.focus()}}}rejectChange(){if(this.editor===null)throw Error("Editor is not fully initialized");const n=this.editor.view,e=n.state,{selection:t,schema:r}=e,{$from:o}=t;if(this._isEditActive()){if(this.editor.isActive("edit-highlight")){const a=o.marks()[0].attrs;let l=-1,c=-1;e.doc.content.descendants((d,p)=>{if(d.marks.some(h=>h.attrs.id===a.id))return l=p,c=p+d.nodeSize,!1});const u=e.tr;if(a.oldText.length>0){const d=r.text(a.oldText),p=R.create(e.doc,l+d.nodeSize);u.setSelection(p),u.replaceWith(l,c,d)}else u.delete(l,c);n.dispatch(u),n.focus()}else if(this.editor.isActive("collapse")){const a=o.nodeAfter.attrs,l=R.create(e.doc,o.pos),c=e.tr;c.setSelection(l),c.delete(o.pos,o.pos+1);const u=r.text(a["deleted-text"]);c.insert(o.pos,u),n.dispatch(c),n.focus()}}}acceptAllChanges(){if(this.editor===null)throw Error("Editor is not fully initialized");const n=this.editor.view,e=n.state,t=e.selection,{$from:r,$to:o}=t,i=e.tr,s=e.schema.marks["edit-highlight"];i.removeMark(r.pos,o.pos,s);let a=[];e.doc.nodesBetween(r.pos,o.pos,(l,c)=>{l.type.name==="collapse"&&a.push(c)}),a=a.reverse();for(const l of a){const c=e.doc.nodeAt(l);c&&i.delete(l,l+c.nodeSize)}n.dispatch(i),n.focus()}rejectAllChanges(){if(this.editor===null)throw Error("Editor is not fully initialized");const n=this.editor.view,e=n.state,{selection:t,schema:r}=e,{$from:o,$to:i}=t,s=e.tr;let a=0;e.doc.nodesBetween(o.pos,i.pos,(l,c)=>{for(const u of l.marks){const d=u.attrs;if(u.type.name==="edit-highlight"){const p=c+a,h=c+l.nodeSize+a;if(d.oldText.length===0)s.delete(p,h),a-=l.nodeSize;else{const f=r.text(d.oldText);s.replaceWith(p,h,f),a=a-l.nodeSize+f.nodeSize}}}if(l.type.name==="collapse"){const u=l.attrs,d=r.text(u["deleted-text"]),p=c+a,h=c+l.nodeSize+a;s.replaceWith(p,h,d),a=a-l.nodeSize+d.nodeSize}}),n.dispatch(s),n.focus()}sidebarMenuFooterButtonClickedHandler(n){switch(n.detail){case"accept":{this.acceptChange();break}case"reject":{this.rejectChange();break}case"accept-all":{this.acceptAllChanges();break}case"reject-all":{this.rejectAllChanges();break}default:console.error("Unknown button clicked:",n.detail)}}floatingMenuToolsMouseEnterHandler(){if(this.editor===null){console.error("Editor is not initialized yet.");return}this.isHoveringFloatingMenu=!0;const{$from:n,$to:e}=this.editor.view.state.selection;this.isEmptySelection()||n.node().content.size>0&&this._setParagraphAttribute(n,"is-highlighted","true")}floatingMenuToolsMouseLeaveHandler(){if(this.editor===null){console.error("Editor is not initialized yet.");return}this.isHoveringFloatingMenu=!1;const{$from:n,$to:e}=this.editor.view.state.selection;this.isEmptySelection()||this._setParagraphAttribute(n,"is-highlighted",null)}floatingMenuToolButtonClickHandler(n){if(this.editor===null){console.error("Editor is not initialized yet.");return}const{state:e}=this.editor.view,{$from:t,$to:r}=e.selection;if(this.isEmptySelection()){this.editor.chain().focus().setMeta("addToHistory",!1).setMark("loading-highlight").run();const i=e.doc.textBetween(t.pos,r.pos);this._runPrompt(n,i).then(a=>{if(this.editor===null){console.error("Editor is not initialized yet.");return}switch(this._dispatchLoadingFinishedEvent(),this.editor.chain().focus().setMeta("addToHistory",!1).unsetMark("loading-highlight",{extendEmptyMarkRange:!0}).run(),a.command){case"finishTextGen":{if(this.editor===null){console.error("Editor is not initialized");return}this.userConfig.preferredLLM!==Pe["gpt-3.5-free"]&&mi("text-gen",n.prompt,"",n.temperature,n.userID,lo[this.userConfig.preferredLLM],Pn);let l=this._parseOutput(n,a.payload.result);n.injectionMode==="append"&&(l=i+" "+l);let c=this.diffParagraph(i,l);c=`${c}`;const u=c.split(`

`);if(u.length>1){let d="";for(const[p,h]of u.entries())p===0?d+=`${h}<p></p>`:p===u.length-1?d+=`${h}`:d+=`<p>${h}</p><p></p>`;c=d}this.editor.chain().focus().insertContentAt({from:t.pos,to:r.pos},c,{updateSelection:!0}).joinBackward().run(),this._updateAfterSuccessfulPromptRun(n);break}case"error":this._handleError(a.payload.message)}})}else{this._setParagraphAttribute(t,"is-highlighted",null),t.node().content.size>0&&this._setParagraphAttribute(t,"is-loading","true");const i=t.node(1),s=t.before(1),a=i.textContent;this._runPrompt(n,a).then(c=>{switch(this._setParagraphAttribute(t,"is-loading",null),this._dispatchLoadingFinishedEvent(),c.command){case"finishTextGen":{if(this.editor===null){console.error("Editor is not initialized");return}this.userConfig.preferredLLM!==Pe["gpt-3.5-free"]&&mi("text-gen",n.prompt,"",n.temperature,n.userID,lo[this.userConfig.preferredLLM],Pn);let u=this._parseOutput(n,c.payload.result);n.injectionMode==="append"&&a!==""&&(u=a+`
`+u);let d=this.diffParagraph(a,u);d=`<p>${d}</p>`,this.editor.chain().focus().insertContentAt({from:s,to:s+i.nodeSize},d,{updateSelection:!0}).run(),this._updateAfterSuccessfulPromptRun(n);break}case"error":this._handleError(c.payload.message)}})}}_runPrompt(n,e){const t=this._formatPrompt(n.prompt,e,S1);let r;switch(this.userConfig.preferredLLM){case Pe["gpt-3.5"]:r=co(this.userConfig.llmAPIKeys[Lt.openAI],"text-gen",t,n.temperature,"gpt-3.5-turbo",Pn);break;case Pe["gpt-4"]:r=co(this.userConfig.llmAPIKeys[Lt.openAI],"text-gen",t,n.temperature,"gpt-4-1106-preview",Pn);break;case Pe["gemini-pro"]:r=mc(this.userConfig.llmAPIKeys[Lt.google],"text-gen",t,n.temperature,Pn);break;default:r=mi("text-gen",n.prompt,e,n.temperature,n.userID,"gpt-3.5-free",Pn)}return r}_handleError(n){console.error("Failed to generate text",n);let e="Failed to run this prompt. Try again later.";n==="time out"&&(e="Fail to run this prompt (OpenAI API timed out!)"),n==="Rate limit exceeded."&&(e="You have run too many prompts. Try again later.");const t=new CustomEvent("show-toast",{bubbles:!0,composed:!0,detail:{message:e,type:"error"}});this.dispatchEvent(t)}_updateAfterSuccessfulPromptRun(n){if(this.editor===null){console.error("Editor is not initialized yet.");return}const e=structuredClone(n);e.promptRunCount+=1,this.promptManager.setPrompt(e),localStorage.setItem("has-run-a-prompt","true");const t=this.editor.getHTML();localStorage.setItem("last-editor-content",t)}_formatPrompt(n,e,t){let r="";return n.includes(t)?r=n.replace(t,e):r=n+`
`+e,r}_parseOutput(n,e){if(n.outputParsingPattern==="")return e;const t=new RegExp(n.outputParsingPattern);let r=n.outputParsingReplacement;return r===""&&(r="$1"),e.replace(t,r)}_isEditActive(){if(this.editor===null)throw Error("Editor is not fully initialized");const e=this.editor.view.state.selection,{$from:t}=e;let r=!1;return this.editor.isActive("edit-highlight")?t.marks().length>0&&(r=!0):this.editor.isActive("collapse")&&t.nodeAfter!==null&&(r=!0),r}_setParagraphAttribute(n,e,t){if(this.editor===null){console.error("Editor is not initialized yet.");return}const r=n.node(1),o=n.before(1),i={...r.attrs};i[e]=t;const s=this.editor.view.state.tr;s.setNodeMarkup(o,null,i),s.setMeta("addToHistory",!1),this.editor.view.dispatch(s)}_dispatchLoadingFinishedEvent(){const n=new Event("loading-finished",{bubbles:!0,composed:!0});this.dispatchEvent(n)}render(){return M` <div class="text-editor-container">
      <div
        class="text-editor"
        ?is-hovering-floating-menu=${this.isHoveringFloatingMenu}
      ></div>
    </div>`}};Ze.styles=[be`
      ${oe(C1)}
      ${oe(k1)}
    `];yt([O({attribute:!1})],Ze.prototype,"popperSidebarBox",2);yt([O({attribute:!1})],Ze.prototype,"floatingMenuBox",2);yt([O({attribute:!1})],Ze.prototype,"updateSidebarMenu",2);yt([O({attribute:!1})],Ze.prototype,"promptManager",2);yt([O({attribute:!1})],Ze.prototype,"userConfig",2);yt([Y(".text-editor-container")],Ze.prototype,"containerElement",2);yt([Y(".text-editor")],Ze.prototype,"editorElement",2);yt([Y(".select-menu")],Ze.prototype,"selectMenuElement",2);yt([I()],Ze.prototype,"isHoveringFloatingMenu",2);Ze=yt([ve("wordflow-text-editor")],Ze);const Ir=Math.min,jn=Math.max,Mo=Math.round,Gt=n=>({x:n,y:n}),P1={left:"right",right:"left",bottom:"top",top:"bottom"},A1={start:"end",end:"start"};function fs(n,e,t){return jn(n,Ir(e,t))}function Ur(n,e){return typeof n=="function"?n(e):n}function wn(n){return n.split("-")[0]}function Vr(n){return n.split("-")[1]}function Vu(n){return n==="x"?"y":"x"}function Hs(n){return n==="y"?"height":"width"}function Zo(n){return["top","bottom"].includes(wn(n))?"y":"x"}function js(n){return Vu(Zo(n))}function O1(n,e,t){t===void 0&&(t=!1);const r=Vr(n),o=js(n),i=Hs(o);let s=o==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(s=To(s)),[s,To(s)]}function I1(n){const e=To(n);return[ms(n),e,ms(e)]}function ms(n){return n.replace(/start|end/g,e=>A1[e])}function $1(n,e,t){const r=["left","right"],o=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(n){case"top":case"bottom":return t?e?o:r:e?r:o;case"left":case"right":return e?i:s;default:return[]}}function N1(n,e,t,r){const o=Vr(n);let i=$1(wn(n),t==="start",r);return o&&(i=i.map(s=>s+"-"+o),e&&(i=i.concat(i.map(ms)))),i}function To(n){return n.replace(/left|right|bottom|top/g,e=>P1[e])}function L1(n){return{top:0,right:0,bottom:0,left:0,...n}}function Gu(n){return typeof n!="number"?L1(n):{top:n,right:n,bottom:n,left:n}}function So(n){return{...n,top:n.y,left:n.x,right:n.x+n.width,bottom:n.y+n.height}}function wl(n,e,t){let{reference:r,floating:o}=n;const i=Zo(e),s=js(e),a=Hs(s),l=wn(e),c=i==="y",u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,p=r[a]/2-o[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-o.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Vr(e)){case"start":h[s]-=p*(t&&c?-1:1);break;case"end":h[s]+=p*(t&&c?-1:1);break}return h}const R1=async(n,e,t)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=t,a=i.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:n,floating:e,strategy:o}),{x:u,y:d}=wl(c,r,l),p=r,h={},f=0;for(let m=0;m<a.length;m++){const{name:g,fn:y}=a[m],{x:b,y:v,data:k,reset:x}=await y({x:u,y:d,initialPlacement:r,placement:p,strategy:o,middlewareData:h,rects:c,platform:s,elements:{reference:n,floating:e}});if(u=b??u,d=v??d,h={...h,[g]:{...h[g],...k}},x&&f<=50){f++,typeof x=="object"&&(x.placement&&(p=x.placement),x.rects&&(c=x.rects===!0?await s.getElementRects({reference:n,floating:e,strategy:o}):x.rects),{x:u,y:d}=wl(c,p,l)),m=-1;continue}}return{x:u,y:d,placement:p,strategy:o,middlewareData:h}};async function Wu(n,e){var t;e===void 0&&(e={});const{x:r,y:o,platform:i,rects:s,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=Ur(e,n),f=Gu(h),g=a[p?d==="floating"?"reference":"floating":d],y=So(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(g)))==null||t?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=d==="floating"?{...s.floating,x:r,y:o}:s.reference,v=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(v))?await(i.getScale==null?void 0:i.getScale(v))||{x:1,y:1}:{x:1,y:1},x=So(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:v,strategy:l}):b);return{top:(y.top-x.top+f.top)/k.y,bottom:(x.bottom-y.bottom+f.bottom)/k.y,left:(y.left-x.left+f.left)/k.x,right:(x.right-y.right+f.right)/k.x}}const B1=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:o,rects:i,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Ur(n,e)||{};if(c==null)return{};const d=Gu(u),p={x:t,y:r},h=js(o),f=Hs(h),m=await s.getDimensions(c),g=h==="y",y=g?"top":"left",b=g?"bottom":"right",v=g?"clientHeight":"clientWidth",k=i.reference[f]+i.reference[h]-p[h]-i.floating[f],x=p[h]-i.reference[h],C=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let A=C?C[v]:0;(!A||!await(s.isElement==null?void 0:s.isElement(C)))&&(A=a.floating[v]||i.floating[f]);const $=k/2-x/2,E=A/2-m[f]/2-1,z=Ir(d[y],E),S=Ir(d[b],E),L=z,U=A-m[f]-S,V=A/2-m[f]/2+$,Se=fs(L,V,U),pe=!l.arrow&&Vr(o)!=null&&V!=Se&&i.reference[f]/2-(V<L?z:S)-m[f]/2<0,xe=pe?V<L?V-L:V-U:0;return{[h]:p[h]+xe,data:{[h]:Se,centerOffset:V-Se-xe,...pe&&{alignmentOffset:xe}},reset:pe}}}),xl=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:o,middlewareData:i,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=Ur(n,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const y=wn(o),b=wn(a)===a,v=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=p||(b||!m?[To(a)]:I1(a));!p&&f!=="none"&&k.push(...N1(a,m,f,v));const x=[a,...k],C=await Wu(e,g),A=[];let $=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&A.push(C[y]),d){const L=O1(o,s,v);A.push(C[L[0]],C[L[1]])}if($=[...$,{placement:o,overflows:A}],!A.every(L=>L<=0)){var E,z;const L=(((E=i.flip)==null?void 0:E.index)||0)+1,U=x[L];if(U)return{data:{index:L,overflows:$},reset:{placement:U}};let V=(z=$.filter(Se=>Se.overflows[0]<=0).sort((Se,pe)=>Se.overflows[1]-pe.overflows[1])[0])==null?void 0:z.placement;if(!V)switch(h){case"bestFit":{var S;const Se=(S=$.map(pe=>[pe.placement,pe.overflows.filter(xe=>xe>0).reduce((xe,kt)=>xe+kt,0)]).sort((pe,xe)=>pe[1]-xe[1])[0])==null?void 0:S[0];Se&&(V=Se);break}case"initialPlacement":V=a;break}if(o!==V)return{reset:{placement:V}}}return{}}}};async function _1(n,e){const{placement:t,platform:r,elements:o}=n,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),s=wn(t),a=Vr(t),l=Zo(t)==="y",c=["left","top"].includes(s)?-1:1,u=i&&l?-1:1,d=Ur(e,n);let{mainAxis:p,crossAxis:h,alignmentAxis:f}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof f=="number"&&(h=a==="end"?f*-1:f),l?{x:h*u,y:p*c}:{x:p*c,y:h*u}}const Cl=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){const{x:t,y:r}=e,o=await _1(e,n);return{x:t+o.x,y:r+o.y,data:o}}}},kl=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:o}=e,{mainAxis:i=!0,crossAxis:s=!1,limiter:a={fn:g=>{let{x:y,y:b}=g;return{x:y,y:b}}},...l}=Ur(n,e),c={x:t,y:r},u=await Wu(e,l),d=Zo(wn(o)),p=Vu(d);let h=c[p],f=c[d];if(i){const g=p==="y"?"top":"left",y=p==="y"?"bottom":"right",b=h+u[g],v=h-u[y];h=fs(b,h,v)}if(s){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",b=f+u[g],v=f-u[y];f=fs(b,f,v)}const m=a.fn({...e,[p]:h,[d]:f});return{...m,data:{x:m.x-t,y:m.y-r}}}}};function Wt(n){return Yu(n)?(n.nodeName||"").toLowerCase():"#document"}function We(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Jt(n){var e;return(e=(Yu(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function Yu(n){return n instanceof Node||n instanceof We(n).Node}function Ct(n){return n instanceof Element||n instanceof We(n).Element}function ft(n){return n instanceof HTMLElement||n instanceof We(n).HTMLElement}function El(n){return typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof We(n).ShadowRoot}function Gr(n){const{overflow:e,overflowX:t,overflowY:r,display:o}=Xe(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(o)}function z1(n){return["table","td","th"].includes(Wt(n))}function Us(n){const e=Vs(),t=Xe(n);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function H1(n){let e=Zn(n);for(;ft(e)&&!Xo(e);){if(Us(e))return e;e=Zn(e)}return null}function Vs(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Xo(n){return["html","body","#document"].includes(Wt(n))}function Xe(n){return We(n).getComputedStyle(n)}function Qo(n){return Ct(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function Zn(n){if(Wt(n)==="html")return n;const e=n.assignedSlot||n.parentNode||El(n)&&n.host||Jt(n);return El(e)?e.host:e}function Ku(n){const e=Zn(n);return Xo(e)?n.ownerDocument?n.ownerDocument.body:n.body:ft(e)&&Gr(e)?e:Ku(e)}function gs(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const o=Ku(n),i=o===((r=n.ownerDocument)==null?void 0:r.body),s=We(o);return i?e.concat(s,s.visualViewport||[],Gr(o)?o:[],s.frameElement&&t?gs(s.frameElement):[]):e.concat(o,gs(o,[],t))}function qu(n){const e=Xe(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=ft(n),i=o?n.offsetWidth:t,s=o?n.offsetHeight:r,a=Mo(t)!==i||Mo(r)!==s;return a&&(t=i,r=s),{width:t,height:r,$:a}}function Ju(n){return Ct(n)?n:n.contextElement}function Un(n){const e=Ju(n);if(!ft(e))return Gt(1);const t=e.getBoundingClientRect(),{width:r,height:o,$:i}=qu(e);let s=(i?Mo(t.width):t.width)/r,a=(i?Mo(t.height):t.height)/o;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const j1=Gt(0);function Zu(n){const e=We(n);return!Vs()||!e.visualViewport?j1:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function U1(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==We(n)?!1:e}function $r(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const o=n.getBoundingClientRect(),i=Ju(n);let s=Gt(1);e&&(r?Ct(r)&&(s=Un(r)):s=Un(n));const a=U1(i,t,r)?Zu(i):Gt(0);let l=(o.left+a.x)/s.x,c=(o.top+a.y)/s.y,u=o.width/s.x,d=o.height/s.y;if(i){const p=We(i),h=r&&Ct(r)?We(r):r;let f=p.frameElement;for(;f&&r&&h!==p;){const m=Un(f),g=f.getBoundingClientRect(),y=Xe(f),b=g.left+(f.clientLeft+parseFloat(y.paddingLeft))*m.x,v=g.top+(f.clientTop+parseFloat(y.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,d*=m.y,l+=b,c+=v,f=We(f).frameElement}}return So({width:u,height:d,x:l,y:c})}function V1(n){let{rect:e,offsetParent:t,strategy:r}=n;const o=ft(t),i=Jt(t);if(t===i)return e;let s={scrollLeft:0,scrollTop:0},a=Gt(1);const l=Gt(0);if((o||!o&&r!=="fixed")&&((Wt(t)!=="body"||Gr(i))&&(s=Qo(t)),ft(t))){const c=$r(t);a=Un(t),l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-s.scrollLeft*a.x+l.x,y:e.y*a.y-s.scrollTop*a.y+l.y}}function G1(n){return Array.from(n.getClientRects())}function Xu(n){return $r(Jt(n)).left+Qo(n).scrollLeft}function W1(n){const e=Jt(n),t=Qo(n),r=n.ownerDocument.body,o=jn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=jn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-t.scrollLeft+Xu(n);const a=-t.scrollTop;return Xe(r).direction==="rtl"&&(s+=jn(e.clientWidth,r.clientWidth)-o),{width:o,height:i,x:s,y:a}}function Y1(n,e){const t=We(n),r=Jt(n),o=t.visualViewport;let i=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){i=o.width,s=o.height;const c=Vs();(!c||c&&e==="fixed")&&(a=o.offsetLeft,l=o.offsetTop)}return{width:i,height:s,x:a,y:l}}function K1(n,e){const t=$r(n,!0,e==="fixed"),r=t.top+n.clientTop,o=t.left+n.clientLeft,i=ft(n)?Un(n):Gt(1),s=n.clientWidth*i.x,a=n.clientHeight*i.y,l=o*i.x,c=r*i.y;return{width:s,height:a,x:l,y:c}}function Ml(n,e,t){let r;if(e==="viewport")r=Y1(n,t);else if(e==="document")r=W1(Jt(n));else if(Ct(e))r=K1(e,t);else{const o=Zu(n);r={...e,x:e.x-o.x,y:e.y-o.y}}return So(r)}function Qu(n,e){const t=Zn(n);return t===e||!Ct(t)||Xo(t)?!1:Xe(t).position==="fixed"||Qu(t,e)}function q1(n,e){const t=e.get(n);if(t)return t;let r=gs(n,[],!1).filter(a=>Ct(a)&&Wt(a)!=="body"),o=null;const i=Xe(n).position==="fixed";let s=i?Zn(n):n;for(;Ct(s)&&!Xo(s);){const a=Xe(s),l=Us(s);!l&&a.position==="fixed"&&(o=null),(i?!l&&!o:!l&&a.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||Gr(s)&&!l&&Qu(n,s))?r=r.filter(u=>u!==s):o=a,s=Zn(s)}return e.set(n,r),r}function J1(n){let{element:e,boundary:t,rootBoundary:r,strategy:o}=n;const s=[...t==="clippingAncestors"?q1(e,this._c):[].concat(t),r],a=s[0],l=s.reduce((c,u)=>{const d=Ml(e,u,o);return c.top=jn(d.top,c.top),c.right=Ir(d.right,c.right),c.bottom=Ir(d.bottom,c.bottom),c.left=jn(d.left,c.left),c},Ml(e,a,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Z1(n){return qu(n)}function X1(n,e,t){const r=ft(e),o=Jt(e),i=t==="fixed",s=$r(n,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Gt(0);if(r||!r&&!i)if((Wt(e)!=="body"||Gr(o))&&(a=Qo(e)),r){const c=$r(e,!0,i,e);l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}else o&&(l.x=Xu(o));return{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function Tl(n,e){return!ft(n)||Xe(n).position==="fixed"?null:e?e(n):n.offsetParent}function ed(n,e){const t=We(n);if(!ft(n))return t;let r=Tl(n,e);for(;r&&z1(r)&&Xe(r).position==="static";)r=Tl(r,e);return r&&(Wt(r)==="html"||Wt(r)==="body"&&Xe(r).position==="static"&&!Us(r))?t:r||H1(n)||t}const Q1=async function(n){let{reference:e,floating:t,strategy:r}=n;const o=this.getOffsetParent||ed,i=this.getDimensions;return{reference:X1(e,await o(t),r),floating:{x:0,y:0,...await i(t)}}};function ey(n){return Xe(n).direction==="rtl"}const ty={convertOffsetParentRelativeRectToViewportRelativeRect:V1,getDocumentElement:Jt,getClippingRect:J1,getOffsetParent:ed,getElementRects:Q1,getClientRects:G1,getDimensions:Z1,getScale:Un,isElement:Ct,isRTL:ey},Sl=(n,e,t)=>{const r=new Map,o={platform:ty,...t},i={...o.platform,_c:r};return R1(n,e,{...o,platform:i})};/**
 * @author Jay Wang
 * @email jay@zijie.wang
 * @license MIT
 */const Fl=(n,e)=>Math.round((n+Number.EPSILON)*10**e)/10**e,Fo=(n,e,t,r,o,i=8)=>{const s=n.querySelector(".popper-content");s.innerHTML=t;const a=n.querySelector(".popper-arrow");o?(a.classList.remove("hidden"),Sl(e,n,{placement:r,middleware:[Cl(i),xl(),kl(),B1({element:a})]}).then(({x:l,y:c,placement:u,middlewareData:d})=>{n.style.left=`${l}px`,n.style.top=`${c}px`;const{x:p,y:h}=d.arrow;let f="bottom";u.includes("top")&&(f="bottom"),u.includes("right")&&(f="left"),u.includes("bottom")&&(f="top"),u.includes("left")&&(f="right"),a.style.left=p?`${p}px`:"",a.style.top=h?`${h}px`:"",a.style.right="",a.style.bottom="",a.style[f]="-4px"})):(a.classList.add("hidden"),Sl(e,n,{placement:r,middleware:[Cl(6),xl(),kl()]}).then(({x:l,y:c})=>{n.style.left=`${l}px`,n.style.top=`${c}px`}))},ei=(n,e,t,r,o=500,i=void 0,s=8)=>{let a;i!==void 0?a=i:a=n.currentTarget,r&&(r.tooltipElement.classList.contains("hidden")?(r.mouseenterTimer!==null&&(clearTimeout(r.mouseenterTimer),r.mouseenterTimer=null),r.mouseenterTimer=setTimeout(()=>{Fo(r.tooltipElement,a,e,t,!0,s),r.tooltipElement.classList.remove("hidden"),r.mouseenterTimer=null},o)):(r.mouseleaveTimer!==null&&(clearTimeout(r.mouseleaveTimer),r.mouseleaveTimer=null),Fo(r.tooltipElement,a,e,t,!0,s)))},ti=(n,e=500)=>{n&&(n.mouseenterTimer!==null&&(clearTimeout(n.mouseenterTimer),n.mouseenterTimer=null),n.mouseleaveTimer!==null&&(clearTimeout(n.mouseleaveTimer),n.mouseleaveTimer=null),n.mouseleaveTimer=setTimeout(()=>{n.tooltipElement.classList.add("hidden"),n.mouseleaveTimer=null},e))},ny=`.sidebar-menu{width:100%;padding:10px 12px;max-height:90vh;display:flex;flex-flow:column;justify-content:flex-start;align-items:flex-start;gap:12px;box-sizing:border-box;background-color:#fff;font-size:var(--font-d2);border-radius:5px}.sidebar-menu[is-on-left]{text-align:right}.sidebar-menu[is-on-left] .header-row{flex-flow:row-reverse}.sidebar-menu[is-on-left] .footer-row{justify-content:flex-end}.sidebar-menu[is-hidden] button{cursor:default}.header-row{width:100%;line-height:1;font-weight:700;display:flex;flex-flow:row;align-items:center;gap:7px}.header-row .header-circle{position:relative;top:1px;width:8px;height:8px;border-radius:100%;background-color:var(--gray-200)}.content-row{display:flex;flex-flow:column;align-items:center;width:100%;gap:4px;overflow-y:auto}.content-row .arrow{position:relative;display:flex;align-items:center;transform:rotate(45deg);color:var(--gray-400);flex:0 0 auto;border-right:2px solid;border-bottom:2px solid;height:6px;width:6px;top:-2px}.content-row .arrow[is-hidden]{display:none}.content-row .text-block{width:100%;padding:5px;border-radius:3px;line-height:1.25;background-color:var(--gray-200);box-sizing:border-box}.content-row .text-block.summary-text{display:flex;flex-flow:column;gap:7px;padding:5px 0}.content-row .text-block.summary-text .summary-row{padding:2px 3px}.content-row .text-block[is-hidden]{display:none}.content-row .old-text{text-decoration:line-through}.footer-row{width:100%;display:flex;flex-flow:row;justify-content:flex-start;gap:7px}.footer-row .group{display:flex;flex-flow:row;gap:7px}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;stroke:currentColor;width:100%;height:100%}button{all:unset;padding:4px 8px;line-height:1;background-color:var(--gray-700);color:#fff;display:flex;align-items:center;justify-content:center;gap:5px;border-radius:4px;font-weight:500;cursor:pointer}button .svg-icon{width:11px;height:11px}button *{pointer-events:none}button:hover{background-color:color-mix(in lab,var(--gray-700),white 8%)}button:active{background-color:var(--gray-700)}.popper-tooltip{position:absolute;width:max-content;left:0;top:0;z-index:20;background:var(--gray-800);color:#fff;box-shadow:0 0 1px #0009,0 0 3px #0000000d;padding:0 5px 3px;border-radius:4px;font-size:var(--font-d3);display:flex;justify-content:center;box-sizing:border-box;pointer-events:none;opacity:1;transform:scale(1);transition:opacity .15s,transform .15s}.popper-tooltip.hidden{opacity:0;transform:scale(.8)}.popper-tooltip .popper-content{max-width:200px;max-height:200px;line-height:1.5;overflow:hidden;display:inline;user-select:none;-webkit-user-select:none;text-align:center}.popper-tooltip .popper-content :global(.tooltip-image){width:100px;height:100px;object-fit:contain}.popper-tooltip .popper-content .instruction-text{color:var(--gray-400)}.popper-tooltip .popper-content .warn-text{color:var(--orange-a200)}.popper-tooltip .popper-content .alert-text{color:var(--red-a100)}.popper-tooltip .popper-arrow{position:absolute;background:var(--gray-800);width:8px;height:8px;transform:rotate(45deg);opacity:1}.popper-tooltip .popper-arrow.hidden{opacity:0}
`,ry=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 68 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-check">
        <path d="M26.302,66.557C28.206,66.557 29.72,65.727 30.794,64.066L66.39,7.768C67.22,6.498 67.513,5.473 67.513,4.447C67.513,2.055 65.95,0.443 63.509,0.443C61.751,0.443 60.774,1.029 59.7,2.738L26.106,56.645L8.431,32.816C7.308,31.303 6.233,30.668 4.622,30.668C2.181,30.668 0.423,32.377 0.423,34.818C0.423,35.844 0.862,36.967 1.692,38.041L21.663,63.969C23.03,65.727 24.397,66.557 26.302,66.557Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,ir=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 62 62" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-cross">
        <path d="M1.299,60.421C2.861,61.935 5.4,61.935 6.914,60.421L30.84,36.447L54.814,60.421C56.279,61.935 58.867,61.935 60.381,60.421C61.894,58.859 61.894,56.32 60.381,54.855L36.406,30.88L60.381,6.955C61.894,5.441 61.943,2.853 60.381,1.339C58.818,-0.125 56.279,-0.125 54.814,1.339L30.84,25.314L6.914,1.339C5.4,-0.125 2.812,-0.174 1.299,1.339C-0.166,2.902 -0.166,5.441 1.299,6.955L25.273,30.88L1.299,54.855C-0.166,56.32 -0.215,58.908 1.299,60.421Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`;var oy=Object.defineProperty,iy=Object.getOwnPropertyDescriptor,Zt=(n,e,t,r)=>{for(var o=r>1?void 0:r?iy(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&oy(e,t,o),o};let mt=class extends Q{constructor(){super(),this.isOnLeft=!0,this.isHidden=!1,this.mode="add",this.oldText="",this.newText="",this.summaryCounter=null,this.tooltipConfig=null,this.modeColorMap={add:{backgroundColor:Ue.customColors.addedColor,circleColor:Ue.colors["green-200"]},replace:{backgroundColor:Ue.customColors.replacedColor,circleColor:Ue.colors["orange-200"]},delete:{backgroundColor:Ue.customColors.deletedColor,circleColor:Ue.colors["pink-200"]},summary:{backgroundColor:"inherit",circleColor:Ue.colors["gray-300"]}},this.headerTextMap={add:"Adding Text",replace:"Replacing Text",delete:"Removing Text",summary:"Editing Text"},this.counterNameMap={add:"addition",replace:"replacement",delete:"deletion"}}willUpdate(n){}firstUpdated(){this.popperElement&&(this.tooltipConfig={tooltipElement:this.popperElement,mouseenterTimer:null,mouseleaveTimer:null})}async initData(){}footerButtonClicked(n){const e=n.target;if(e.tagName!=="BUTTON")return;const t=e.getAttribute("button-key");if(t===null){console.error("Clicking a button without button-key.");return}const r=new CustomEvent("footer-button-clicked",{detail:t,bubbles:!0,composed:!0});this.dispatchEvent(r)}buttonMouseEntered(n,e){const t=n.currentTarget;ei(n,e,"top",this.tooltipConfig,200,t,10)}buttonMouseLeft(){ti(this.tooltipConfig)}render(){let n=M``;if(this.summaryCounter)for(const e of Object.keys(this.summaryCounter)){const t=e,r=this.summaryCounter[t];r>0&&(n=M`${n}
            <div
              class="summary-row"
              style="background-color: ${this.modeColorMap[t].backgroundColor};"
            >
              ${r} ${this.counterNameMap[t]}${r>1?"s":""}
            </div>`)}return M`
      <div
        class="sidebar-menu"
        ?is-on-left=${this.isOnLeft}
        ?is-hidden=${this.isHidden}
      >
        <div
          id="popper-tooltip-sidebar"
          class="popper-tooltip hidden"
          role="tooltip"
        >
          <span class="popper-content"></span>
          <div class="popper-arrow"></div>
        </div>

        <div class="header-row">
          <span
            class="header-circle"
            style="background-color: ${this.modeColorMap[this.mode].circleColor};"
          ></span>
          <span class="header-name">${this.headerTextMap[this.mode]}</span>
        </div>

        <div class="content-row">
          <div
            class="text-block old-text"
            ?is-hidden=${this.mode==="add"||this.mode==="summary"}
            style="background-color: ${this.mode==="delete"?this.modeColorMap[this.mode].backgroundColor:"inherent"};"
          >
            ${this.oldText}
          </div>

          <div class="arrow" ?is-hidden=${this.mode!=="replace"}></div>

          <div
            class="text-block new-text"
            ?is-hidden=${this.mode==="delete"||this.mode==="summary"}
            style="background-color: ${this.modeColorMap[this.mode].backgroundColor};"
          >
            ${this.newText}
          </div>

          <div
            class="text-block summary-text"
            ?is-hidden=${this.mode!=="summary"}
            style="background-color: ${this.modeColorMap[this.mode].backgroundColor};"
          >
            ${n}
          </div>
        </div>

        <div
          class="footer-row"
          @click=${e=>this.footerButtonClicked(e)}
        >
          <div class="group">
            <button
              class="button"
              button-key=${this.mode==="summary"?"accept-all":"accept"}
              @mouseenter=${e=>this.buttonMouseEntered(e,this.mode==="summary"?"Accept all":"Accept")}
              @mouseleave=${()=>this.buttonMouseLeft()}
            >
              <span class="svg-icon">${H(ry)}</span>
            </button>
            <button
              class="button"
              button-key=${this.mode==="summary"?"reject-all":"reject"}
              @mouseenter=${e=>this.buttonMouseEntered(e,this.mode==="summary"?"Reject all":"Reject")}
              @mouseleave=${()=>this.buttonMouseLeft()}
            >
              <span class="svg-icon">${H(ir)}</span>
            </button>
          </div>
        </div>
      </div>
    `}};mt.styles=[be`
      ${oe(ny)}
    `];Zt([O({type:Boolean})],mt.prototype,"isOnLeft",2);Zt([O({type:Boolean})],mt.prototype,"isHidden",2);Zt([O({type:String})],mt.prototype,"mode",2);Zt([O({type:String})],mt.prototype,"oldText",2);Zt([O({type:String})],mt.prototype,"newText",2);Zt([O({attribute:!1})],mt.prototype,"summaryCounter",2);Zt([Y("#popper-tooltip-sidebar")],mt.prototype,"popperElement",2);mt=Zt([ve("wordflow-sidebar-menu")],mt);const sy=`.floating-menu{width:100%;height:max-content;display:flex;flex-direction:column;justify-content:center;align-items:center;box-sizing:border-box;background-color:#fff;border-radius:25px;box-shadow:0 4px 8px 3px #00000014,0 1px 3px #0003;overflow:hidden}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.tool-buttons[has-loading-action] button{cursor:not-allowed}.tool-buttons[has-loading-action] button[is-loading]{cursor:progress}.icon{display:flex;position:relative}button.tool-button{--padding: 4px;all:unset;width:100%;padding:var(--padding) var(--padding);line-height:1;background-color:#fff;box-sizing:border-box;color:var(--gray-700);display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative}button.tool-button .svg-icon{width:28px;height:28px;border-radius:100%;border:1px solid var(--gray-300);position:relative;font-size:1em;font-weight:700;text-align:center;vertical-align:center;line-height:1;box-sizing:border-box;transition:box-shadow linear .1s;box-shadow:0 0 5px #00000014}button.tool-button .svg-icon svg{width:15px;height:15px}button.tool-button *{pointer-events:none}button.tool-button:hover .svg-icon{box-shadow:0 0 5px #00000026;transform:scale(1.05)}button.tool-button:active .svg-icon,button.tool-button.active .svg-icon{box-shadow:0 0 5px #00000026;transform:scale(.99)}button.tool-button:first-child{padding-top:calc(var(--padding) + 4px)}button.tool-button:nth-last-child(1){padding-bottom:calc(var(--padding) + 2px)}button.tool-button.setting-button{padding-top:calc(var(--padding) + 1px);padding-bottom:calc(var(--padding) + 4px);border-top:1px solid var(--gray-300)}button.tool-button[is-empty]{color:var(--gray-300);font-size:150%}button.tool-button[is-empty] .svg-icon{padding-bottom:4px}@supports (font: -apple-system-body) and (-webkit-appearance: none){button .svg-icon{font-size:13px}}.loader-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:row;gap:10px;align-items:center;white-space:nowrap;line-height:1;border-radius:50%;background:conic-gradient(color-mix(in lab,#f29350,transparent 0%),color-mix(in lab,#c76888,transparent 0%),color-mix(in lab,#8578cd,transparent 0%),color-mix(in lab,#3495dc,transparent 0%),color-mix(in lab,#8578cd,transparent 0%),color-mix(in lab,#c76888,transparent 0%),color-mix(in lab,#f29350,transparent 0%));transition:opacity .1s ease-in-out;opacity:1}.loader-container[hidden]{display:none;pointer-events:none}.loader-container .circle-loader{position:relative;width:10px;height:10px;border-radius:50%;border:4px solid;border-color:#ffffffbf;border-right-color:#ffffff1a;animation:circle-loader-animation 1s infinite linear}.loader-container .circle-loader:after{content:"";position:absolute;width:11px;height:11px;background-color:#fff;border-radius:50%;transform:translate(-50%,-50%);top:50%;left:50%}@keyframes circle-loader-animation{to{transform:rotate(1turn)}}
`,ay=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 82 81" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-gear">
        <path d="M37.405,80.932L44.289,80.932C46.243,80.932 47.707,79.76 48.147,77.855L50.149,69.311C51.76,68.773 53.274,68.187 54.641,67.504L62.112,72.094C63.674,73.07 65.578,72.924 66.897,71.605L71.731,66.771C73.049,65.453 73.244,63.451 72.17,61.84L67.629,54.418C68.313,53.051 68.948,51.537 69.387,50.121L78.03,48.07C79.885,47.68 81.008,46.215 81.008,44.213L81.008,37.475C81.008,35.57 79.885,34.105 78.03,33.715L69.485,31.615C68.948,29.955 68.264,28.49 67.727,27.269L72.268,19.701C73.293,18.09 73.196,16.234 71.828,14.867L66.897,10.033C65.53,8.812 63.869,8.568 62.258,9.447L54.641,14.135C53.323,13.451 51.809,12.865 50.149,12.328L48.147,3.637C47.707,1.732 46.243,0.56 44.289,0.56L37.405,0.56C35.452,0.56 33.987,1.732 33.596,3.637L31.545,12.23C29.983,12.768 28.371,13.353 27.053,14.086L19.485,9.447C17.825,8.568 16.164,8.764 14.797,10.033L9.866,14.867C8.498,16.234 8.401,18.09 9.426,19.701L13.967,27.269C13.43,28.49 12.746,29.955 12.258,31.615L3.713,33.715C1.809,34.105 0.686,35.57 0.686,37.475L0.686,44.213C0.686,46.215 1.809,47.68 3.713,48.07L12.356,50.121C12.746,51.537 13.381,53.051 14.065,54.418L9.524,61.84C8.45,63.451 8.645,65.453 9.963,66.771L14.797,71.605C16.116,72.924 18.02,73.07 19.631,72.094L27.102,67.504C28.42,68.187 29.983,68.773 31.545,69.311L33.596,77.855C33.987,79.76 35.452,80.932 37.405,80.932ZM40.871,54.174C33.45,54.174 27.444,48.07 27.444,40.697C27.444,33.373 33.45,27.318 40.871,27.318C48.244,27.318 54.25,33.373 54.25,40.697C54.25,48.07 48.244,54.174 40.871,54.174Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`;var ly=Object.defineProperty,cy=Object.getOwnPropertyDescriptor,ni=(n,e,t,r)=>{for(var o=r>1?void 0:r?cy(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&ly(e,t,o),o};let Xn=class extends Q{constructor(){super(),this.loadingActionIndex=null,this.favPrompts=[null,null,null]}willUpdate(n){}async initData(){}toolButtonGroupMouseEnterHandler(n){n.preventDefault();const e=new Event("mouse-enter-tools",{bubbles:!0,composed:!0});this.dispatchEvent(e)}toolButtonGroupMouseLeaveHandler(n){n.preventDefault();const e=new Event("mouse-leave-tools",{bubbles:!0,composed:!0});this.dispatchEvent(e)}toolButtonClickHandler(n,e){n.preventDefault();const t=this.favPrompts[e];if(t===null){this.settingButtonClicked();return}if(this.loadingActionIndex!==null)return;const r=n.target;r.classList.add("active"),setTimeout(()=>{r.classList.remove("active")},100);const o=new CustomEvent("tool-button-clicked",{detail:[t,e],bubbles:!0,composed:!0});this.dispatchEvent(o)}settingButtonClicked(){const n=new Event("setting-button-clicked",{bubbles:!0,composed:!0});this.dispatchEvent(n)}toolButtonMouseEnterHandler(n,e){if(this.popperTooltip===void 0)throw Error("Popper is not initialized.");const t=this.favPrompts[e];this.popperTooltip.then(r=>{Fo(r,n.target,(t==null?void 0:t.title)||"Add a prompt","right",!0,10),r.classList.remove("hidden")})}settingButtonMouseEnterHandler(n){if(this.popperTooltip===void 0)throw Error("Popper is not initialized.");this.popperTooltip.then(e=>{Fo(e,n.target,"Settings","right",!0,10),e.classList.remove("hidden")})}toolButtonMouseLeaveHandler(n){if(this.popperTooltip===void 0)throw Error("Popper is not initialized.");this.popperTooltip.then(e=>{e.classList.add("hidden")})}render(){let n=M``;for(const[e,t]of this.favPrompts.entries()){const r=(t==null?void 0:t.icon)||"+";n=M`${n}
        <button
          class="tool-button"
          ?is-loading=${this.loadingActionIndex===e}
          ?is-empty=${t===null}
          @mousedown=${o=>this.toolButtonClickHandler(o,e)}
          @mouseenter=${o=>this.toolButtonMouseEnterHandler(o,e)}
          @mouseleave=${o=>this.toolButtonMouseLeaveHandler(o)}
        >
          <div class="icon">
            <div class="svg-icon">
              ${this.loadingActionIndex===e?"":r}
            </div>

            <div
              class="loader-container"
              ?hidden=${this.loadingActionIndex!==e}
            >
              <div class="circle-loader"></div>
            </div>
          </div>
        </button>`}return M`
      <div class="floating-menu">
        <div
          class="tool-buttons"
          ?has-loading-action=${this.loadingActionIndex!==null}
          @mouseenter=${e=>this.toolButtonGroupMouseEnterHandler(e)}
          @mouseleave=${e=>this.toolButtonGroupMouseLeaveHandler(e)}
        >
          ${n}
        </div>
        <button
          class="tool-button setting-button"
          @mousedown=${()=>this.settingButtonClicked()}
          @mouseenter=${e=>this.settingButtonMouseEnterHandler(e)}
          @mouseleave=${e=>this.toolButtonMouseLeaveHandler(e)}
        >
          <div class="svg-icon">${H(ay)}</div>
        </button>
      </div>
    `}};Xn.styles=[be`
      ${oe(sy)}
    `];ni([O({attribute:!1})],Xn.prototype,"popperTooltip",2);ni([O({type:Number})],Xn.prototype,"loadingActionIndex",2);ni([O({attribute:!1})],Xn.prototype,"favPrompts",2);Xn=ni([ve("wordflow-floating-menu")],Xn);function uy(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Po(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function dy(n){return n=Po(Math.abs(n)),n?n[1]:NaN}function py(n,e){return function(t,r){for(var o=t.length,i=[],s=0,a=n[0],l=0;o>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(t.substring(o-=a,o+a)),!((l+=a+1)>r));)a=n[s=(s+1)%n.length];return i.reverse().join(e)}}function hy(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var fy=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ys(n){if(!(e=fy.exec(n)))throw new Error("invalid format: "+n);var e;return new Gs({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ys.prototype=Gs.prototype;function Gs(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Gs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function my(n){e:for(var e=n.length,t=1,r=-1,o;t<e;++t)switch(n[t]){case".":r=o=t;break;case"0":r===0&&(r=t),o=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(o+1):n}var td;function gy(n,e){var t=Po(n,e);if(!t)return n+"";var r=t[0],o=t[1],i=o-(td=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,s=r.length;return i===s?r:i>s?r+new Array(i-s+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Po(n,Math.max(0,e+i-1))[0]}function Pl(n,e){var t=Po(n,e);if(!t)return n+"";var r=t[0],o=t[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}const Al={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:uy,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>Pl(n*100,e),r:Pl,s:gy,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function Ol(n){return n}var Il=Array.prototype.map,$l=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yy(n){var e=n.grouping===void 0||n.thousands===void 0?Ol:py(Il.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",o=n.decimal===void 0?".":n.decimal+"",i=n.numerals===void 0?Ol:hy(Il.call(n.numerals,String)),s=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"−":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function c(d){d=ys(d);var p=d.fill,h=d.align,f=d.sign,m=d.symbol,g=d.zero,y=d.width,b=d.comma,v=d.precision,k=d.trim,x=d.type;x==="n"?(b=!0,x="g"):Al[x]||(v===void 0&&(v=12),k=!0,x="g"),(g||p==="0"&&h==="=")&&(g=!0,p="0",h="=");var C=m==="$"?t:m==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",A=m==="$"?r:/[%p]/.test(x)?s:"",$=Al[x],E=/[defgprs%]/.test(x);v=v===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function z(S){var L=C,U=A,V,Se,pe;if(x==="c")U=$(S)+U,S="";else{S=+S;var xe=S<0||1/S<0;if(S=isNaN(S)?l:$(Math.abs(S),v),k&&(S=my(S)),xe&&+S==0&&f!=="+"&&(xe=!1),L=(xe?f==="("?f:a:f==="-"||f==="("?"":f)+L,U=(x==="s"?$l[8+td/3]:"")+U+(xe&&f==="("?")":""),E){for(V=-1,Se=S.length;++V<Se;)if(pe=S.charCodeAt(V),48>pe||pe>57){U=(pe===46?o+S.slice(V+1):S.slice(V))+U,S=S.slice(0,V);break}}}b&&!g&&(S=e(S,1/0));var kt=L.length+S.length+U.length,tt=kt<y?new Array(y-kt+1).join(p):"";switch(b&&g&&(S=e(tt+S,tt.length?y-U.length:1/0),tt=""),h){case"<":S=L+S+U+tt;break;case"=":S=L+tt+S+U;break;case"^":S=tt.slice(0,kt=tt.length>>1)+L+S+U+tt.slice(kt);break;default:S=tt+L+S+U;break}return i(S)}return z.toString=function(){return d+""},z}function u(d,p){var h=c((d=ys(d),d.type="f",d)),f=Math.max(-8,Math.min(8,Math.floor(dy(p)/3)))*3,m=Math.pow(10,-f),g=$l[8+f/3];return function(y){return h(m*y)+g}}return{format:c,formatPrefix:u}}var Qr,nd;by({thousands:",",grouping:[3],currency:["$",""]});function by(n){return Qr=yy(n),nd=Qr.format,Qr.formatPrefix,Qr}const _i=new Date,zi=new Date;function bt(n,e,t,r){function o(i){return n(i=arguments.length===0?new Date:new Date(+i)),i}return o.floor=i=>(n(i=new Date(+i)),i),o.ceil=i=>(n(i=new Date(i-1)),e(i,1),n(i),i),o.round=i=>{const s=o(i),a=o.ceil(i);return i-s<a-i?s:a},o.offset=(i,s)=>(e(i=new Date(+i),s==null?1:Math.floor(s)),i),o.range=(i,s,a)=>{const l=[];if(i=o.ceil(i),a=a==null?1:Math.floor(a),!(i<s)||!(a>0))return l;let c;do l.push(c=new Date(+i)),e(i,a),n(i);while(c<i&&i<s);return l},o.filter=i=>bt(s=>{if(s>=s)for(;n(s),!i(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;e(s,-1),!i(s););else for(;--a>=0;)for(;e(s,1),!i(s););}),t&&(o.count=(i,s)=>(_i.setTime(+i),zi.setTime(+s),n(_i),n(zi),Math.floor(t(_i,zi))),o.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?o.filter(r?s=>r(s)%i===0:s=>o.count(0,s)%i===0):o)),o}const vy=1e3,Ws=vy*60,Dy=Ws*60,Nr=Dy*24,rd=Nr*7,Ys=bt(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*Ws)/Nr,n=>n.getDate()-1);Ys.range;const Ks=bt(n=>{n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e)},(n,e)=>(e-n)/Nr,n=>n.getUTCDate()-1);Ks.range;const wy=bt(n=>{n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e)},(n,e)=>(e-n)/Nr,n=>Math.floor(n/Nr));wy.range;function En(n){return bt(e=>{e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ws)/rd)}const od=En(0),Ao=En(1),xy=En(2),Cy=En(3),Qn=En(4),ky=En(5),Ey=En(6);od.range;Ao.range;xy.range;Cy.range;Qn.range;ky.range;Ey.range;function Mn(n){return bt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/rd)}const id=Mn(0),Oo=Mn(1),My=Mn(2),Ty=Mn(3),er=Mn(4),Sy=Mn(5),Fy=Mn(6);id.range;Oo.range;My.range;Ty.range;er.range;Sy.range;Fy.range;const xn=bt(n=>{n.setMonth(0,1),n.setHours(0,0,0,0)},(n,e)=>{n.setFullYear(n.getFullYear()+e)},(n,e)=>e.getFullYear()-n.getFullYear(),n=>n.getFullYear());xn.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:bt(e=>{e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*n)});xn.range;const Cn=bt(n=>{n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCFullYear(n.getUTCFullYear()+e)},(n,e)=>e.getUTCFullYear()-n.getUTCFullYear(),n=>n.getUTCFullYear());Cn.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:bt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*n)});Cn.range;function Hi(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function ji(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function lr(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function Py(n){var e=n.dateTime,t=n.date,r=n.time,o=n.periods,i=n.days,s=n.shortDays,a=n.months,l=n.shortMonths,c=cr(o),u=ur(o),d=cr(i),p=ur(i),h=cr(s),f=ur(s),m=cr(a),g=ur(a),y=cr(l),b=ur(l),v={a:xe,A:kt,b:tt,B:md,c:null,d:zl,e:zl,f:Qy,g:cb,G:db,H:Jy,I:Zy,j:Xy,L:sd,m:eb,M:tb,p:gd,q:yd,Q:Ul,s:Vl,S:nb,u:rb,U:ob,V:ib,w:sb,W:ab,x:null,X:null,y:lb,Y:ub,Z:pb,"%":jl},k={a:bd,A:vd,b:Dd,B:wd,c:null,d:Hl,e:Hl,f:gb,g:Mb,G:Sb,H:hb,I:fb,j:mb,L:ld,m:yb,M:bb,p:xd,q:Cd,Q:Ul,s:Vl,S:vb,u:Db,U:wb,V:xb,w:Cb,W:kb,x:null,X:null,y:Eb,Y:Tb,Z:Fb,"%":jl},x={a:z,A:S,b:L,B:U,c:V,d:Bl,e:Bl,f:Wy,g:Rl,G:Ll,H:_l,I:_l,j:jy,L:Gy,m:Hy,M:Uy,p:E,q:zy,Q:Ky,s:qy,S:Vy,u:Ny,U:Ly,V:Ry,w:$y,W:By,x:Se,X:pe,y:Rl,Y:Ll,Z:_y,"%":Yy};v.x=C(t,v),v.X=C(r,v),v.c=C(e,v),k.x=C(t,k),k.X=C(r,k),k.c=C(e,k);function C(P,j){return function(G){var w=[],Le=-1,q=0,ze=P.length,He,Qt,Zs;for(G instanceof Date||(G=new Date(+G));++Le<ze;)P.charCodeAt(Le)===37&&(w.push(P.slice(q,Le)),(Qt=Nl[He=P.charAt(++Le)])!=null?He=P.charAt(++Le):Qt=He==="e"?" ":"0",(Zs=j[He])&&(He=Zs(G,Qt)),w.push(He),q=Le+1);return w.push(P.slice(q,Le)),w.join("")}}function A(P,j){return function(G){var w=lr(1900,void 0,1),Le=$(w,P,G+="",0),q,ze;if(Le!=G.length)return null;if("Q"in w)return new Date(w.Q);if("s"in w)return new Date(w.s*1e3+("L"in w?w.L:0));if(j&&!("Z"in w)&&(w.Z=0),"p"in w&&(w.H=w.H%12+w.p*12),w.m===void 0&&(w.m="q"in w?w.q:0),"V"in w){if(w.V<1||w.V>53)return null;"w"in w||(w.w=1),"Z"in w?(q=ji(lr(w.y,0,1)),ze=q.getUTCDay(),q=ze>4||ze===0?Oo.ceil(q):Oo(q),q=Ks.offset(q,(w.V-1)*7),w.y=q.getUTCFullYear(),w.m=q.getUTCMonth(),w.d=q.getUTCDate()+(w.w+6)%7):(q=Hi(lr(w.y,0,1)),ze=q.getDay(),q=ze>4||ze===0?Ao.ceil(q):Ao(q),q=Ys.offset(q,(w.V-1)*7),w.y=q.getFullYear(),w.m=q.getMonth(),w.d=q.getDate()+(w.w+6)%7)}else("W"in w||"U"in w)&&("w"in w||(w.w="u"in w?w.u%7:"W"in w?1:0),ze="Z"in w?ji(lr(w.y,0,1)).getUTCDay():Hi(lr(w.y,0,1)).getDay(),w.m=0,w.d="W"in w?(w.w+6)%7+w.W*7-(ze+5)%7:w.w+w.U*7-(ze+6)%7);return"Z"in w?(w.H+=w.Z/100|0,w.M+=w.Z%100,ji(w)):Hi(w)}}function $(P,j,G,w){for(var Le=0,q=j.length,ze=G.length,He,Qt;Le<q;){if(w>=ze)return-1;if(He=j.charCodeAt(Le++),He===37){if(He=j.charAt(Le++),Qt=x[He in Nl?j.charAt(Le++):He],!Qt||(w=Qt(P,G,w))<0)return-1}else if(He!=G.charCodeAt(w++))return-1}return w}function E(P,j,G){var w=c.exec(j.slice(G));return w?(P.p=u.get(w[0].toLowerCase()),G+w[0].length):-1}function z(P,j,G){var w=h.exec(j.slice(G));return w?(P.w=f.get(w[0].toLowerCase()),G+w[0].length):-1}function S(P,j,G){var w=d.exec(j.slice(G));return w?(P.w=p.get(w[0].toLowerCase()),G+w[0].length):-1}function L(P,j,G){var w=y.exec(j.slice(G));return w?(P.m=b.get(w[0].toLowerCase()),G+w[0].length):-1}function U(P,j,G){var w=m.exec(j.slice(G));return w?(P.m=g.get(w[0].toLowerCase()),G+w[0].length):-1}function V(P,j,G){return $(P,e,j,G)}function Se(P,j,G){return $(P,t,j,G)}function pe(P,j,G){return $(P,r,j,G)}function xe(P){return s[P.getDay()]}function kt(P){return i[P.getDay()]}function tt(P){return l[P.getMonth()]}function md(P){return a[P.getMonth()]}function gd(P){return o[+(P.getHours()>=12)]}function yd(P){return 1+~~(P.getMonth()/3)}function bd(P){return s[P.getUTCDay()]}function vd(P){return i[P.getUTCDay()]}function Dd(P){return l[P.getUTCMonth()]}function wd(P){return a[P.getUTCMonth()]}function xd(P){return o[+(P.getUTCHours()>=12)]}function Cd(P){return 1+~~(P.getUTCMonth()/3)}return{format:function(P){var j=C(P+="",v);return j.toString=function(){return P},j},parse:function(P){var j=A(P+="",!1);return j.toString=function(){return P},j},utcFormat:function(P){var j=C(P+="",k);return j.toString=function(){return P},j},utcParse:function(P){var j=A(P+="",!0);return j.toString=function(){return P},j}}}var Nl={"-":"",_:" ",0:"0"},de=/^\s*\d+/,Ay=/^%/,Oy=/[\\^$*+?|[\]().{}]/g;function W(n,e,t){var r=n<0?"-":"",o=(r?-n:n)+"",i=o.length;return r+(i<t?new Array(t-i+1).join(e)+o:o)}function Iy(n){return n.replace(Oy,"\\$&")}function cr(n){return new RegExp("^(?:"+n.map(Iy).join("|")+")","i")}function ur(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function $y(n,e,t){var r=de.exec(e.slice(t,t+1));return r?(n.w=+r[0],t+r[0].length):-1}function Ny(n,e,t){var r=de.exec(e.slice(t,t+1));return r?(n.u=+r[0],t+r[0].length):-1}function Ly(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.U=+r[0],t+r[0].length):-1}function Ry(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.V=+r[0],t+r[0].length):-1}function By(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.W=+r[0],t+r[0].length):-1}function Ll(n,e,t){var r=de.exec(e.slice(t,t+4));return r?(n.y=+r[0],t+r[0].length):-1}function Rl(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.y=+r[0]+(+r[0]>68?1900:2e3),t+r[0].length):-1}function _y(n,e,t){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return r?(n.Z=r[1]?0:-(r[2]+(r[3]||"00")),t+r[0].length):-1}function zy(n,e,t){var r=de.exec(e.slice(t,t+1));return r?(n.q=r[0]*3-3,t+r[0].length):-1}function Hy(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.m=r[0]-1,t+r[0].length):-1}function Bl(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.d=+r[0],t+r[0].length):-1}function jy(n,e,t){var r=de.exec(e.slice(t,t+3));return r?(n.m=0,n.d=+r[0],t+r[0].length):-1}function _l(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.H=+r[0],t+r[0].length):-1}function Uy(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.M=+r[0],t+r[0].length):-1}function Vy(n,e,t){var r=de.exec(e.slice(t,t+2));return r?(n.S=+r[0],t+r[0].length):-1}function Gy(n,e,t){var r=de.exec(e.slice(t,t+3));return r?(n.L=+r[0],t+r[0].length):-1}function Wy(n,e,t){var r=de.exec(e.slice(t,t+6));return r?(n.L=Math.floor(r[0]/1e3),t+r[0].length):-1}function Yy(n,e,t){var r=Ay.exec(e.slice(t,t+1));return r?t+r[0].length:-1}function Ky(n,e,t){var r=de.exec(e.slice(t));return r?(n.Q=+r[0],t+r[0].length):-1}function qy(n,e,t){var r=de.exec(e.slice(t));return r?(n.s=+r[0],t+r[0].length):-1}function zl(n,e){return W(n.getDate(),e,2)}function Jy(n,e){return W(n.getHours(),e,2)}function Zy(n,e){return W(n.getHours()%12||12,e,2)}function Xy(n,e){return W(1+Ys.count(xn(n),n),e,3)}function sd(n,e){return W(n.getMilliseconds(),e,3)}function Qy(n,e){return sd(n,e)+"000"}function eb(n,e){return W(n.getMonth()+1,e,2)}function tb(n,e){return W(n.getMinutes(),e,2)}function nb(n,e){return W(n.getSeconds(),e,2)}function rb(n){var e=n.getDay();return e===0?7:e}function ob(n,e){return W(od.count(xn(n)-1,n),e,2)}function ad(n){var e=n.getDay();return e>=4||e===0?Qn(n):Qn.ceil(n)}function ib(n,e){return n=ad(n),W(Qn.count(xn(n),n)+(xn(n).getDay()===4),e,2)}function sb(n){return n.getDay()}function ab(n,e){return W(Ao.count(xn(n)-1,n),e,2)}function lb(n,e){return W(n.getFullYear()%100,e,2)}function cb(n,e){return n=ad(n),W(n.getFullYear()%100,e,2)}function ub(n,e){return W(n.getFullYear()%1e4,e,4)}function db(n,e){var t=n.getDay();return n=t>=4||t===0?Qn(n):Qn.ceil(n),W(n.getFullYear()%1e4,e,4)}function pb(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+W(e/60|0,"0",2)+W(e%60,"0",2)}function Hl(n,e){return W(n.getUTCDate(),e,2)}function hb(n,e){return W(n.getUTCHours(),e,2)}function fb(n,e){return W(n.getUTCHours()%12||12,e,2)}function mb(n,e){return W(1+Ks.count(Cn(n),n),e,3)}function ld(n,e){return W(n.getUTCMilliseconds(),e,3)}function gb(n,e){return ld(n,e)+"000"}function yb(n,e){return W(n.getUTCMonth()+1,e,2)}function bb(n,e){return W(n.getUTCMinutes(),e,2)}function vb(n,e){return W(n.getUTCSeconds(),e,2)}function Db(n){var e=n.getUTCDay();return e===0?7:e}function wb(n,e){return W(id.count(Cn(n)-1,n),e,2)}function cd(n){var e=n.getUTCDay();return e>=4||e===0?er(n):er.ceil(n)}function xb(n,e){return n=cd(n),W(er.count(Cn(n),n)+(Cn(n).getUTCDay()===4),e,2)}function Cb(n){return n.getUTCDay()}function kb(n,e){return W(Oo.count(Cn(n)-1,n),e,2)}function Eb(n,e){return W(n.getUTCFullYear()%100,e,2)}function Mb(n,e){return n=cd(n),W(n.getUTCFullYear()%100,e,2)}function Tb(n,e){return W(n.getUTCFullYear()%1e4,e,4)}function Sb(n,e){var t=n.getUTCDay();return n=t>=4||t===0?er(n):er.ceil(n),W(n.getUTCFullYear()%1e4,e,4)}function Fb(){return"+0000"}function jl(){return"%"}function Ul(n){return+n}function Vl(n){return Math.floor(+n/1e3)}var An,ud,qs,dd;Pb({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Pb(n){return An=Py(n),ud=An.format,An.parse,qs=An.utcFormat,dd=An.utcParse,An}var pd="%Y-%m-%dT%H:%M:%S.%LZ";function Ab(n){return n.toISOString()}Date.prototype.toISOString||qs(pd);function Ob(n){var e=new Date(n);return isNaN(e)?null:e}var Ib=+new Date("2000-01-01T00:00:00.000Z")?Ob:dd(pd);const $b=Ib,ct={format:nd,timeFormat:ud,utcFormat:qs,isoParse:$b},Nb=`.tag{display:flex;line-height:1;font-size:var(--font-d2);padding:4px 6px;background-color:var(--blue-50);color:var(--blue-900);border-radius:5px;white-space:nowrap;height:var(--font-d2);cursor:pointer;user-select:none;-webkit-user-select:none}.tag:hover{background-color:color-mix(in lab,var(--blue-100),white 30%)}.tag:active,.tag[is-selected]{background-color:color-mix(in lab,var(--blue-100),white 2%)}.tag.expand-tag{background-color:color-mix(in lab,var(--gray-200),white 20%);color:var(--gray-800);display:flex;flex-flow:row;align-items:center}.tag.expand-tag:hover{background-color:color-mix(in lab,var(--gray-300),white 30%)}.tag.expand-tag .svg-icon{position:relative;top:1px;margin-right:3px;color:var(--gray-700);width:1em;height:1em}.tag.show-cross .svg-icon{top:1px;position:relative;width:8px;height:8px;margin:auto auto auto 4px}.prompt-card{--padding-h: 16px;--padding-v: 16px;width:100%;height:100%;display:flex;flex-flow:column;justify-content:flex-start;align-items:flex-start;gap:5px;padding:var(--padding-v) var(--padding-h);box-sizing:border-box;border:1px solid var(--gray-300);border-radius:10px;font-size:var(--font-d2);user-select:none;-webkit-user-select:none;transition:box-shadow linear .1s,transform linear .1s;transform-origin:center;background-color:#fff;overflow:hidden}.header{width:100%;display:flex;flex-flow:row nowrap;align-items:center;gap:5px;font-size:var(--font-d1);overflow:hidden}.header .icon{display:flex;width:28px;height:28px;justify-content:center;align-items:center;vertical-align:middle;text-align:center;transform-origin:center center 0px;border-radius:100%;border:1px solid var(--gray-300);position:relative;box-sizing:border-box;transition:box-shadow linear .1s}.header .icon span{font-size:34px;transform:scale(.5);color:var(--gray-700);font-weight:700;line-height:1}.header .name-wrapper{display:flex;flex-flow:row nowrap;overflow:hidden}.header .name-wrapper .name{font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.prompt{display:-webkit-box;line-height:1.25;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;margin-bottom:3px;flex:1 1 auto}.tag-list{display:flex;flex-flow:row wrap;gap:7px}.footer{width:100%;font-size:var(--font-d2);color:var(--gray-700);display:flex;flex-flow:row nowrap;white-space:nowrap;align-items:center;justify-content:space-between;gap:10px}.footer .share-info{display:flex;flex-flow:row nowrap;align-items:stretch;gap:5px;overflow:hidden}.footer .share-info .separator{width:1px;border-radius:1px;transform:scaleY(.6);transform-origin:center;background-color:var(--gray-400)}.footer .share-info .name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.prompt-card[is-local]{gap:2px}.prompt-card[is-local] .prompt{margin:0}
`;var Lb=Object.defineProperty,Rb=Object.getOwnPropertyDescriptor,ri=(n,e,t,r)=>{for(var o=r>1?void 0:r?Rb(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Lb(e,t,o),o};let tr=class extends Q{constructor(){super(),this.isLocalPrompt=!1,this.curSelectedTag="",this.promptData=ii()}willUpdate(n){}async initData(){}tagClicked(n,e){n.preventDefault(),n.stopPropagation();const t=new CustomEvent("tag-clicked",{detail:e,bubbles:!0,composed:!0});this.dispatchEvent(t)}render(){let n=M``;if(this.promptData.tags!==void 0&&!this.isLocalPrompt)for(const l of this.promptData.tags)n=M`${n}
            <span
              class="tag"
              ?is-selected=${this.curSelectedTag===l}
              @click=${c=>this.tagClicked(c,l)}
              >${l}</span
            >`;const e=ct.format(",");let t=ct.timeFormat("%b %d, %Y");const r=ct.timeFormat("%b %d, %Y %H:%M"),o=ct.isoParse(this.promptData.created),i=new Date;o.getFullYear==i.getFullYear&&(t=ct.timeFormat("%b %d"));const s=this.promptData.userName===""?"Anonymous":this.promptData.userName;let a=M``;return this.isLocalPrompt||(a=M`
        <span class="name" title=${s||""}>${s}</span>
        <span class="separator"></span>
      `),M`
      <div class="prompt-card" ?is-local=${this.isLocalPrompt}>
        <div class="header">
          <span class="icon"><span>${this.promptData.icon}</span></span>
          <span class="name-wrapper">
            <span class="name" title=${this.promptData.title}
              >${this.promptData.title}</span
            >
          </span>
        </div>

        <div class="prompt">${this.promptData.prompt}</div>

        <div class="tag-list">${n}</div>

        <div class="footer">
          <span class="run-count"
            >${e(this.promptData.promptRunCount)} runs</span
          >
          <span class="share-info">
            ${a}
            <span class="date" title=${r(o)}
              >${t(o)}</span
            >
          </span>
        </div>
      </div>
    `}};tr.styles=[be`
      ${oe(Nb)}
    `];ri([O({attribute:!1})],tr.prototype,"promptData",2);ri([O({type:Boolean})],tr.prototype,"isLocalPrompt",2);ri([O({type:String})],tr.prototype,"curSelectedTag",2);tr=ri([ve("wordflow-prompt-card")],tr);const Bb=`.pagination{width:100%;height:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;box-sizing:border-box;gap:7px}button{all:unset;font-size:var(--font-d2);padding:0 8px;border:1px solid var(--gray-400);border-radius:5px;cursor:pointer}button:hover{background-color:color-mix(in lab,var(--gray-200) 100%,white 90%)}button[is-cur-page]{background-color:var(--gray-200)}
`;var _b=Object.defineProperty,zb=Object.getOwnPropertyDescriptor,oi=(n,e,t,r)=>{for(var o=r>1?void 0:r?zb(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&_b(e,t,o),o};let nr=class extends Q{constructor(){super(),this.curPage=1,this.totalPageNum=10,this.pageWindowSize=5,this.getPageButtonTemplate=n=>M` <button
      class="page-button"
      ?is-cur-page=${this.curPage===parseInt(n)}
      @click=${()=>this.pageButtonClicked(n)}
    >
      ${n}
    </button>`}willUpdate(n){}async initData(){}pageButtonClicked(n){let e=this.curPage;if(n==="Prev")this.curPage>1&&(e-=1);else if(n==="Next")this.curPage<this.totalPageNum&&(e+=1);else{const r=parseInt(n);this.curPage!==r&&(e=r)}const t=new CustomEvent("page-clicked",{detail:e,bubbles:!0,composed:!0});this.dispatchEvent(t)}render(){let n=M``;if(this.totalPageNum<=this.pageWindowSize)for(let e=0;e<Math.max(this.totalPageNum,1);e++)n=M`${n}
        ${this.getPageButtonTemplate(`${e+1}`)}`;else{const e=Math.floor((this.pageWindowSize-1)/2);let t=this.curPage-e,r=this.curPage+e;t<1?(t=1,r=this.pageWindowSize):r>this.totalPageNum&&(t=this.totalPageNum-this.pageWindowSize+1,r=this.totalPageNum),this.curPage>1&&(n=M`${n} ${this.getPageButtonTemplate("Prev")} `),t>1&&(n=M`${n} ${this.getPageButtonTemplate("1")}`,t>2&&(n=M`${n} <span>...</span>`));for(let o=t;o<r+1;o++)n=M`${n}
        ${this.getPageButtonTemplate(o.toString())} `;r<this.totalPageNum&&(r<this.totalPageNum-1&&(n=M`${n}<span>...</span>`),n=M`${n}
        ${this.getPageButtonTemplate(this.totalPageNum.toString())}`),this.curPage<this.totalPageNum&&(n=M`${n} ${this.getPageButtonTemplate("Next")} `)}return M` <div class="pagination">${n}</div> `}};nr.styles=[be`
      ${oe(Bb)}
    `];oi([O({type:Number})],nr.prototype,"curPage",2);oi([O({type:Number})],nr.prototype,"totalPageNum",2);oi([O({type:Number})],nr.prototype,"pageWindowSize",2);nr=oi([ve("nightjar-pagination")],nr);const Hb=`.tag{display:flex;line-height:1;font-size:var(--font-d2);padding:4px 6px;background-color:var(--blue-50);color:var(--blue-900);border-radius:5px;white-space:nowrap;height:var(--font-d2);cursor:pointer;user-select:none;-webkit-user-select:none}.tag:hover{background-color:color-mix(in lab,var(--blue-100),white 30%)}.tag:active,.tag[is-selected]{background-color:color-mix(in lab,var(--blue-100),white 2%)}.tag.expand-tag{background-color:color-mix(in lab,var(--gray-200),white 20%);color:var(--gray-800);display:flex;flex-flow:row;align-items:center}.tag.expand-tag:hover{background-color:color-mix(in lab,var(--gray-300),white 30%)}.tag.expand-tag .svg-icon{position:relative;top:1px;margin-right:3px;color:var(--gray-700);width:1em;height:1em}.tag.show-cross .svg-icon{top:1px;position:relative;width:8px;height:8px;margin:auto auto auto 4px}@keyframes scale-up{0%{transform:scale(.2)}to{transform:scale(1)}}a{color:var(--blue-800)}button{all:unset}.prompt-viewer{--padding-h: 20px;--padding-v: 16px;width:100%;height:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;box-sizing:border-box;font-size:var(--font-d2)}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.prompt-window{display:flex;flex-flow:column;background-color:#fff;border-radius:10px;box-shadow:0 0 1px #00000026,0 0 5px #00000026,0 0 20px #00000026;animation:scale-up .1s;width:460px;max-height:420px;position:relative}.header{padding:var(--padding-v) var(--padding-h) 10px var(--padding-h);display:flex;flex-flow:column;align-items:flex-start;gap:5px;border-bottom:1px solid var(--gray-300);user-select:none;-webkit-user-select:none}.info-bar{display:flex;flex-flow:row nowrap;align-items:stretch;gap:10px;flex:1 0 auto;max-width:100%;white-space:nowrap}.info-bar .separator{width:1px;border-radius:1px;transform:scaleY(.7);transform-origin:center;background-color:var(--gray-500)}.info-bar .user-name-wrapper{display:flex;flex-flow:row nowrap;overflow:hidden}.info-bar .user-name{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.title-bar{box-sizing:border-box;display:flex;align-items:flex-start;gap:5px;font-size:var(--font-d1);width:100%}.title-bar .svg-icon{z-index:1;margin-left:auto;width:23px;height:23px;flex-shrink:0;padding:5px;box-sizing:border-box;position:relative;cursor:pointer;color:var(--gray-600);transition:color .1s}.title-bar .svg-icon:before{z-index:-1;content:"";position:absolute;top:50%;left:50%;transform-origin:center;transform:translate(-50%,-50%) scale(0);border-radius:50%;background-color:var(--gray-100);width:100%;height:100%;transition:transform .1s}.title-bar .svg-icon:hover{color:var(--gray-700)}.title-bar .svg-icon:hover:before{transform:translate(-50%,-50%) scale(1.4)}.title-bar .svg-icon:active:before{transform:translate(-50%,-50%) scale(1.6)}.title-bar .icon{display:flex;width:28px;height:28px;justify-content:center;align-items:center;vertical-align:middle;text-align:center;transform-origin:center center 0px;border-radius:100%;border:1px solid var(--gray-400);position:relative;box-sizing:border-box;transition:box-shadow linear .1s}.title-bar .icon span{font-size:34px;transform:scale(.5);color:var(--gray-700);font-weight:700;line-height:1}.title-bar .name{font-weight:800;position:relative;top:2px}.content{padding:10px var(--padding-h) var(--padding-v) var(--padding-h);display:flex;flex-flow:column;gap:12px;overflow-y:auto}.footer{padding:10px var(--padding-h) var(--padding-v) var(--padding-h)}.content-block{display:flex;flex-flow:column;align-items:flex-start}.content-block .name{font-weight:800}.content-block .content-text{line-height:1.25}.content-block .tag-list{margin-top:2px;display:flex;flex-flow:row wrap;gap:7px}.content-block .tag{pointer-events:none}.info-table{display:grid;width:100%;grid-template-columns:auto 30px 1fr;font-size:var(--font-d3);color:var(--gray-600)}.add-button{flex:0 1 auto;line-height:1;display:flex;align-items:center;padding:1px 12px;background-color:var(--green-600);color:#fff;border-radius:3px;cursor:pointer}.add-button:hover{background-color:color-mix(in lab,var(--green-600),white 7%)}.add-button:active{background-color:color-mix(in lab,var(--green-600),white 0%)}
`;var jb=Object.defineProperty,Ub=Object.getOwnPropertyDescriptor,Js=(n,e,t,r)=>{for(var o=r>1?void 0:r?Ub(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&jb(e,t,o),o};let Lr=class extends Q{constructor(){super(),this.curSelectedTag="",this.promptData=ii()}willUpdate(n){}async initData(){}tagClicked(n,e){n.preventDefault(),n.stopPropagation()}closeButtonClicked(){if(this.shadowRoot===null)throw Error("shadowRoot is null");const n=new Event("close-clicked",{bubbles:!0,composed:!0});this.dispatchEvent(n)}promptEditorBackgroundClicked(n){n.target.classList.contains("prompt-viewer")&&this.closeButtonClicked()}addButtonClicked(){const n=new CustomEvent("add-clicked",{bubbles:!0,composed:!0,detail:this.promptData});this.dispatchEvent(n),this.closeButtonClicked()}getInfoPairs(){const n=[];if(n.push({key:"Injection mode",value:this.promptData.injectionMode}),this.promptData.recommendedModels.length>0){const e=this.promptData.recommendedModels.join(", ");n.push({key:"Models",value:e})}return this.promptData.outputParsingPattern!==""&&n.push({key:"Output pattern",value:this.promptData.outputParsingPattern}),this.promptData.outputParsingReplacement!==""&&n.push({key:"Output replacement",value:this.promptData.outputParsingReplacement}),n}render(){const n=ct.format(",");let e=ct.timeFormat("%b %d, %Y");const t=ct.timeFormat("%b %d, %Y %H:%M"),r=ct.isoParse(this.promptData.created),o=new Date;r.getFullYear==o.getFullYear&&(e=ct.timeFormat("%b %d"));const i=this.promptData.userName===""?"Anonymous":this.promptData.userName;let s=M``;for(const c of this.promptData.tags)s=M`${s}
        <span
          class="tag"
          ?is-selected=${this.curSelectedTag===c}
          @click=${u=>this.tagClicked(u,c)}
          >${c}</span
        >`;const a=this.getInfoPairs();let l=M``;for(const c of a)l=M`${l}
        <span class="key">${c.key}</span>
        <span></span>
        <span class="value">${c.value}</span> `;return l=M`${l}
      <span class="key">Report</span>
      <span></span>
      <span class="value"
        ><a href="mailto:jayw@gatech.edu">Report a concern</a></span
      > `,M`
      <div
        class="prompt-viewer"
        @click=${c=>this.promptEditorBackgroundClicked(c)}
      >
        <div class="prompt-window">
          <div class="header">
            <div class="title-bar">
              <span class="icon"><span>${this.promptData.icon}</span></span>
              <span class="name">${this.promptData.title}</span>
              <button
                class="svg-icon"
                @click=${()=>this.closeButtonClicked()}
              >
                ${H(ir)}
              </button>
            </div>

            <div class="info-bar">
              <span class="user-name-wrapper">
                <span class="user-name" title=${i}>${i}</span>
              </span>
              <div class="separator"></div>

              <span class="date" title=${t(r)}
                >${e(r)}</span
              >
              <div class="separator"></div>

              <span class="run-info"
                >${n(this.promptData.promptRunCount)} runs</span
              >

              <button
                class="add-button"
                @click=${()=>{this.addButtonClicked()}}
              >
                Add
              </button>
            </div>
          </div>

          <div class="content">
            <section class="content-block">
              <div class="name">Description</div>
              <div class="content-text">${this.promptData.description}</div>
            </section>

            <section class="content-block">
              <div class="name">Prompt</div>
              <div class="content-text">${this.promptData.prompt}</div>
            </section>

            <section class="content-block">
              <div class="name">Tags</div>
              <div class="tag-list">${s}</div>
            </section>

            <section class="content-block">
              <div class="name">More Info</div>
              <div class="info-table">${l}</div>
            </section>
          </div>
        </div>
      </div>
    `}};Lr.styles=[be`
      ${oe(Hb)}
    `];Js([O({attribute:!1})],Lr.prototype,"promptData",2);Js([O({type:String})],Lr.prototype,"curSelectedTag",2);Lr=Js([ve("wordflow-prompt-viewer")],Lr);const Vb=`.tag{display:flex;line-height:1;font-size:var(--font-d2);padding:4px 6px;background-color:var(--blue-50);color:var(--blue-900);border-radius:5px;white-space:nowrap;height:var(--font-d2);cursor:pointer;user-select:none;-webkit-user-select:none}.tag:hover{background-color:color-mix(in lab,var(--blue-100),white 30%)}.tag:active,.tag[is-selected]{background-color:color-mix(in lab,var(--blue-100),white 2%)}.tag.expand-tag{background-color:color-mix(in lab,var(--gray-200),white 20%);color:var(--gray-800);display:flex;flex-flow:row;align-items:center}.tag.expand-tag:hover{background-color:color-mix(in lab,var(--gray-300),white 30%)}.tag.expand-tag .svg-icon{position:relative;top:1px;margin-right:3px;color:var(--gray-700);width:1em;height:1em}.tag.show-cross .svg-icon{top:1px;position:relative;width:8px;height:8px;margin:auto auto auto 4px}.panel-community{--padding-h: 20px;--padding-v: 12px;width:100%;height:100%;display:flex;flex-flow:column;justify-content:flex-start;align-items:flex-start;box-sizing:border-box;background-color:#fff}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.header{padding:var(--padding-v) var(--padding-h) var(--padding-v) var(--padding-h);display:flex;flex-flow:column;width:100%;border-bottom:1px solid var(--gray-300);gap:12px;box-sizing:border-box}.header .header-top{width:100%;display:flex;align-items:center;flex-flow:row;font-size:var(--font-u2);line-height:1;gap:16px}.header .header-top .title{display:flex;flex-flow:row;gap:10px}.header .header-top .filter{display:flex;flex-flow:row;align-items:baseline;gap:5px;flex-grow:0}.header .header-top .filter[is-hidden]{display:none}.header .header-top .name{font-weight:800}.header .header-bottom{width:100%;display:flex;flex-flow:row;align-items:flex-start;gap:1em;line-height:1}.header-toggle{--border-color: var(--gray-400);flex:0 0 auto;display:flex;flex-flow:row;border:1px solid var(--border-color);border-radius:5px;font-size:var(--font-d2);cursor:pointer;user-select:none;-webkit-user-select:none}.header-toggle span{display:flex;align-items:center;padding:3px 8px 5px}.header-toggle span:first-child{border-right:1px solid var(--border-color);border-top-left-radius:5px;border-bottom-left-radius:5px}.header-toggle span:last-child{border-top-right-radius:5px;border-bottom-right-radius:5px}.header-toggle span:hover{background-color:color-mix(in lab,var(--gray-200) 100%,white 90%)}.header-toggle span[is-active]{background-color:var(--gray-200)}.header-tag-list{flex:1 1 auto;display:flex;flex-flow:row;align-items:flex-start;gap:5px;font-size:var(--font-d2)}.header-tag-list .name{flex:0 0 auto;margin-right:2px;padding:3px 0 0}.popular-tags{flex:1 1 auto;display:flex;flex-flow:row wrap;align-items:center;gap:7px}.prompt-content{width:100%;height:100%;overflow-y:auto;display:flex;flex-flow:column;align-items:center;position:relative}.prompt-content.no-scroll{overflow-y:hidden}.prompt-container{padding:var(--padding-v) var(--padding-h);display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr);gap:16px;width:100%;box-sizing:border-box}.pagination{padding:var(--padding-v) var(--padding-h);margin-bottom:var(--padding-v);display:flex;justify-content:center}.pagination[no-show]{nightjar-pagination {display: none;} margin-bottom: 0}.prompt-modal{width:100%;height:100%;position:absolute;background-color:#ffffffbf}.prompt-modal.hidden{display:none}wordflow-prompt-card{cursor:pointer;border-radius:10px}wordflow-prompt-card:hover{box-shadow:0 0 10px #0000000d,0 0 4px #0000000d}@keyframes circle-loader-animation{to{transform:rotate(1turn)}}.prompt-loader{position:absolute;width:100%;height:100%;pointer-events:all;background-color:#ffffffe6;z-index:2;opacity:1;transition:opacity .15s}.prompt-loader.no-display{display:none}.prompt-loader.hidden,.prompt-loader[is-hidden]{opacity:0;pointer-events:none}.prompt-loader .circle-loader{width:12px;height:12px;border:3px solid}.loader-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:row;gap:10px;align-items:center;white-space:nowrap;color:var(--gray-700);line-height:1;font-size:var(--font-u2)}.loader-container .circle-loader{width:12px;height:12px;border-radius:50%;border:3px solid;border-color:color-mix(in lab,var(--gray-400) 100%,white 30%);border-right-color:var(--gray-600);animation:circle-loader-animation 1s infinite linear}
`,Gl=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-more-circle">
        <path d="M40.047,79.547C61.58,79.547 79.5,61.676 79.5,40.143C79.5,18.609 61.531,0.738 39.998,0.738C18.514,0.738 0.643,18.609 0.643,40.143C0.643,61.676 18.562,79.547 40.047,79.547ZM40.047,72.125C22.322,72.125 8.162,57.916 8.162,40.143C8.162,22.369 22.273,8.16 39.998,8.16C57.771,8.16 72.029,22.369 72.029,40.143C72.029,57.916 57.82,72.125 40.047,72.125Z" style="fill-rule:nonzero;"/>
        <path d="M22.029,45.904C25.203,45.904 27.84,43.316 27.84,40.143C27.84,36.969 25.203,34.332 22.029,34.332C18.855,34.332 16.267,36.969 16.267,40.143C16.267,43.316 18.855,45.904 22.029,45.904Z" style="fill-rule:nonzero;"/>
        <path d="M39.998,45.904C43.221,45.904 45.809,43.316 45.809,40.143C45.809,36.969 43.221,34.332 39.998,34.332C36.824,34.332 34.236,36.969 34.236,40.143C34.236,43.316 36.824,45.904 39.998,45.904Z" style="fill-rule:nonzero;"/>
        <path d="M58.016,45.904C61.189,45.904 63.777,43.316 63.777,40.143C63.777,36.969 61.189,34.332 58.016,34.332C54.793,34.332 52.205,36.969 52.205,40.143C52.205,43.316 54.793,45.904 58.016,45.904Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,Wl=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 84 97" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-shrink">
        <path d="M11.302,61.049L72.386,61.049C78.929,61.049 83.372,56.654 83.372,50.648L83.372,46.303C83.372,40.346 78.929,35.902 72.386,35.902L11.302,35.902C4.808,35.902 0.316,40.346 0.316,46.303L0.316,50.648C0.316,56.654 4.808,61.049 11.302,61.049ZM12.327,54.457C9.105,54.457 7.249,52.406 7.249,49.574L7.249,47.426C7.249,44.594 9.105,42.494 12.327,42.494L71.409,42.494C74.583,42.494 76.439,44.594 76.439,47.426L76.439,49.574C76.439,52.406 74.583,54.457 71.409,54.457L12.327,54.457Z" style="fill-rule:nonzero;"/>
        <path d="M41.868,96.547C43.724,96.547 45.335,94.984 45.335,93.129L45.335,81.215L45.042,75.258L47.288,77.65L52.464,82.777C53.099,83.461 53.978,83.852 54.808,83.852C56.663,83.852 57.982,82.582 57.982,80.775C57.982,79.799 57.64,79.066 56.956,78.432L44.407,66.908C43.431,66.078 42.747,65.736 41.868,65.736C40.941,65.736 40.257,66.078 39.329,66.908L26.781,78.432C26.048,79.066 25.706,79.799 25.706,80.775C25.706,82.582 27.025,83.852 28.88,83.852C29.71,83.852 30.589,83.461 31.273,82.777L36.4,77.65L38.646,75.258L38.402,81.215L38.402,93.129C38.402,94.984 39.964,96.547 41.868,96.547ZM41.868,31.264C42.747,31.264 43.431,30.922 44.407,30.092L56.956,18.52C57.64,17.934 57.982,17.152 57.982,16.225C57.982,14.418 56.663,13.148 54.808,13.148C53.978,13.148 53.099,13.539 52.464,14.174L47.288,19.35L45.042,21.742L45.335,15.736L45.335,3.822C45.335,2.016 43.724,0.453 41.868,0.453C39.964,0.453 38.402,2.016 38.402,3.822L38.402,15.736L38.646,21.742L36.4,19.35L31.273,14.174C30.589,13.539 29.71,13.148 28.88,13.148C27.025,13.148 25.706,14.418 25.706,16.225C25.706,17.152 26.048,17.934 26.781,18.52L39.329,30.092C40.257,30.922 40.941,31.264 41.868,31.264Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`;var Gb=Object.defineProperty,Wb=Object.getOwnPropertyDescriptor,Te=(n,e,t,r)=>{for(var o=r>1?void 0:r?Wb(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Gb(e,t,o),o};const eo=18,Yb=4,Yl=30,Kl=ws;let ue=class extends Q{constructor(){super(),this.remotePrompts=Kl,this.popularTags=[],this["is-shown"]=!1,this.selectedPrompt=Kl[0],this.curMode="popular",this.maxTagsOneLine=3,this.isPopularTagListExpanded=!1,this.curSelectedTag="",this.curPage=1,this.isWaitingForQueryResponse=!1}willUpdate(n){n.has("is-shown")&&this["is-shown"]&&this.popularTags.length>0&&this.updateMaxTagsOneLine()}firstUpdated(){}async initData(){}async updateMaxTagsOneLine(){const n=await this.popularTagsElementPromise;if(!this.panelElement)throw Error("A queried element is not initialized.");const e=n.getBoundingClientRect(),t=document.createElement("div");this.panelElement.appendChild(t),t.style.setProperty("visibility","hidden"),t.style.setProperty("position","absolute"),t.style.setProperty("width",`${e.width}px`),t.classList.add("popular-tags");const r=document.createElement("span");r.classList.add("tag","expand-tag"),r.innerHTML=`
    <span class="svg-icon"
        >${this.isPopularTagListExpanded?Wl:Gl}</span
      >
    more`,t.appendChild(r);const o=t.getBoundingClientRect().height;for(let i=0;i<Math.min(Yl,this.popularTags.length);i++){const s=document.createElement("tag");if(s.classList.add("tag"),s.innerText=this.popularTags[i].tag,t.appendChild(s),t.getBoundingClientRect().height>o){this.maxTagsOneLine!==i&&(this.maxTagsOneLine=i);break}}t.remove()}popularTagListToggled(){this.isPopularTagListExpanded=!this.isPopularTagListExpanded}tagClicked(n){if(this.promptContentElement===void 0)throw Error("promptContentElement is undefined");this.curSelectedTag===n?this.curSelectedTag="":this.curSelectedTag=n,this.curPage=1,this.isWaitingForQueryResponse=!0;const e=this.promptContentElement;e.classList.add("no-scroll"),this.remotePromptManager.getPromptsByTag(this.curSelectedTag,this.curMode).then(()=>{this.isWaitingForQueryResponse=!1,e.classList.remove("no-scroll")})}promptCardTagClickedHandler(n){this.tagClicked(n.detail)}pageClickedHandler(n){if(this.promptContentElement===void 0)throw Error("promptContentElement undefined");n.detail!==this.curPage&&(this.curPage=n.detail,this.promptContentElement.scrollTop=0)}promptCardClicked(n){if(this.promptModalElement===void 0||this.promptContentElement===void 0)throw Error("promptModalElement is undefined.");this.selectedPrompt=n,this.promptModalElement.style.setProperty("top",`${this.promptContentElement.scrollTop}px`),this.promptModalElement.classList.remove("hidden"),this.promptContentElement.classList.add("no-scroll")}modalCloseClickHandler(){if(this.promptModalElement===void 0||this.promptContentElement===void 0)throw Error("promptModalElement is undefined.");this.promptModalElement.classList.add("hidden"),this.promptContentElement.classList.remove("no-scroll")}headerModeButtonClicked(n){if(this.curMode!==n){if(this.promptContentElement===void 0)throw Error("promptContentElement is undefined");this.isWaitingForQueryResponse=!0;const e=this.promptContentElement;e.classList.add("no-scroll"),this.remotePromptManager.getPromptsByTag(this.curSelectedTag,n).then(()=>{this.isWaitingForQueryResponse=!1,e.classList.remove("no-scroll")}),this.curMode=n}}render(){let n=M``;const e=this.isPopularTagListExpanded?Math.min(Yl,this.popularTags.length):this.maxTagsOneLine;for(const o of this.popularTags.slice(0,e))n=M`${n}
        <span
          class="tag"
          ?is-selected="${this.curSelectedTag===o.tag}"
          @click=${()=>this.tagClicked(o.tag)}
          >${o.tag}</span
        >`;const t=M`<span
      class="tag expand-tag"
      @click=${()=>{this.popularTagListToggled()}}
      ><span class="svg-icon"
        >${H(this.isPopularTagListExpanded?Wl:Gl)}</span
      >
      ${this.isPopularTagListExpanded?"less":"more"}</span
    >`;let r=M``;for(let o=0;o<eo;o++){const i=(this.curPage-1)*eo+o;if(i>this.remotePrompts.length-1)break;const s=this.remotePrompts[i];r=M`${r}
        <wordflow-prompt-card
          .promptData=${s}
          .curSelectedTag=${this.curSelectedTag}
          @click=${()=>{this.promptCardClicked(s)}}
          @tag-clicked=${a=>this.promptCardTagClickedHandler(a)}
        ></wordflow-prompt-card> `}return M`
      <div class="panel-community">
        <div class="header">
          <div class="header-top">
            <span class="name"
              >${this.remotePrompts.length}${this.remotePromptManager.promptIsSubset?"+":""}
              Prompts</span
            >
            <span class="filter" ?is-hidden=${this.curSelectedTag===""}
              >tagged
              <span
                class="tag show-cross"
                is-selected=""
                @click=${()=>this.tagClicked(this.curSelectedTag)}
                >${this.curSelectedTag}
                <span class="svg-icon">${H(ir)}</span>
              </span></span
            >
            <div class="header-toggle">
              <span
                @click=${()=>this.headerModeButtonClicked("popular")}
                ?is-active=${this.curMode==="popular"}
                >Popular</span
              >
              <span
                @click=${()=>this.headerModeButtonClicked("new")}
                ?is-active=${this.curMode==="new"}
                >New</span
              >
            </div>
          </div>
          <div class="header-bottom">
            <div class="header-tag-list">
              <span class="name">Popular tags</span>
              <div class="popular-tags">${n} ${t}</div>
            </div>
          </div>
        </div>

        <div class="prompt-content">
          <div
            class="prompt-loader"
            ?is-hidden=${this.remotePrompts.length>0&&!this.isWaitingForQueryResponse}
          >
            <div class="loader-container">
              <span class="label">Loading Prompts</span>
              <div class="circle-loader"></div>
            </div>
          </div>

          <div class="prompt-container">${r}</div>

          <div
            class="pagination"
            ?no-show=${this.remotePrompts.length<=eo}
          >
            <nightjar-pagination
              curPage=${this.curPage}
              totalPageNum=${Math.ceil(this.remotePrompts.length/eo)}
              pageWindowSize=${Yb}
              @page-clicked=${o=>this.pageClickedHandler(o)}
            ></nightjar-pagination>
          </div>

          <div class="prompt-modal hidden">
            <wordflow-prompt-viewer
              .promptData=${this.selectedPrompt?this.selectedPrompt:ii()}
              .curSelectedTag=${this.curSelectedTag}
              @close-clicked=${()=>this.modalCloseClickHandler()}
            ></wordflow-prompt-viewer>
          </div>
        </div>
      </div>
    `}};ue.styles=[be`
      ${oe(Vb)}
    `];Te([O({attribute:!1})],ue.prototype,"remotePromptManager",2);Te([O({attribute:!1})],ue.prototype,"remotePrompts",2);Te([O({attribute:!1})],ue.prototype,"popularTags",2);Te([O({type:Boolean})],ue.prototype,"is-shown",2);Te([I()],ue.prototype,"selectedPrompt",2);Te([I()],ue.prototype,"curMode",2);Te([I()],ue.prototype,"maxTagsOneLine",2);Te([I()],ue.prototype,"isPopularTagListExpanded",2);Te([I()],ue.prototype,"curSelectedTag",2);Te([I()],ue.prototype,"curPage",2);Te([I()],ue.prototype,"isWaitingForQueryResponse",2);Te([Lo(".popular-tags")],ue.prototype,"popularTagsElementPromise",2);Te([Y(".panel-community")],ue.prototype,"panelElement",2);Te([Y(".prompt-content")],ue.prototype,"promptContentElement",2);Te([Y(".prompt-modal")],ue.prototype,"promptModalElement",2);ue=Te([ve("wordflow-panel-community")],ue);const ii=()=>{let n=localStorage.getItem("user-id");return n===null&&(console.warn("userID is undefined. Creating a new userID."),n=mn(),localStorage.setItem("user-id",n)),{prompt:"",tags:[],temperature:.2,userID:n,userName:"",description:"",icon:"",forkFrom:"",promptRunCount:0,created:new Date().toISOString(),title:"",outputParsingPattern:"",outputParsingReplacement:"",recommendedModels:[],injectionMode:"replace"}},Kb=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const hd="important",qb=" !"+hd,Jb=dc(class extends pc{constructor(n){var e;if(super(n),n.type!==uc.ATTRIBUTE||n.name!=="style"||((e=n.strings)==null?void 0:e.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(n){return Object.keys(n).reduce((e,t)=>{const r=n[t];return r==null?e:e+`${t=t.includes("-")?t:t.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(n,[e]){const{style:t}=n.element;if(this.ut===void 0)return this.ut=new Set(Object.keys(e)),this.render(e);for(const r of this.ut)e[r]==null&&(this.ut.delete(r),r.includes("-")?t.removeProperty(r):t[r]=null);for(const r in e){const o=e[r];if(o!=null){this.ut.add(r);const i=typeof o=="string"&&o.endsWith(qb);r.includes("-")||i?t.setProperty(r,i?o.slice(0,-11):o,i?hd:""):t[r]=o}}return Ht}}),Zb=`.slider{--thumb-width: 14px;width:calc(100% - var(--thumb-width));height:5px;display:flex;flex-direction:row;justify-content:center;align-items:center;box-sizing:border-box;margin-left:calc(var(--thumb-width) / 2);margin-right:calc(var(--thumb-width) / 2);position:relative;top:1px}.slider-track{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:5px;display:flex}.slider-track.background-track{background:var(--background-color)}.slider-track.range-track{width:0px;border-bottom-right-radius:0;border-top-right-radius:0;background:var(--foreground-color)}.middle-thumb{position:absolute;z-index:3;top:50%;left:calc(var(--thumb-width) / -2);transform:translateY(-50%);width:var(--thumb-width);height:var(--thumb-width);border-radius:100%;background-color:var(--foreground-color);color:var(--foreground-color);box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #00000014;cursor:grab}.middle-thumb:before{content:"";display:inline-block;position:absolute;z-index:1;width:5px;height:5px;border-radius:50%;background:currentColor;opacity:.2;left:50%;top:50%;margin-top:-2.5px;margin-left:-2.5px;-webkit-backface-visibility:hidden;-webkit-transform:translateZ(0);transform:scale(.1);transition:transform .3s ease-in-out}.middle-thumb:hover:before{transform:scale(5)}.middle-thumb:hover .thumb-label{transition-delay:.2s;transform:translate(-50%) translateY(100%) scale(1)}.middle-thumb:focus{cursor:grabbing;outline:none}.middle-thumb:focus:before{transform:scale(7)}.middle-thumb:focus .thumb-label{transform:translate(-50%) translateY(100%) scale(1)}.middle-thumb.animating .thumb-label{transform:translate(-50%) translateY(100%) scale(1)}
`;var Xb=Object.defineProperty,Qb=Object.getOwnPropertyDescriptor,Xt=(n,e,t,r)=>{for(var o=r>1?void 0:r?Qb(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Xb(e,t,o),o};let gt=class extends Q{constructor(){super(),this.min=0,this.max=1,this.curValue=null,this.styleConfig=null,this.initData=async()=>{}}firstUpdated(){this.curValue===null&&(this.curValue=this.min),this.syncThumb()}willUpdate(n){n.has("curValue")&&this.curValue!==null&&this.syncThumb()}syncThumb(){if(this.curValue!==null){const n=this.backgroundTrackElement,e=this.middleThumbElement,t=this.rangeTrackElement;if(n&&e&&t){const r=e.getBoundingClientRect(),o=n.getBoundingClientRect(),s=this.curValue/(this.max-this.min)*o.width-r.width/2;e.style.left=`${s}px`,t.style.width=`${Math.max(0,s)}px`}}}thumbMouseDownHandler(n){n.preventDefault(),n.stopPropagation();const e=n.target;e.id.includes("thumb")||console.error("Thumb event target is not thumb itself.");const t=e.parentElement,r=t.querySelector(".range-track"),o=e.getBoundingClientRect(),i=t.getBoundingClientRect(),s=i.width;e.focus();const a=c=>{c.preventDefault(),c.stopPropagation();const u=c.pageX-i.x,d=Math.min(1,Math.max(0,u/s));e.setAttribute("data-curValue",String(d));const p=d*i.width-o.width/2;e.style.left=`${p}px`,r.style.width=`${Math.max(0,p)}px`;const h=this.min+(this.max-this.min)*d,f=new CustomEvent("valueChanged",{detail:{value:h}});this.dispatchEvent(f)},l=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l),e.blur()};document.addEventListener("mousemove",a),document.addEventListener("mouseup",l)}render(){var e,t;const n={"--foreground-color":((e=this.styleConfig)==null?void 0:e.foregroundColor)||"hsl(174, 41.28%, 78.63%)","--background-color":((t=this.styleConfig)==null?void 0:t.backgroundColor)||"hsl(174, 100%, 29.41%)"};return M`
      <div class="slider" style=${Jb(n)}>
        <div class="slider-track background-track"></div>
        <div class="slider-track range-track"></div>
        <div
          class="middle-thumb"
          id="slider-middle-thumb"
          tabindex="-1"
          @mousedown=${r=>this.thumbMouseDownHandler(r)}
        >
          <div class="thumb-label thumb-label-middle">
            <span class="thumb-label-span"></span>
          </div>
        </div>
      </div>
    `}};gt.styles=[be`
      ${oe(Zb)}
    `];Xt([O({type:Number})],gt.prototype,"min",2);Xt([O({type:Number})],gt.prototype,"max",2);Xt([O({type:Number})],gt.prototype,"curValue",2);Xt([O({attribute:!1})],gt.prototype,"styleConfig",2);Xt([Y(".background-track")],gt.prototype,"backgroundTrackElement",2);Xt([Y(".range-track")],gt.prototype,"rangeTrackElement",2);Xt([Y("#slider-middle-thumb")],gt.prototype,"middleThumbElement",2);gt=Xt([ve("nightjar-slider")],gt);const ev=`@keyframes fade-in{0%{opacity:0}to{opacity:1}}.confirm-dialog{--padding-v: 18px;--padding-h: 20px;display:none;flex-direction:column;justify-content:flex-start;align-items:flex-start;max-width:500px;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f;padding:0;border:none}.confirm-dialog[open]{border-radius:8px;border:none;display:flex;flex-direction:column;align-items:center;gap:0;padding:0;pointer-events:all}.confirm-dialog[open]::backdrop{background-color:#0000008c;animation:fade-in .3s}.header{padding:var(--padding-v) var(--padding-h) 0px var(--padding-h);margin:0;line-height:1;font-size:var(--font-u3);width:100%;display:flex;flex-flow:row;align-items:center;box-sizing:border-box}.separator{display:flex;width:calc(100% - 40px);height:3px;border-radius:5px;background-color:var(--gray-200)}.content{display:flex;flex-flow:column;gap:12px;padding:16px var(--padding-h)}.content .skip-bar{color:var(--gray-800)}.button-block{display:flex;flex-direction:row;justify-content:flex-end;box-sizing:border-box;gap:10px;width:100%;padding:0px var(--padding-h) var(--padding-v) var(--padding-h);a {color: currentColor; font-style: normal; text-decoration: none;}}.button-block button{all:unset;cursor:pointer;background-color:var(--gray-200);padding:3px 8px;border-radius:8px;display:flex;flex-grow:0;transition:background-color .15s ease-in-out;// &.cancel-button {// color: white; // background-color: $blue-500; // &:hover {// background-color: $blue-600; //} // &:active {// background-color: $blue-700; //} //}}.button-block button:hover{background-color:var(--gray-300)}.button-block button:active{background-color:var(--gray-400)}
`;var tv=Object.defineProperty,nv=Object.getOwnPropertyDescriptor,Wr=(n,e,t,r)=>{for(var o=r>1?void 0:r?nv(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&tv(e,t,o),o};let kn=class extends Q{constructor(){super(),this.header="Delete Item",this.message="Are you sure you want to delete this item? This action cannot be undone.",this.yesButtonText="Delete",this.actionKey="deletion",this.initData=async()=>{},this.confirmAction=()=>{},this.cancelAction=()=>{}}firstUpdated(){window.setTimeout(()=>{},1e3)}willUpdate(n){}show(n,e,t){this.header=n.header,this.message=n.message,this.yesButtonText=n.yesButtonText,this.actionKey=n.actionKey,this.confirmAction=e,t===void 0?this.cancelAction=()=>{}:this.cancelAction=t,localStorage.getItem(`<skip-confirm>${this.actionKey}`)==="true"?this.confirmAction():this.dialogElement&&this.dialogElement.showModal()}dialogClicked(n){n.target===this.dialogElement&&this.dialogElement.close()}cancelClicked(n){n.stopPropagation(),this.dialogElement&&(this.dialogElement.close(),this.cancelAction())}confirmClicked(n){if(n.stopPropagation(),this.dialogElement){const e=this.dialogElement.querySelector("#checkbox-skip-confirmation");if(e&&e.checked){const t=`<skip-confirm>${this.actionKey}`;localStorage.setItem(t,"true")}this.confirmAction(),this.dialogElement.close()}}render(){return M`
      <dialog
        class="confirm-dialog"
        @click=${n=>this.dialogClicked(n)}
      >
        <div class="header">
          <div class="header-name">${this.header}</div>
        </div>

        <div class="content">
          <div class="message">${this.message}</div>
          <div class="skip-bar">
            <input
              type="checkbox"
              id="checkbox-skip-confirmation"
              name="checkbox-skip-confirmation"
            />
            <label for="checkbox-skip-confirmation"
              >Don't ask me again about this action</label
            >
          </div>
        </div>

        <div class="button-block">
          <button
            class="cancel-button"
            @click=${n=>this.cancelClicked(n)}
          >
            Cancel
          </button>
          <button
            class="confirm-button"
            @click=${n=>this.confirmClicked(n)}
          >
            ${this.yesButtonText}
          </button>
        </div>
      </dialog>
    `}};kn.styles=[be`
      ${oe(ev)}
    `];Wr([Y("dialog")],kn.prototype,"dialogElement",2);Wr([I()],kn.prototype,"header",2);Wr([I()],kn.prototype,"message",2);Wr([I()],kn.prototype,"yesButtonText",2);kn=Wr([ve("nightjar-confirm-dialog")],kn);const je=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-info">
        <path d="M39.82,79.15C61.353,79.15 79.273,61.279 79.273,39.746C79.273,18.213 61.305,0.342 39.771,0.342C18.287,0.342 0.416,18.213 0.416,39.746C0.416,61.279 18.336,79.15 39.82,79.15Z" style="fill-rule:nonzero;"/>
        <path d="M32.984,62.256C31.129,62.256 29.713,60.938 29.713,59.033C29.713,57.324 31.129,55.908 32.984,55.908L37.428,55.908L37.428,39.209L33.717,39.209C31.959,39.209 30.494,37.891 30.494,35.986C30.494,34.277 31.959,32.861 33.717,32.861L41.139,32.861C43.433,32.861 44.654,34.522 44.654,36.963L44.654,55.908L49.098,55.908C50.904,55.908 52.369,57.324 52.369,59.033C52.369,60.938 50.904,62.256 49.098,62.256L32.984,62.256ZM39.43,26.709C36.256,26.709 33.717,24.121 33.717,20.947C33.717,17.725 36.256,15.234 39.43,15.234C42.603,15.234 45.045,17.725 45.045,20.947C45.045,24.121 42.603,26.709 39.43,26.709Z" style="fill:white;fill-rule:nonzero;"/>
    </g>
</svg>
`,Io='<svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"/></svg>',fd=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 76 87" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-delete">
        <path d="M20.217,86.33L55.52,86.33C61.33,86.33 65.09,82.717 65.383,76.857L67.922,21.389L60.94,21.389L58.498,76.125C58.401,78.322 56.936,79.787 54.787,79.787L20.852,79.787C18.801,79.787 17.287,78.273 17.19,76.125L14.602,21.389L7.766,21.389L10.354,76.906C10.647,82.766 14.309,86.33 20.217,86.33ZM3.762,22.121L71.926,22.121C73.733,22.121 75.149,20.656 75.149,18.85C75.149,17.043 73.684,15.578 71.926,15.578L3.762,15.578C2.053,15.578 0.539,17.043 0.539,18.85C0.539,20.656 2.053,22.121 3.762,22.121ZM20.803,18.654L27.737,18.654L27.737,10.451C27.737,8.449 29.153,7.131 31.203,7.131L44.436,7.131C46.438,7.131 47.854,8.449 47.854,10.451L47.854,18.654L54.836,18.654L54.836,9.963C54.836,4.201 51.076,0.637 44.924,0.637L30.666,0.637C24.563,0.637 20.803,4.201 20.803,9.963L20.803,18.654ZM37.844,73.732C39.504,73.732 40.627,72.707 40.627,71.193L40.627,31.154C40.627,29.641 39.504,28.615 37.844,28.615C36.184,28.615 35.061,29.641 35.061,31.154L35.061,71.193C35.061,72.707 36.184,73.732 37.844,73.732ZM49.172,73.732C50.686,73.732 51.809,72.756 51.858,71.193L52.932,31.154C52.981,29.641 51.907,28.615 50.246,28.615C48.684,28.615 47.61,29.641 47.561,31.154L46.487,71.193C46.438,72.707 47.512,73.732 49.172,73.732ZM26.565,73.732C28.225,73.732 29.299,72.707 29.25,71.193L28.127,31.154C28.078,29.592 27.004,28.615 25.442,28.615C23.83,28.615 22.707,29.641 22.756,31.154L23.879,71.193C23.928,72.756 25.002,73.732 26.565,73.732Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,rv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 70 88" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-share">
        <path d="M12.947,87.746L56.746,87.746C65.095,87.746 69.197,83.645 69.197,75.441L69.197,37.893C69.197,29.689 65.095,25.588 56.746,25.588L46.248,25.588L46.248,32.668L56.648,32.668C60.115,32.668 62.165,34.572 62.165,38.234L62.165,75.1C62.165,78.811 60.115,80.666 56.648,80.666L13.044,80.666C9.529,80.666 7.527,78.811 7.527,75.1L7.527,38.234C7.527,34.572 9.529,32.668 13.044,32.668L23.445,32.668L23.445,25.588L12.947,25.588C4.646,25.588 0.496,29.689 0.496,37.893L0.496,75.441C0.496,83.645 4.646,87.746 12.947,87.746Z" style="fill-rule:nonzero;"/>
        <path d="M34.822,57.473C36.726,57.473 38.337,55.91 38.337,54.055L38.337,15.969L38.044,10.109L40.095,12.355L45.466,18.166C46.101,18.85 46.98,19.191 47.81,19.191C49.665,19.191 51.033,17.922 51.033,16.164C51.033,15.188 50.642,14.504 49.958,13.869L37.361,1.809C36.482,0.93 35.749,0.637 34.822,0.637C33.943,0.637 33.21,0.93 32.283,1.809L19.685,13.869C19.05,14.504 18.66,15.188 18.66,16.164C18.66,17.922 19.978,19.191 21.833,19.191C22.664,19.191 23.591,18.85 24.226,18.166L29.597,12.355L31.648,10.109L31.355,15.969L31.355,54.055C31.355,55.91 32.966,57.473 34.822,57.473Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,ov=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-check-circle">
        <path d="M39.82,79.33C61.353,79.33 79.273,61.459 79.273,39.926C79.273,18.393 61.305,0.521 39.771,0.521C18.287,0.521 0.416,18.393 0.416,39.926C0.416,61.459 18.336,79.33 39.82,79.33ZM39.82,71.908C22.096,71.908 7.935,57.699 7.935,39.926C7.935,22.152 22.047,7.943 39.771,7.943C57.545,7.943 71.803,22.152 71.803,39.926C71.803,57.699 57.594,71.908 39.82,71.908Z" style="fill-rule:nonzero;"/>
        <path d="M35.621,58.09C37.037,58.09 38.258,57.406 39.137,56.039L55.933,29.477C56.471,28.598 57.008,27.621 57.008,26.644C57.008,24.691 55.299,23.471 53.443,23.471C52.32,23.471 51.246,24.105 50.416,25.424L35.426,49.74L28.687,40.658C27.613,39.242 26.637,38.9 25.465,38.9C23.56,38.9 22.096,40.414 22.096,42.367C22.096,43.295 22.486,44.223 23.072,45.053L31.861,56.039C32.984,57.504 34.156,58.09 35.621,58.09Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,iv=`.tag{display:flex;line-height:1;font-size:var(--font-d2);padding:4px 6px;background-color:var(--blue-50);color:var(--blue-900);border-radius:5px;white-space:nowrap;height:var(--font-d2);cursor:pointer;user-select:none;-webkit-user-select:none}.tag:hover{background-color:color-mix(in lab,var(--blue-100),white 30%)}.tag:active,.tag[is-selected]{background-color:color-mix(in lab,var(--blue-100),white 2%)}.tag.expand-tag{background-color:color-mix(in lab,var(--gray-200),white 20%);color:var(--gray-800);display:flex;flex-flow:row;align-items:center}.tag.expand-tag:hover{background-color:color-mix(in lab,var(--gray-300),white 30%)}.tag.expand-tag .svg-icon{position:relative;top:1px;margin-right:3px;color:var(--gray-700);width:1em;height:1em}.tag.show-cross .svg-icon{top:1px;position:relative;width:8px;height:8px;margin:auto auto auto 4px}@keyframes scale-up{0%{transform:scale(.2)}to{transform:scale(1)}}a{color:var(--blue-800)}button{all:unset}.prompt-editor{--padding-h: 20px;--padding-v: 10px;--focus-border-color: var(--blue-200);width:100%;height:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;position:relative;box-sizing:border-box;font-size:var(--font-d2)}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.prompt-window{display:flex;flex-flow:column;background-color:#fff;border-radius:10px;box-shadow:0 0 1px #00000026,0 0 5px #00000026,0 0 20px #00000026;animation:scale-up .1s;width:460px;height:440px;position:relative}.header{padding:var(--padding-v) var(--padding-h) var(--padding-v) var(--padding-h);display:flex;flex-flow:column;align-items:flex-start;gap:5px;border-bottom:1px solid var(--gray-300);user-select:none;-webkit-user-select:none}.info-bar{display:flex;flex-flow:row nowrap;align-items:stretch;gap:10px;flex:1 0 auto;max-width:100%;white-space:nowrap}.info-bar .separator{width:1px;border-radius:1px;transform:scaleY(.7);transform-origin:center;background-color:var(--gray-500)}.info-bar .user-name-wrapper{display:flex;flex-flow:row nowrap;overflow:hidden}.info-bar .user-name{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.title-bar{box-sizing:border-box;display:flex;align-items:flex-start;gap:5px;font-size:var(--font-d1);width:100%}.title-bar .svg-icon{z-index:1;margin-left:auto;width:23px;height:23px;flex-shrink:0;padding:5px;box-sizing:border-box;position:relative;cursor:pointer;color:var(--gray-600);transition:color .1s}.title-bar .svg-icon:before{z-index:-1;content:"";position:absolute;top:50%;left:50%;transform-origin:center;transform:translate(-50%,-50%) scale(0);border-radius:50%;background-color:var(--gray-100);width:100%;height:100%;transition:transform .1s}.title-bar .svg-icon:hover{color:var(--gray-700)}.title-bar .svg-icon:hover:before{transform:translate(-50%,-50%) scale(1.4)}.title-bar .svg-icon:active:before{transform:translate(-50%,-50%) scale(1.6)}.title-bar .name{position:relative;font-size:1rem}.icon{display:flex;flex-shrink:0;width:28px;height:28px;justify-content:center;align-items:center;vertical-align:middle;text-align:center;transform-origin:center center 0px;border-radius:100%;border:1px solid var(--gray-400);position:relative;user-select:none;-webkit-user-select:none;box-sizing:border-box;transition:box-shadow linear .1s}.icon span{font-size:34px;transform:scale(.5);color:var(--gray-700);font-weight:700;line-height:1}.content{flex:1 1 auto;padding:10px 0 var(--padding-v) 0;display:flex;flex-flow:column;overflow-y:auto;position:relative}.content.no-scroll{overflow-y:hidden}.two-section-container{padding:0 var(--padding-h) 0 var(--padding-h);display:flex;flex-flow:row nowrap;align-items:center;justify-content:flex-start;gap:20px;margin-bottom:12px}.content-block{display:flex;flex-flow:column;align-items:flex-start}.content-block.content-block-title{flex:1 1 auto}.content-block.content-block-icon{flex:0 1 auto}.content-block.content-block-icon input[type=text]{padding:5px;border-radius:100%;width:33px;height:33px;text-align:center;font-size:17px;font-weight:700;line-height:1}.content-block.content-block-prompt{margin-bottom:12px;padding:0px var(--padding-h) 0px var(--padding-h)}.content-block .name{font-weight:800;color:var(--gray-600)}.content-block .content-text{line-height:1.25}.content-block .tag-list{margin-top:2px;display:flex;flex-flow:row wrap;gap:7px}.content-block .tag{pointer-events:none}.content-block input[type=text]{all:unset;border:1px solid var(--gray-300);border-radius:5px;padding:5px;width:100%;box-sizing:border-box}.content-block input[type=text]:focus{outline:2px solid var(--focus-border-color);border:1px solid var(--focus-border-color)}.content-block input[type=text]::placeholder{color:var(--gray-600)}.content-block textarea{border:1px solid var(--gray-300);border-radius:5px;padding:5px;width:100%;box-sizing:border-box;font-family:inherit;font-size:unset;resize:vertical}.content-block textarea:focus{outline:2px solid var(--focus-border-color);border:1px solid var(--focus-border-color)}.content-block textarea.prompt-input{height:150px}.content-block textarea.prompt-description{height:80px}.content-block textarea::placeholder{color:var(--gray-600)}.content-block .content-icon-wrapper{display:flex;flex-flow:row nowrap;gap:5px}.content-block .name-row{display:flex;flex-flow:row nowrap;align-items:baseline;gap:5px;color:var(--gray-400);user-select:none;-webkit-user-select:none}.content-block .name-row .name-container{display:flex;align-items:baseline;gap:5px;cursor:help}.content-block .name-row .info-icon{position:relative;width:13px;height:13px;top:1px}.content-block .name-row .name-info{color:var(--gray-600)}.content-block .name-row .name.required-name:after{content:"*";position:relative;left:2px;color:var(--red-300)}.content-block .length-input-container{width:100%;display:flex;align-items:center;position:relative}.content-block .length-input-container .length-counter{position:absolute;top:50%;right:10px;transform:translateY(-50%);color:var(--gray-500)}.footer{padding:var(--padding-v) var(--padding-h) var(--padding-v) var(--padding-h);display:flex;flex-flow:row nowrap;justify-content:space-between;border-top:1px solid var(--gray-300);font-size:var(--font-d1)}.footer .button-container{display:flex;flex-flow:row nowrap;gap:12px}.footer-button{flex:0 1 auto;display:flex;align-items:center;padding:1px 12px;background-color:var(--gray-200);gap:5px;border-radius:5px;cursor:pointer}.footer-button:hover{background-color:color-mix(in lab,var(--gray-200),black 3%)}.footer-button:active{background-color:color-mix(in lab,var(--gray-200),black 7%)}.footer-button[no-display]{display:none}.accordion-container{display:flex;flex-direction:column;--inner-padding: 5px;padding:8px calc(var(--padding-h) - var(--inner-padding));padding-bottom:var(--padding-v);border-top:1px solid var(--gray-200)}.accordion-container .accordion-header{padding:3px var(--inner-padding);display:flex;flex-direction:row;justify-content:space-between;align-items:center;cursor:pointer;border-radius:5px;background-color:var(--gray-100)}.accordion-container .accordion-header:hover{background-color:var(--gray-200)}.accordion-container .accordion-header:active{background-color:var(--gray-300)}.accordion-container .accordion-header .arrow-icon{color:var(--gray-600);width:16px;height:16px;transform:rotate(180deg);transition:transform .1s}.accordion-container .accordion-content{display:flex;flex-direction:column;padding:0 var(--inner-padding);padding-top:5px;gap:12px}.accordion-container[hide-content]{padding-bottom:8px}.accordion-container[hide-content] .accordion-header{background-color:#fff}.accordion-container[hide-content] .accordion-header:hover{background-color:var(--gray-200)}.accordion-container[hide-content] .accordion-header:active{background-color:var(--gray-300)}.accordion-container[hide-content] .accordion-content{display:none}.accordion-container[hide-content] .arrow-icon{transform:rotate(0)}.model-checkbox-container{display:flex;flex-flow:row wrap;column-gap:10px;row-gap:4px;margin-top:2px}.model-checkbox-container .checkbox-group{display:flex;align-items:center;gap:4px;input[type="checkbox"] {margin: 0;}}.injection-button{border:1px solid var(--gray-300);border-radius:5px;padding:5px;width:100%;box-sizing:border-box;position:relative}.injection-button:focus{outline:2px solid var(--focus-border-color);border:1px solid var(--focus-border-color)}.injection-button:hover{background-color:color-mix(in lab,var(--gray-300),white 60%)}.injection-button select{position:absolute;align-self:baseline;width:100%;height:100%;opacity:0;top:0;left:0;cursor:pointer}.injection-button .injection-mode-text:after{content:"";position:absolute;top:60%;right:11px;width:7px;height:2px;background-color:var(--gray-500);transform-origin:left;transform:rotate(-45deg)}.injection-button .injection-mode-text:before{content:"";position:absolute;top:60%;right:10px;width:7px;height:2px;background-color:var(--gray-500);transform-origin:left;transform:rotate(-135deg)}.popper-tooltip{position:absolute;width:max-content;left:0;top:0;z-index:20;background:var(--gray-800);color:#fff;box-shadow:0 0 1px #0009,0 0 3px #0000000d;padding:0 5px 3px;border-radius:4px;font-size:var(--font-d3);display:flex;justify-content:center;box-sizing:border-box;pointer-events:none;opacity:1;transform:scale(1);transition:opacity .15s,transform .15s}.popper-tooltip.hidden{opacity:0;transform:scale(.8)}.popper-tooltip .popper-content{max-width:200px;max-height:200px;line-height:1.5;overflow:hidden;display:inline;user-select:none;-webkit-user-select:none;text-align:center}.popper-tooltip .popper-content :global(.tooltip-image){width:100px;height:100px;object-fit:contain}.popper-tooltip .popper-content .instruction-text{color:var(--gray-400)}.popper-tooltip .popper-content .warn-text{color:var(--orange-a200)}.popper-tooltip .popper-content .alert-text{color:var(--red-a100)}.popper-tooltip .popper-arrow{position:absolute;background:var(--gray-800);width:8px;height:8px;transform:rotate(45deg);opacity:1}.popper-tooltip .popper-arrow.hidden{opacity:0}.toast-container{position:absolute;top:7px;z-index:1;width:100%;display:flex;justify-content:center}.toast-container nightjar-toast{max-width:300px}.slider-container{display:flex;flex-flow:row nowrap;align-items:center;width:100%;gap:10px;input[type="text"].content-text {width: 48px;} & nightjar-slider {width: 250px;}}@keyframes circle-loader-animation{to{transform:rotate(1turn)}}.prompt-loader{position:absolute;width:100%;height:100%;pointer-events:all;background-color:#ffffffb3;z-index:2;opacity:1;transition:opacity .15s}.prompt-loader.no-display{display:none}.prompt-loader.hidden,.prompt-loader[is-hidden]{opacity:0;pointer-events:none}.prompt-loader .circle-loader{width:12px;height:12px;border:3px solid}.loader-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:row;gap:10px;align-items:center;white-space:nowrap;color:var(--gray-700);line-height:1;font-size:var(--font-u2)}.loader-container .circle-loader{width:12px;height:12px;border-radius:50%;border:3px solid;border-color:color-mix(in lab,var(--gray-400) 100%,white 30%);border-right-color:var(--gray-600);animation:circle-loader-animation 1s infinite linear}
`;var sv=Object.defineProperty,av=Object.getOwnPropertyDescriptor,De=(n,e,t,r)=>{for(var o=r>1?void 0:r?av(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&sv(e,t,o),o};const lv=[{label:"GPT 3.5",name:"gpt-3.5"},{label:"GPT 4",name:"gpt-4"},{label:"PALM 2",name:"palm-2"},{label:"Gemini Pro",name:"gemini-pro"},{label:"Claude 1",name:"claude-1"},{label:"Claude 2",name:"claude-2"},{label:"Llama 2",name:"llama-2"}],Ui={replace:"Replace input text",append:"Append after input text"},ql=["✍️","✉️","🎓","😎","🌱","👾","💧","👓"],Rn=40,Jl=2e3,dr=500,Zl=2e3,cv=100,Vi=3,Xl=40,Ql=Kb(),he={Title:{description:`Name for your prompt (< ${Rn} characters)`,placeholder:"Shorten the text",tooltip:`A short name for your prompt. It should have less than ${Rn} characters.`},Icon:{description:"",placeholder:"",tooltip:"Choose an emoji or a character as the icon for your prompt"},Prompt:{description:"Prompt content",placeholder:"You are an experienced writer. Given some input text, you will make it succinct and clear.",tooltip:"By default, the input text will be added to the end of prompt. To place input text elsewhere, insert {{text}} in the prompt where you want the text."},"Output Parsing - Pattern":{description:"Regex to parse the LLM output",placeholder:"(.*)",tooltip:"Regular expression pattern (JavaScript flavor) to parse the LLM output string."},"Output Parsing - Replacement":{description:"Regex match replacement",placeholder:"$1",tooltip:"Replacement string for the matched occurrence in the LLM output string"},"Injection Mode":{description:"How should the LLM output be added?",placeholder:"",tooltip:"Replace: replace the input text with the LLM output. Append: add the LLM output to the end of hte input text."},Description:{description:"What does your prompt do?",placeholder:"This prompt helps users shorten any English text.",tooltip:"A short description for your prompt."},Tags:{description:"One to three tags separated by comma",placeholder:"shorten, summary",tooltip:"One to three tags to help other users discover your prompt."},"User Name":{description:"Optional user name",placeholder:"",tooltip:"Optional user name associated with your prompt."},"Recommended Models":{description:"Suggested LLMs to use this prompt",placeholder:"",tooltip:"Best LLM models to use with this prompt."},Temperature:{description:"LLM temperature",placeholder:"",tooltip:"Temperature controls randomness of the LLM output. As the value approaches 0, the output becomes deterministic and repetitive."}};let ie=class extends Q{constructor(){super(),this.curSelectedTag="",this.isNewPrompt=!1,this.showAdvancedOptions=!1,this.showSharingOptions=!1,this.injectionMode="replace",this.temperature=0,this.tooltipConfig=null,this.titleLengthRemain=Rn,this.toastMessage="",this.toastType="success",this.promptData=$o(),this.availableModels=structuredClone(lv),this.placeholderEmoji=ql[Math.floor(Math.random()*ql.length)]}firstUpdated(){this.popperElement&&(this.tooltipConfig={tooltipElement:this.popperElement,mouseenterTimer:null,mouseleaveTimer:null})}willUpdate(n){n.has("promptData")&&(this.injectionMode=this.promptData.injectionMode,this.temperature=this.promptData.temperature)}async initData(){}parseForm(){if(this.shadowRoot===null)throw Error("Shadow root is null.");const n=$o();n.forkFrom=this.promptData.forkFrom,n.key=this.promptData.key,n.promptRunCount=this.promptData.promptRunCount;const e=this.shadowRoot.querySelector("#text-input-title").value;n.title=e.slice(0,Rn);const t=this.shadowRoot.querySelector("#text-input-icon").value,r=t.match(Ql);let o=t.slice(0,1);r&&(o=r[0]),n.icon=o,n.icon===""&&(n.icon=this.placeholderEmoji);const i=this.shadowRoot.querySelector("#text-input-prompt").value;n.prompt=i.slice(0,Jl),n.temperature=this.temperature;const s=this.shadowRoot.querySelector("#text-input-output-parsing-pattern").value;n.outputParsingPattern=s.slice(0,dr);const a=this.shadowRoot.querySelector("#text-input-output-parsing-replacement").value;n.outputParsingReplacement=a.slice(0,dr),n.injectionMode=this.injectionMode;const l=this.shadowRoot.querySelector("#text-input-description").value;n.description=l.slice(0,Zl);const c=this.shadowRoot.querySelector("#text-input-tags").value;if(c.length>0){const f=c.split(/\s*,\s*/).map(m=>m.replace(/\s+/g,"-").toLowerCase());n.tags=f.slice(0,Vi)}const u=this.shadowRoot.querySelector("#text-input-user-name").value;n.userName=u.slice(0,Xl);const d=this.shadowRoot.querySelectorAll(".model-checkbox"),p=[];for(const h of d)h.checked&&p.push(h.name);return n.recommendedModels=p,n}savePrompt(){if(this.toastComponent===void 0)throw Error("toastComponent is undefined.");const n=this.parseForm();if(n.title.length===0){this.toastMessage="Title can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.icon.length===0){this.toastMessage="Icon can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.prompt.length===0){this.toastMessage="Prompt can't be empty.",this.toastType="error",this.toastComponent.show();return}this.isNewPrompt?this.promptManager.addPrompt(n):(n.forkFrom=this.promptData.forkFrom,this.promptManager.setPrompt(n)),this.toastComponent.hide(),this.closeButtonClicked()}sharePrompt(){if(this.toastComponent===void 0)throw Error("toastComponent is undefined.");if(this.shadowRoot===null)throw Error("Shadow root is null");if(this.confirmDialogComponent===void 0)throw Error("confirmDialogComponent is undefined");const n=this.parseForm();if(n.title.length===0){this.toastMessage="Title can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.icon.length===0){this.toastMessage="Icon can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.prompt.length===0){this.toastMessage="Prompt can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.description.length===0){this.toastMessage="Description (under Sharing Settings) can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.tags.length===0){this.toastMessage="Tags (under Sharing Settings) can't be empty.",this.toastType="error",this.toastComponent.show();return}if(n.tags.length>Vi){this.toastMessage=`You can only enter at most ${Vi} tags.`,this.toastType="error",this.toastComponent.show();return}for(const l of n.tags){if(l.length<2){this.toastMessage="Each tag should have least 2 characters.",this.toastType="error",this.toastComponent.show();return}if(l.length>20){this.toastMessage="Each tag should have at most 20 characters.",this.toastType="error",this.toastComponent.show();return}}this.isNewPrompt?this.promptManager.addPrompt(n):(n.forkFrom=this.promptData.forkFrom,this.promptManager.setPrompt(n));const e=this.shadowRoot.querySelector(".content"),t=this.shadowRoot.querySelector(".prompt-loader"),r=this.toastComponent;t.style.setProperty("top",`${e.scrollTop}px`),e.classList.add("no-scroll"),t.classList.remove("hidden");const o=l=>{e.classList.remove("no-scroll"),t.style.setProperty("top","0px"),t.classList.add("hidden"),l===515?(this.toastMessage="The same prompt has been shared by a user. Try a different prompt.",this.toastType="error",r.show()):l===201&&(this.toastMessage="This prompt is shared.",this.toastType="success",r.show())},i={header:"Share Prompt",message:"Are you sure you want to share this prompt? You cannot unshare it.",yesButtonText:"Share",actionKey:"share-prompt-local"},s=()=>{const l=new CustomEvent("share-clicked",{bubbles:!0,composed:!0,detail:{data:n,stopLoader:o}});this.dispatchEvent(l)},a=()=>{o(204)};this.confirmDialogComponent.show(i,s,a)}deletePrompt(){if(this.confirmDialogComponent===void 0)throw Error("confirmDialogComponent is undefined");const n={header:"Delete Prompt",message:"Are you sure you want to delete this prompt? This action cannot be undone.",yesButtonText:"Delete",actionKey:"delete-prompt"};this.confirmDialogComponent.show(n,()=>{this.promptManager.deletePrompt(this.promptData),this.closeButtonClicked()})}async accordionHeaderClicked(n,e){if(n.preventDefault(),e==="advanced"){if(!this.sliderComponent)throw Error("sliderComponent is not initialized");this.showAdvancedOptions=!this.showAdvancedOptions,await this.updateComplete,this.sliderComponent.syncThumb()}else e==="sharing"&&(this.showSharingOptions=!this.showSharingOptions)}closeButtonClicked(){var t;if(this.shadowRoot===null)throw Error("shadowRoot is null");const n=new Event("close-clicked",{bubbles:!0,composed:!0});this.dispatchEvent(n),this.shadowRoot.querySelector("form.content").reset(),this.showAdvancedOptions=!1,this.showSharingOptions=!1,(t=this.toastComponent)==null||t.hide()}infoIconMouseEntered(n,e){const t=n.currentTarget.querySelector(".info-icon");ei(n,he[e].tooltip,"top",this.tooltipConfig,200,t,10)}infoIconMouseLeft(){ti(this.tooltipConfig)}iconInput(n){const e=n.currentTarget;if(n.inputType==="deleteContentBackward")e.value="";else{const t=e.value.match(Ql);t===null?e.value=e.value.slice(0,1):e.value=t[0]}}promptEditorBackgroundClicked(n){n.target.classList.contains("prompt-editor")&&this.closeButtonClicked()}render(){let n=M``;for(const e of this.availableModels)n=M`${n}
        <div class="checkbox-group">
          <input
            type="checkbox"
            name="${e.name}"
            class="model-checkbox"
            id="model-checkbox-${e.name}"
            ?checked=${this.promptData.recommendedModels.includes(e.name)}
          />
          <label for="model-checkbox-${e.name}">${e.label}</label>
        </div> `;return M`
      <div
        class="prompt-editor"
        @click=${e=>this.promptEditorBackgroundClicked(e)}
      >
        <div class="prompt-window">
          <div class="toast-container">
            <nightjar-toast
              message=${this.toastMessage}
              type=${this.toastType}
            ></nightjar-toast>
          </div>

          <div class="header">
            <div class="title-bar">
              <span class="name"
                >${this.isNewPrompt?"New Prompt":"Edit Prompt"}</span
              >
              <span class="svg-icon" @click=${()=>this.closeButtonClicked()}
                >${H(ir)}</span
              >
            </div>
          </div>

          <form class="content">
            <div class="prompt-loader hidden">
              <div class="loader-container">
                <span class="label">Sharing Prompt</span>
                <div class="circle-loader"></div>
              </div>
            </div>

            <div class="two-section-container">
              <section class="content-block content-block-title">
                <div class="name-row">
                  <div
                    class="name-container"
                    @mouseenter=${e=>this.infoIconMouseEntered(e,"Title")}
                    @mouseleave=${()=>this.infoIconMouseLeft()}
                  >
                    <div class="name required-name">${"Title"}</div>
                    <span class="svg-icon info-icon"
                      >${H(je)}</span
                    >
                  </div>
                  <span class="name-info"
                    >${he.Title.description}</span
                  >
                </div>
                <div class="length-input-container">
                  <input
                    type="text"
                    class="content-text title-input"
                    id="text-input-title"
                    value="${this.promptData.title}"
                    maxlength="${Rn}"
                    placeholder=${he.Title.placeholder}
                    @input=${e=>{const t=e.currentTarget;this.titleLengthRemain=Rn-t.value.length}}
                  />
                  <span class="length-counter title-length-counter"
                    >${this.titleLengthRemain}</span
                  >
                </div>
              </section>

              <section class="content-block content-block-icon">
                <div class="name-row">
                  <div
                    class="name-container"
                    @mouseenter=${e=>this.infoIconMouseEntered(e,"Icon")}
                    @mouseleave=${()=>this.infoIconMouseLeft()}
                  >
                    <div class="name required-name">${"Icon"}</div>
                    <span class="svg-icon info-icon"
                      >${H(je)}</span
                    >
                  </div>
                </div>
                <div class="content-icon-wrapper">
                  <input
                    type="text"
                    class="content-text"
                    id="text-input-icon"
                    value="${this.promptData.icon}"
                    @input=${e=>this.iconInput(e)}
                    placeholder="${this.placeholderEmoji}"
                    maxlength="20"
                  />
                </div>
              </section>
            </div>

            <section class="content-block content-block-prompt">
              <div class="name-row">
                <div
                  class="name-container"
                  @mouseenter=${e=>this.infoIconMouseEntered(e,"Prompt")}
                  @mouseleave=${()=>this.infoIconMouseLeft()}
                >
                  <div class="name required-name">${"Prompt"}</div>
                  <span class="svg-icon info-icon"
                    >${H(je)}</span
                  >
                </div>
                <span class="name-info"
                  >${he.Prompt.description}</span
                >
              </div>
              <textarea
                type="text"
                class="content-text prompt-input"
                id="text-input-prompt"
                maxlength="${Jl}"
                placeholder="${he.Prompt.placeholder}"
              >
${this.promptData.prompt}</textarea
              >
            </section>

            <div
              class="accordion-container"
              ?hide-content=${!this.showAdvancedOptions}
            >
              <div
                class="accordion-header"
                @click=${e=>{this.accordionHeaderClicked(e,"advanced")}}
              >
                <div class="name">Advanced Settings</div>
                <span class="svg-icon arrow-icon"
                  >${H(Io)}</span
                >
              </div>

              <div class="accordion-content">
                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Temperature")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name">${"Temperature"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he.Temperature.description}</span
                    >
                  </div>
                  <div class="slider-container">
                    <nightjar-slider
                      min=${0}
                      max=${1}
                      curValue=${this.temperature}
                      .styleConfig=${{foregroundColor:"var(--gray-500)",backgroundColor:"var(--gray-300)"}}
                      @valueChanged=${e=>{this.temperature=e.detail.value}}
                    ></nightjar-slider>
                    <input
                      type="text"
                      class="content-text"
                      id="text-input-temperature"
                      value="${Fl(this.temperature,2)}"
                      maxlength="${dr}"
                      placeholder=${this.temperature}
                      @change=${e=>{const t=e.currentTarget,r=parseFloat(t.value);this.temperature=Math.min(1,Math.max(0,r)),t.value=`${Fl(this.temperature,2)}`}}
                    />
                  </div>
                </section>

                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Output Parsing - Pattern")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name">${"Output Parsing - Pattern"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he["Output Parsing - Pattern"].description}</span
                    >
                  </div>
                  <input
                    type="text"
                    class="content-text"
                    id="text-input-output-parsing-pattern"
                    value="${this.promptData.outputParsingPattern||""}"
                    maxlength="${dr}"
                    placeholder=${he["Output Parsing - Pattern"].placeholder}
                  />
                </section>

                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Output Parsing - Replacement")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name">${"Output Parsing - Replacement"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he["Output Parsing - Replacement"].description}</span
                    >
                  </div>
                  <input
                    type="text"
                    class="content-text"
                    id="text-input-output-parsing-replacement"
                    value="${this.promptData.outputParsingReplacement||""}"
                    maxlength="${dr}"
                    placeholder=${he["Output Parsing - Replacement"].placeholder}
                  />
                </section>

                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Injection Mode")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name">${"Injection Mode"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he["Injection Mode"].description}</span
                    >
                  </div>
                  <span class="injection-button">
                    <span class="injection-mode-text"
                      >${Ui[this.injectionMode]}</span
                    >
                    <select
                      class="injection-mode-select"
                      value="${this.injectionMode}"
                      @change=${e=>{e.currentTarget.value==="replace"?this.injectionMode="replace":this.injectionMode="append"}}
                    >
                      <option value="replace">
                        ${Ui.replace}
                      </option>
                      <option value="append">
                        ${Ui.append}
                      </option>
                    </select>
                  </span>
                </section>
              </div>
            </div>

            <div
              class="accordion-container"
              ?hide-content=${!this.showSharingOptions}
            >
              <div
                class="accordion-header"
                @click=${e=>{this.accordionHeaderClicked(e,"sharing")}}
              >
                <div class="name">Sharing Settings</div>
                <span class="svg-icon arrow-icon"
                  >${H(Io)}</span
                >
              </div>

              <div class="accordion-content">
                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Description")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name required-name share">
                        ${"Description"}
                      </div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he.Description.description}</span
                    >
                  </div>
                  <textarea
                    type="text"
                    class="content-text prompt-description"
                    id="text-input-description"
                    maxlength="${Zl}"
                    placeholder=${he.Description.placeholder}
                  >
${this.promptData.description||""}</textarea
                  >
                </section>

                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Tags")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name required-name share">${"Tags"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he.Tags.description}</span
                    >
                  </div>
                  <input
                    type="text"
                    class="content-text"
                    id="text-input-tags"
                    value="${this.promptData.tags!==void 0?this.promptData.tags.join(", "):""}"
                    maxlength="${cv}"
                    placeholder=${he.Tags.placeholder}
                  />
                </section>

                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"User Name")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name">${"User Name"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he["User Name"].description}</span
                    >
                  </div>
                  <input
                    type="text"
                    class="content-text"
                    id="text-input-user-name"
                    value="${this.promptData.userName||""}"
                    maxlength="${Xl}"
                  />
                </section>

                <section class="content-block">
                  <div class="name-row">
                    <div
                      class="name-container"
                      @mouseenter=${e=>this.infoIconMouseEntered(e,"Recommended Models")}
                      @mouseleave=${()=>this.infoIconMouseLeft()}
                    >
                      <div class="name">${"Recommended Models"}</div>
                      <span class="svg-icon info-icon"
                        >${H(je)}</span
                      >
                    </div>
                    <span class="name-info"
                      >${he["Recommended Models"].description}</span
                    >
                  </div>
                  <div
                    class="model-checkbox-container"
                    id="form-recommended-models"
                  >
                    ${n}
                  </div>
                </section>
              </div>
            </div>
          </form>

          <div class="footer">
            <div class="button-container">
              <button
                ?no-display=${this.isNewPrompt}
                class="footer-button"
                @click=${()=>this.deletePrompt()}
              >
                <span class="svg-icon">${H(fd)}</span>Delete
              </button>
            </div>
            <div class="button-container">
              <button class="footer-button" @click=${()=>this.sharePrompt()}>
                <span class="svg-icon">${H(rv)}</span>Share
              </button>
              <button class="footer-button" @click=${()=>this.savePrompt()}>
                <span class="svg-icon">${H(ov)}</span>Save
              </button>
            </div>
          </div>
        </div>
      </div>

      <div
        id="popper-tooltip-editor"
        class="popper-tooltip hidden"
        role="tooltip"
      >
        <span class="popper-content"></span>
        <div class="popper-arrow"></div>
      </div>

      <nightjar-confirm-dialog></nightjar-confirm-dialog>
    `}};ie.styles=[be`
      ${oe(iv)}
    `];De([O({attribute:!1})],ie.prototype,"promptData",2);De([O({type:String})],ie.prototype,"curSelectedTag",2);De([O({type:Boolean})],ie.prototype,"isNewPrompt",2);De([O({attribute:!1})],ie.prototype,"promptManager",2);De([I()],ie.prototype,"showAdvancedOptions",2);De([I()],ie.prototype,"showSharingOptions",2);De([I()],ie.prototype,"availableModels",2);De([I()],ie.prototype,"injectionMode",2);De([I()],ie.prototype,"temperature",2);De([Y("#popper-tooltip-editor")],ie.prototype,"popperElement",2);De([I()],ie.prototype,"titleLengthRemain",2);De([I()],ie.prototype,"toastMessage",2);De([I()],ie.prototype,"toastType",2);De([Y("nightjar-toast")],ie.prototype,"toastComponent",2);De([Y("nightjar-slider")],ie.prototype,"sliderComponent",2);De([Y("nightjar-confirm-dialog")],ie.prototype,"confirmDialogComponent",2);ie=De([ve("wordflow-prompt-editor")],ie);const uv=`.tag{display:flex;line-height:1;font-size:var(--font-d2);padding:4px 6px;background-color:var(--blue-50);color:var(--blue-900);border-radius:5px;white-space:nowrap;height:var(--font-d2);cursor:pointer;user-select:none;-webkit-user-select:none}.tag:hover{background-color:color-mix(in lab,var(--blue-100),white 30%)}.tag:active,.tag[is-selected]{background-color:color-mix(in lab,var(--blue-100),white 2%)}.tag.expand-tag{background-color:color-mix(in lab,var(--gray-200),white 20%);color:var(--gray-800);display:flex;flex-flow:row;align-items:center}.tag.expand-tag:hover{background-color:color-mix(in lab,var(--gray-300),white 30%)}.tag.expand-tag .svg-icon{position:relative;top:1px;margin-right:3px;color:var(--gray-700);width:1em;height:1em}.tag.show-cross .svg-icon{top:1px;position:relative;width:8px;height:8px;margin:auto auto auto 4px}@keyframes circle-loader-animation{to{transform:rotate(1turn)}}.panel-local{--padding-h: 20px;--padding-v: 12px;width:100%;height:100%;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;box-sizing:border-box;background-color:#fff}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}button{all:unset}.prompt-panel{width:100%;display:flex;flex-flow:column;flex-grow:1;overflow:hidden;box-sizing:border-box}.prompt-panel .search-panel{display:flex;flex-flow:row;align-items:stretch;justify-content:space-between;font-size:var(--font-d1);padding:var(--padding-v) var(--padding-h);border-bottom:1px solid var(--gray-300)}.prompt-panel .search-panel input{font-size:var(--font-d1)}.prompt-panel .search-group{display:flex;flex-flow:row;align-items:stretch;flex:1 0 1fr;gap:10px}.prompt-panel .search-group .result{user-select:none;-webkit-user-select:none;font-weight:800;font-size:var(--font-u2);font-variant-numeric:tabular-nums}.prompt-panel .search-group .create-button{line-height:1;display:flex;gap:5px;align-items:center;padding:0 12px;margin:1px 0;background-color:var(--green-600);color:#fff;border-radius:5px;font-weight:500;cursor:pointer}.prompt-panel .search-group .create-button:hover{background-color:color-mix(in lab,var(--green-600),white 7%)}.prompt-panel .search-group .create-button:active{background-color:color-mix(in lab,var(--green-600),white 0%)}.sort-button{display:flex;justify-content:center;align-items:center;padding:0 5px;border:1px solid var(--gray-300);border-radius:5px;position:relative}.sort-button .svg-icon{width:16px;height:16px;color:var(--gray-600)}.sort-button select{position:absolute;width:100%;height:100%;opacity:0;cursor:pointer}.sort-button:hover{background-color:color-mix(in lab,var(--gray-300),white 30%)}.search-bar{border:1px solid var(--gray-300);border-radius:5px;overflow:hidden;display:flex;flex-flow:row;background-color:#fff}.search-bar:has(input:focus){border:1px solid var(--blue-500)}.search-bar input{border:none;margin:0;width:180px;height:100%}.search-bar input::placeholder{color:var(--gray-600)}.search-bar input:focus{border:none;outline:none}.search-bar .icon-container{height:100%;display:flex;align-items:center;justify-content:center;padding:0 5px;cursor:pointer;transition:opacity .1s ease-in-out}.search-bar .icon-container[is-hidden]{opacity:0;pointer-events:none}.search-bar .svg-icon.cross{border-radius:100%;background-color:var(--gray-500);color:#fff;padding:2px;box-sizing:border-box}.search-bar .svg-icon.cross svg{width:60%;height:60%}.search-bar .svg-icon.cross:hover{opacity:.9}.prompt-container{padding:16px var(--padding-h) 16px var(--padding-h);display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr);grid-template-rows:auto;gap:16px;overflow-y:auto}.pagination{padding:var(--padding-v) var(--padding-h);margin-bottom:var(--padding-v);display:flex;justify-content:center}.prompt-loader{position:relative;grid-column:1 / 3;padding:10px 0;pointer-events:none}.prompt-loader.hidden{visibility:hidden}.prompt-loader.no-display{display:none}.prompt-loader .circle-loader{width:12px;height:12px;border:3px solid}.loader-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:row;gap:10px;align-items:center;white-space:nowrap;color:var(--gray-500);line-height:1;transition:opacity .1s ease-in-out;opacity:1}.loader-container[hidden]{opacity:0;pointer-events:none}.loader-container .circle-loader{width:12px;height:12px;border-radius:50%;border:3px solid;border-color:color-mix(in lab,var(--gray-300) 100%,white 30%);border-right-color:var(--gray-500);animation:circle-loader-animation 1s infinite linear}.fav-panel{width:100%;display:flex;flex-flow:column;padding:var(--padding-v) var(--padding-h) 16px var(--padding-h);gap:10px;box-sizing:border-box;font-size:var(--font-d1);border-top:1px solid var(--gray-300)}.fav-panel .header{display:flex;flex-flow:row;align-items:baseline;gap:10px;user-select:none;-webkit-user-select:none}.fav-panel .header .title{font-weight:800;font-size:var(--font-u2)}.fav-panel .fav-prompts{display:flex;flex-flow:row;gap:10px}.fav-prompt-slot{width:33%;height:60px;border-radius:10px;display:flex;justify-content:center;align-items:center;border:1px solid var(--gray-300);font-size:var(--font-d2);background-color:#fff;transition:background-color .1s;position:relative}.fav-prompt-slot:hover{box-shadow:0 0 10px #0000000d,0 0 4px #0000000d}.fav-prompt-slot .prompt-mini-card{border-radius:10px;width:100%;height:100%;margin:auto 0;display:flex;flex-flow:row;padding:12px;gap:8px;box-sizing:border-box;pointer-events:none;user-select:none;-webkit-user-select:none}.fav-prompt-slot .prompt-mini-card[is-empty] .title{display:flex;align-items:center;line-height:1;top:-1px;position:relative;color:var(--gray-500)}.fav-prompt-slot .title{display:-webkit-box;line-height:1.2;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.fav-prompt-slot .icon{display:flex;flex-shrink:0;width:28px;height:28px;justify-content:center;align-items:center;vertical-align:middle;text-align:center;transform-origin:center center 0px;background-color:#fff;border-radius:100%;border:1px solid var(--gray-300);position:relative;box-sizing:border-box;transition:box-shadow linear .1s}.fav-prompt-slot .icon span{font-size:34px;transform:scale(.5);color:var(--gray-700);font-weight:700;line-height:1}.prompt-card-container{position:relative;display:flex;width:100%}.prompt-card-container:has(.prompt-card-menu:hover){wordflow-prompt-card {box-shadow: 0 0 10px hsla(0,0%,0%,.05),0 0 4px hsla(0,0%,0%,.05);}}.prompt-card-menu{border-radius:10px;overflow:hidden;min-width:0px;background-color:var(--gray-800);color:var(--gray-100);display:flex;flex-flow:row;align-items:center;position:absolute;top:0;right:10px;transform:translateY(-50%);box-shadow:0 2px 5px #0003;opacity:1;pointer-events:unset;transition:opacity .15s}.prompt-card-menu[is-hidden]{opacity:0;pointer-events:none}.prompt-card-menu button{width:100%;height:100%;padding:5px 7px;cursor:pointer}.prompt-card-menu button:first-child{padding-left:10px}.prompt-card-menu button:last-child{padding-right:10px}.prompt-card-menu button:hover{background-color:var(--gray-600)}.prompt-card-menu button:active{background-color:var(--gray-700)}.prompt-card-menu button .svg-icon{width:13px;height:13px}.prompt-card-menu button.remove-button .svg-icon{padding:2px;box-sizing:border-box}wordflow-prompt-card{width:100%;cursor:grab;border-radius:10px}wordflow-prompt-card.dragging{opacity:.5;cursor:unset}wordflow-prompt-card:hover{box-shadow:0 0 10px #0000000d,0 0 4px #0000000d}@keyframes flash{0%{border-color:var(--gray-700)}50%{border-color:var(--gray-300)}to{border-color:var(--gray-700)}}.panel-local[is-dragging] .prompt-container{overflow:hidden}.panel-local[is-dragging] .fav-prompt-slot[is-temp]{position:absolute;z-index:-1;left:1000px}.panel-local[is-dragging] .fav-prompt-slot:not([is-temp]){border:1px dashed var(--gray-700);animation:flash .9s ease-in-out infinite}.panel-local[is-dragging] .fav-prompt-slot:not([is-temp]).drag-over{background-color:var(--gray-200)}.prompt-content{position:relative;overflow-y:hidden;width:100%;display:flex;flex-flow:column;flex-grow:1;justify-content:space-between;overflow:hidden;box-sizing:border-box}.prompt-modal{width:100%;height:100%;position:absolute;background-color:#ffffffbf}.prompt-modal.hidden{display:none}.popper-tooltip{position:absolute;width:max-content;left:0;top:0;z-index:20;background:var(--gray-800);color:#fff;box-shadow:0 0 1px #0009,0 0 3px #0000000d;padding:0 5px 3px;border-radius:4px;font-size:var(--font-d3);display:flex;justify-content:center;box-sizing:border-box;pointer-events:none;opacity:1;transform:scale(1);transition:opacity .15s,transform .15s}.popper-tooltip.hidden{opacity:0;transform:scale(.8)}.popper-tooltip .popper-content{max-width:200px;max-height:200px;line-height:1.5;overflow:hidden;display:inline;user-select:none;-webkit-user-select:none;text-align:center}.popper-tooltip .popper-content :global(.tooltip-image){width:100px;height:100px;object-fit:contain}.popper-tooltip .popper-content .instruction-text{color:var(--gray-400)}.popper-tooltip .popper-content .warn-text{color:var(--orange-a200)}.popper-tooltip .popper-content .alert-text{color:var(--red-a100)}.popper-tooltip .popper-arrow{position:absolute;background:var(--gray-800);width:8px;height:8px;transform:rotate(45deg);opacity:1}.popper-tooltip .popper-arrow.hidden{opacity:0}
`,dv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 76 77" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-search">
        <path d="M0.149,31.248C0.149,48.386 14.065,62.253 31.204,62.253C37.795,62.253 43.85,60.203 48.879,56.687L67.044,74.9C68.069,75.877 69.338,76.316 70.657,76.316C73.489,76.316 75.54,74.168 75.54,71.336C75.54,69.968 75.003,68.748 74.172,67.82L56.106,49.705C59.963,44.529 62.21,38.181 62.21,31.248C62.21,14.109 48.342,0.193 31.204,0.193C14.065,0.193 0.149,14.109 0.149,31.248ZM7.669,31.248C7.669,18.211 18.167,7.712 31.204,7.712C44.192,7.712 54.739,18.211 54.739,31.248C54.739,44.236 44.192,54.783 31.204,54.783C18.167,54.783 7.669,44.236 7.669,31.248Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,pv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 67 68" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-cross-thick">
        <path d="M2.75,64.708C6.022,67.98 11.735,67.833 14.713,64.855L33.512,46.056L52.213,64.806C55.387,67.98 60.904,67.931 64.176,64.66C67.447,61.388 67.496,55.871 64.322,52.697L45.621,33.947L64.322,15.246C67.496,12.072 67.447,6.554 64.176,3.283C60.904,0.011 55.387,-0.038 52.213,3.136L33.512,21.837L14.713,3.087C11.735,0.109 6.022,-0.038 2.75,3.234C-0.521,6.505 -0.375,12.218 2.604,15.197L21.403,33.947L2.604,52.746C-0.375,55.724 -0.521,61.437 2.75,64.708Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,hv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 79 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-decrease">
        <path d="M4.391,7.34L75.29,7.34C77.292,7.34 78.805,5.777 78.805,3.824C78.805,1.822 77.292,0.26 75.29,0.26L4.391,0.26C2.438,0.26 0.876,1.822 0.876,3.824C0.876,5.777 2.438,7.34 4.391,7.34ZM12.057,27.262L67.868,27.262C69.821,27.262 71.383,25.699 71.383,23.746C71.383,21.793 69.821,20.231 67.868,20.231L12.057,20.231C10.104,20.231 8.542,21.793 8.542,23.746C8.542,25.699 10.104,27.262 12.057,27.262ZM19.528,47.232L60.397,47.232C62.35,47.232 63.913,45.67 63.913,43.668C63.913,41.715 62.35,40.152 60.397,40.152L19.528,40.152C17.575,40.152 16.012,41.715 16.012,43.668C16.012,45.67 17.575,47.232 19.528,47.232Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`,ec='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M202.152-199.761h52.174l342.609-342.848-52.174-52.173-342.609 342.847v52.174ZM772.957-600.37 601.761-769.804l54.565-54.805q23.957-23.956 58.652-24.195 34.696-.239 59.609 24.195l52.652 52.413q24.913 24.435 25.196 58.25.282 33.816-23.674 57.772l-55.804 55.804ZM163.826-116.174q-19.152 0-32.326-13.174t-13.174-32.326v-106.543q0-9.196 3.478-17.653 3.479-8.456 10.196-15.173l411.761-411.761 171.435 171.195-411.761 411.761q-6.718 6.718-15.294 10.196-8.576 3.478-17.771 3.478H163.826Zm407.261-452.522-26.326-26.086 52.174 52.173-25.848-26.087Z"/></svg>',fv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 79" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="icon-plus-circle">
        <path d="M40.249,78.888C61.782,78.888 79.702,61.017 79.702,39.483C79.702,17.95 61.733,0.079 40.2,0.079C18.716,0.079 0.845,17.95 0.845,39.483C0.845,61.017 18.765,78.888 40.249,78.888ZM40.249,71.466C22.524,71.466 8.364,57.257 8.364,39.483C8.364,21.71 22.476,7.501 40.2,7.501C57.974,7.501 72.231,21.71 72.231,39.483C72.231,57.257 58.022,71.466 40.249,71.466Z" style="fill-rule:nonzero;"/>
        <path d="M22.28,39.483C22.28,41.632 23.794,43.097 26.04,43.097L36.538,43.097L36.538,53.692C36.538,55.89 38.003,57.403 40.151,57.403C42.397,57.403 43.862,55.89 43.862,53.692L43.862,43.097L54.458,43.097C56.655,43.097 58.169,41.632 58.169,39.483C58.169,37.286 56.655,35.773 54.458,35.773L43.862,35.773L43.862,25.226C43.862,22.98 42.397,21.466 40.151,21.466C38.003,21.466 36.538,22.98 36.538,25.226L36.538,35.773L26.04,35.773C23.794,35.773 22.28,37.286 22.28,39.483Z" style="fill-rule:nonzero;"/>
    </g>
</svg>
`;var mv=Object.defineProperty,gv=Object.getOwnPropertyDescriptor,we=(n,e,t,r)=>{for(var o=r>1?void 0:r?gv(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&mv(e,t,o),o};const yv=ws,bv=20;let se=class extends Q{constructor(){super(),this.localPrompts=[],this.totalLocalPrompts=0,this.favPrompts=[null,null,null],this.maxPromptCount=24,this.isDraggingPromptCard=!1,this.hoveringPromptCardIndex=null,this.hoveringFavPromptCardIndex=null,this.selectedPrompt=yv[0],this.shouldCreateNewPrompt=!1,this.showSearchBarCancelButton=!1,this.tooltipConfig=null,this.draggingImageElement=null,this.searchBarDebounceTimer=null}firstUpdated(){this.popperElement&&(this.tooltipConfig={tooltipElement:this.popperElement,mouseenterTimer:null,mouseleaveTimer:null})}willUpdate(n){}async initData(){}promptCardClicked(n){if(this.promptModalElement===void 0||this.promptContentElement===void 0)throw Error("promptModalElement is undefined.");this.shouldCreateNewPrompt=!1,this.selectedPrompt=n,this.promptModalElement.style.setProperty("top",`${this.promptContentElement.scrollTop}px`),this.promptModalElement.classList.remove("hidden")}async promptContainerScrolled(){if(this.promptContainerElement===void 0||this.promptLoaderElement===void 0)throw Error("promptContainerElement is undefined");if(this.promptContainerElement.scrollHeight-this.promptContainerElement.scrollTop<=this.promptContainerElement.clientHeight+5&&this.maxPromptCount<this.localPrompts.length){const e=this.promptContainerElement.scrollTop;this.promptLoaderElement.classList.remove("hidden","no-display"),await new Promise(t=>{setTimeout(()=>{t()},800)}),this.maxPromptCount+=bv,await this.updateComplete,this.promptLoaderElement.classList.add("hidden"),this.promptContainerElement.scrollTop=e}this.maxPromptCount>=this.localPrompts.length&&this.promptLoaderElement.classList.add("no-display")}promptCardDragStarted(n){var a;this.isDraggingPromptCard=!0;const e=n.target;e.classList.add("dragging"),document.body.style.setProperty("cursor","grabbing"),this.hoveringPromptCardIndex=null,n.dataTransfer&&(n.dataTransfer.dropEffect="copy",n.dataTransfer.effectAllowed="copy",n.dataTransfer.setData("newPromptData",JSON.stringify(e.promptData)));let t=200;this.shadowRoot&&(t=this.shadowRoot.querySelector(".fav-prompt-slot").getBoundingClientRect().width);const r=document.createElement("div");r.classList.add("fav-prompt-slot"),r.setAttribute("is-temp","true"),r.style.setProperty("width",`${t}px`);const o=document.createElement("div");o.classList.add("prompt-mini-card");const i=document.createElement("span");i.classList.add("icon"),i.innerText=e.promptData.icon;const s=document.createElement("span");s.classList.add("title"),s.innerText=e.promptData.title,o.appendChild(i),o.appendChild(s),r.appendChild(o),document.body.appendChild(r),this.draggingImageElement=r,(a=n.dataTransfer)==null||a.setDragImage(r,10,10)}promptCardDragEnded(n){var t;this.isDraggingPromptCard=!1,n.target.classList.remove("dragging"),document.body.style.removeProperty("cursor"),(t=this.draggingImageElement)==null||t.remove(),this.draggingImageElement=null}favPromptSlotDragEntered(n){n.currentTarget.classList.add("drag-over")}favPromptSlotDragLeft(n){n.currentTarget.classList.remove("drag-over")}favPromptSlotDropped(n,e){if(n.dataTransfer){const r=n.dataTransfer.getData("newPromptData"),o=JSON.parse(r);this.favPrompts[e]=o;const i=structuredClone(this.favPrompts);i[e]=o,this.promptManager.setFavPrompt(e,o)}n.currentTarget.classList.remove("drag-over"),n.preventDefault()}promptCardMouseEntered(n,e){n.preventDefault(),this.hoveringPromptCardIndex=e}promptCardMouseLeft(n){n.preventDefault(),this.hoveringPromptCardIndex=null}modalCloseClickHandler(){if(this.promptModalElement===void 0)throw Error("promptModalElement is undefined.");this.promptModalElement.classList.add("hidden")}creteButtonClicked(){if(this.promptModalElement===void 0)throw Error("promptModalElement is undefined.");this.selectedPrompt=$o(),this.shouldCreateNewPrompt=!0,this.promptModalElement.classList.remove("hidden")}sortOptionChanged(n){const t=n.currentTarget.value;(t==="created"||t==="name"||t==="runCount")&&this.promptManager.sortPrompts(t)}menuIconMouseEntered(n,e){const t=n.currentTarget;let r="";switch(e){case"edit":{r="Edit";break}case"delete":{r="Delete";break}case"remove":{r="Remove favorite prompt";break}default:console.error(`Unknown button ${e}`)}ei(n,r,"top",this.tooltipConfig,200,t,10)}menuIconMouseLeft(){ti(this.tooltipConfig,0)}menuDeleteClicked(n){if(this.confirmDialogComponent===void 0)throw Error("confirmDialogComponent is undefined");const e={header:"Delete Prompt",message:"Are you sure you want to delete this prompt? This action cannot be undone.",yesButtonText:"Delete",actionKey:"delete-prompt-local"};this.confirmDialogComponent.show(e,()=>{this.promptManager.deletePrompt(n)})}searchBarEntered(n){const t=n.currentTarget.value;t.length>0?(this.showSearchBarCancelButton||(this.totalLocalPrompts=this.localPrompts.length),this.showSearchBarCancelButton=!0):this.showSearchBarCancelButton=!1,this.searchBarDebounceTimer!==null&&(clearTimeout(this.searchBarDebounceTimer),this.searchBarDebounceTimer=null),this.searchBarDebounceTimer=setTimeout(()=>{this.promptManager.searchPrompt(t),this.searchBarDebounceTimer=null},150)}showSearchBarCancelButtonClicked(){if(this.shadowRoot===null)throw Error("shadowRoot is null.");const n=this.shadowRoot.querySelector("#search-bar-input");n.value="",this.showSearchBarCancelButton=!1,this.searchBarDebounceTimer!==null&&(clearTimeout(this.searchBarDebounceTimer),this.searchBarDebounceTimer=null),this.searchBarDebounceTimer=setTimeout(()=>{this.promptManager.searchPrompt(""),this.searchBarDebounceTimer=null},150)}render(){let n=M``;for(const[r,o]of this.localPrompts.slice(0,Math.min(this.maxPromptCount,this.localPrompts.length)).entries())n=M`${n}
        <div
          class="prompt-card-container"
          @mouseenter=${i=>{this.promptCardMouseEntered(i,r)}}
          @mouseleave=${i=>{this.promptCardMouseLeft(i)}}
        >
          <div
            class="prompt-card-menu"
            ?is-hidden="${this.hoveringPromptCardIndex!==r}"
          >
            <button
              class="edit-button"
              @mouseenter=${i=>this.menuIconMouseEntered(i,"edit")}
              @mouseleave=${()=>this.menuIconMouseLeft()}
              @click=${()=>{this.promptCardClicked(o)}}
            >
              <span class="svg-icon">${H(ec)}</span>
            </button>

            <button
              class="delete-button"
              @mouseenter=${i=>this.menuIconMouseEntered(i,"delete")}
              @mouseleave=${()=>this.menuIconMouseLeft()}
              @click=${()=>{this.menuDeleteClicked(o)}}
            >
              <span class="svg-icon">${H(fd)}</span>
            </button>
          </div>

          <wordflow-prompt-card
            draggable="true"
            .promptData=${o}
            .isLocalPrompt=${!0}
            @click=${()=>{this.promptCardClicked(o)}}
            @dragstart=${i=>{this.promptCardDragStarted(i)}}
            @dragend=${i=>{this.promptCardDragEnded(i)}}
          ></wordflow-prompt-card>
        </div>`;let e=M``;for(const[r,o]of this.favPrompts.entries())e=M`${e}
        <div
          class="fav-prompt-slot"
          @dragenter=${i=>{this.favPromptSlotDragEntered(i)}}
          @dragleave=${i=>{this.favPromptSlotDragLeft(i)}}
          @dragover=${i=>{i.preventDefault()}}
          @drop=${i=>{this.favPromptSlotDropped(i,r)}}
          @mouseenter=${()=>{this.hoveringFavPromptCardIndex=r}}
          @mouseleave=${()=>{this.hoveringFavPromptCardIndex=null}}
        >
          <div
            class="prompt-card-menu"
            ?is-hidden="${this.hoveringFavPromptCardIndex!==r||o===null}"
          >
            <button
              class="edit-button"
              @mouseenter=${i=>this.menuIconMouseEntered(i,"edit")}
              @mouseleave=${()=>this.menuIconMouseLeft()}
              @click=${()=>{this.promptCardClicked(o)}}
            >
              <span class="svg-icon">${H(ec)}</span>
            </button>

            <button
              class="remove-button"
              @mouseenter=${i=>this.menuIconMouseEntered(i,"remove")}
              @mouseleave=${()=>this.menuIconMouseLeft()}
              @click=${()=>{this.promptManager.setFavPrompt(r,null)}}
            >
              <span class="svg-icon">${H(ir)}</span>
            </button>
          </div>

          <div class="prompt-mini-card" ?is-empty=${o===null}>
            <span class="icon">${o?o.icon:""}</span>
            <span class="title"
              >${o?o.title:"Drag a prompt here"}</span
            >
          </div>
        </div>`;let t=M`${this.promptManager.localPromptCount} Prompts`;return this.showSearchBarCancelButton&&(t=M`${this.promptManager.localPromptBroadcastCount} /
      ${this.promptManager.localPromptCount} Prompts`),M`
      <div class="panel-local" ?is-dragging=${this.isDraggingPromptCard}>
        <div class="prompt-panel">
          <div class="search-panel">
            <div class="search-group">
              <div class="result">${t}</div>

              <button
                class="create-button"
                @click=${()=>this.creteButtonClicked()}
              >
                <span class="svg-icon">${H(fv)}</span>New Prompt
              </button>
            </div>

            <div class="search-group">
              <div class="search-bar">
                <span class="icon-container">
                  <span class="svg-icon">${H(dv)}</span>
                </span>

                <input
                  id="search-bar-input"
                  type="text"
                  name="search-bar-input"
                  @input=${r=>this.searchBarEntered(r)}
                  placeholder="Search my prompts"
                />

                <span
                  class="icon-container"
                  @click=${()=>this.showSearchBarCancelButtonClicked()}
                  ?is-hidden=${!this.showSearchBarCancelButton}
                >
                  <span class="svg-icon cross">${H(pv)}</span>
                </span>
              </div>

              <div class="sort-button">
                <span class="svg-icon">${H(hv)}</span>
                <select
                  class="sort-selection"
                  @input=${r=>this.sortOptionChanged(r)}
                >
                  <option value="created">Recency</option>
                  <option value="name">Name</option>
                  <option value="runCount">Run Count</option>
                </select>
              </div>
            </div>
          </div>

          <div class="prompt-content">
            <div
              class="prompt-container"
              @scroll=${()=>{this.promptContainerScrolled()}}
            >
              ${n}

              <div class="prompt-loader hidden">
                <div class="loader-container">
                  <div class="circle-loader"></div>
                </div>
              </div>
            </div>

            <div class="fav-panel">
              <div class="header">
                <span class="title">Favorite Prompts</span>
                <span class="description"
                  >Drag prompts here to customize the toolbar</span
                >
              </div>

              <div class="fav-prompts">${e}</div>
            </div>

            <div class="prompt-modal hidden">
              <wordflow-prompt-editor
                .promptData=${this.selectedPrompt?this.selectedPrompt:$o()}
                .isNewPrompt=${this.shouldCreateNewPrompt}
                .promptManager=${this.promptManager}
                @close-clicked=${()=>this.modalCloseClickHandler()}
              ></wordflow-prompt-editor>
            </div>
          </div>
        </div>

        <nightjar-confirm-dialog></nightjar-confirm-dialog>

        <div
          id="popper-tooltip-local"
          class="popper-tooltip hidden"
          role="tooltip"
        >
          <span class="popper-content"></span>
          <div class="popper-arrow"></div>
        </div>
      </div>
    `}};se.styles=[be`
      ${oe(uv)}
    `];we([O({attribute:!1})],se.prototype,"promptManager",2);we([O({attribute:!1})],se.prototype,"localPrompts",2);we([I()],se.prototype,"totalLocalPrompts",2);we([O({attribute:!1})],se.prototype,"favPrompts",2);we([I()],se.prototype,"maxPromptCount",2);we([I()],se.prototype,"isDraggingPromptCard",2);we([I()],se.prototype,"hoveringPromptCardIndex",2);we([I()],se.prototype,"hoveringFavPromptCardIndex",2);we([I()],se.prototype,"selectedPrompt",2);we([I()],se.prototype,"shouldCreateNewPrompt",2);we([Y(".prompt-content")],se.prototype,"promptContentElement",2);we([Y(".prompt-container")],se.prototype,"promptContainerElement",2);we([Y(".prompt-loader")],se.prototype,"promptLoaderElement",2);we([Y(".prompt-modal")],se.prototype,"promptModalElement",2);we([Y("#popper-tooltip-local")],se.prototype,"popperElement",2);we([Y("nightjar-confirm-dialog")],se.prototype,"confirmDialogComponent",2);se=we([ve("wordflow-panel-local")],se);const $o=()=>({...ii(),key:mn()}),vv=`.panel-setting{--padding-h: 20px;--padding-v: 12px;--focus-border-color: var(--blue-200);width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;box-sizing:border-box;background-color:#fff}button{all:unset}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.header{padding:var(--padding-v) var(--padding-h) var(--padding-v) var(--padding-h);width:100%;border-bottom:1px solid var(--gray-300);box-sizing:border-box;display:flex;align-items:center;flex-flow:row;font-size:var(--font-u2);line-height:1;gap:16px;font-weight:800}.setting-form{flex:1 0 auto;padding:var(--padding-v) var(--padding-h) var(--padding-v) var(--padding-h);display:flex;flex-flow:column;justify-content:flex-start;gap:12px;width:100%;box-sizing:border-box}.two-section-container{display:flex;flex-flow:row nowrap;align-items:center;justify-content:flex-start;gap:20px;margin-bottom:12px;width:100%}.content-block{display:flex;flex-flow:column;align-items:flex-start;gap:2px;input[type="text"] {all: unset; border: 1px solid var(--gray-300); border-radius: 5px; padding: 5px 5px; width: 100%; box-sizing: border-box; &:focus {outline: 2px solid var(--focus-border-color); border: 1px solid var(--focus-border-color);} &::placeholder {color: var(--gray-600);}} textarea {border: 1px solid var(--gray-300); border-radius: 5px; padding: 5px 5px; width: 100%; box-sizing: border-box; font-family: inherit; font-size: unset; resize: vertical; &:focus {outline: 2px solid var(--focus-border-color); border: 1px solid var(--focus-border-color);} &.prompt-input {height: 150px;} &.prompt-description {height: 80px;} &::placeholder {color: var(--gray-600);}} .content-icon-wrapper {display: flex; flex-flow: row nowrap; gap: 5px;} .name-row {display: flex; flex-flow: row nowrap; align-items: baseline; gap: 5px; color: var(--gray-400); user-select: none; -webkit-user-select: none; .name-container {display: flex; align-items: baseline; gap: 5px; cursor: help;} .info-icon {position: relative; width: 13px; height: 13px; top: 1px;} .name-info {color: var(--gray-600); & a {color: var(--gray-600);}} .name.required-name {&:after {content: "*"; position: relative; left: 2px; color: var(--red-300);}}} .length-input-container {width: 100%; display: flex; flex-flow: row nowrap; align-items: stretch; position: relative; gap: 10px; .input-container {flex: 1 1 auto; position: relative; .right-loader {position: absolute; display: flex; top: 50%; right: 1px; transform: translate(0px,-50%);}}}}.content-block.content-block-title{flex:0 1 auto}.content-block.content-block-api{flex:1 1 auto}.content-block[no-show]{display:none}.content-block .name{font-weight:800;color:var(--gray-600)}.content-block .content-text{line-height:1.25}.model-button{border:1px solid var(--gray-300);border-radius:5px;padding:5px;width:150px;box-sizing:border-box;position:relative;cursor:pointer}.model-button:focus{outline:2px solid var(--focus-border-color);border:1px solid var(--focus-border-color)}.model-button:hover{background-color:color-mix(in lab,var(--gray-300),white 60%)}.model-button select{position:absolute;align-self:baseline;width:100%;height:100%;opacity:0;top:0;left:0;cursor:pointer}.model-button .model-mode-text{cursor:pointer}.model-button .model-mode-text:after{content:"";position:absolute;top:60%;right:11px;width:7px;height:2px;background-color:var(--gray-500);transform-origin:left;transform:rotate(-45deg)}.model-button .model-mode-text:before{content:"";position:absolute;top:60%;right:10px;width:7px;height:2px;background-color:var(--gray-500);transform-origin:left;transform:rotate(-135deg)}.add-button{line-height:1;display:flex;gap:5px;align-items:center;padding:0 12px;background-color:var(--green-600);color:#fff;border-radius:5px;font-weight:500;cursor:pointer}.add-button:hover{background-color:color-mix(in lab,var(--green-600),white 7%)}.add-button:active{background-color:color-mix(in lab,var(--green-600),white 0%)}.add-button[has-set]{background-color:var(--gray-600);cursor:not-allowed}.add-button[has-set]:hover,.add-button[has-set]:active{background-color:var(--gray-600)}@keyframes circle-loader-animation{to{transform:rotate(1turn)}}.prompt-loader{display:flex;pointer-events:all;background-color:#ffffffe6;padding-right:8px;z-index:2;opacity:1;transition:opacity .15s}.prompt-loader.no-display{display:none}.prompt-loader.hidden,.prompt-loader[is-hidden]{opacity:0;pointer-events:none}.prompt-loader .circle-loader{width:12px;height:12px;border:3px solid}.loader-container{display:flex;flex-direction:row;gap:10px;align-items:center;white-space:nowrap;color:var(--gray-700);line-height:1;font-size:var(--font-u2)}.loader-container .circle-loader{width:12px;height:12px;border-radius:50%;border:3px solid;border-color:color-mix(in lab,var(--gray-300) 100%,white 30%);border-right-color:var(--gray-500);animation:circle-loader-animation 1s infinite linear}.toast-container{position:absolute;top:7px;z-index:1;width:100%;display:flex;justify-content:center;nightjar-toast {max-width: 300px;}}.popper-tooltip{position:absolute;width:max-content;left:0;top:0;z-index:20;background:var(--gray-800);color:#fff;box-shadow:0 0 1px #0009,0 0 3px #0000000d;padding:0 5px 3px;border-radius:4px;font-size:var(--font-d3);display:flex;justify-content:center;box-sizing:border-box;pointer-events:none;opacity:1;transform:scale(1);transition:opacity .15s,transform .15s}.popper-tooltip.hidden{opacity:0;transform:scale(.8)}.popper-tooltip .popper-content{max-width:200px;max-height:200px;line-height:1.5;overflow:hidden;display:inline;user-select:none;-webkit-user-select:none;text-align:center}.popper-tooltip .popper-content :global(.tooltip-image){width:100px;height:100px;object-fit:contain}.popper-tooltip .popper-content .instruction-text{color:var(--gray-400)}.popper-tooltip .popper-content .warn-text{color:var(--orange-a200)}.popper-tooltip .popper-content .alert-text{color:var(--red-a100)}.popper-tooltip .popper-arrow{position:absolute;background:var(--gray-800);width:8px;height:8px;transform:rotate(45deg);opacity:1}.popper-tooltip .popper-arrow.hidden{opacity:0}
`;var Dv=Object.defineProperty,wv=Object.getOwnPropertyDescriptor,vt=(n,e,t,r)=>{for(var o=r>1?void 0:r?wv(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Dv(e,t,o),o};const xv={[Pe["gpt-3.5"]]:"Open AI",[Pe["gpt-3.5-free"]]:"Open AI",[Pe["gpt-4"]]:"Open AI",[Pe["gemini-pro"]]:"Gemini"},Cv={[Lt.openAI]:M`Get the key at
    <a href="https://platform.openai.com/api-keys" target="_blank"
      >Open AI API</a
    >`,[Lt.google]:M`Get the key at
    <a href="https://makersuite.google.com/" target="_blank"
      >Google AI Studio</a
    >`};let Qe=class extends Q{constructor(){super(),this.apiInputValue="",this.showModelLoader=!1,this.toastMessage="",this.toastType="success",this.tooltipConfig=null,this.textGenMessageHandler=(n,e,t)=>{var r,o;switch(t.command){case"finishTextGen":{if(t.payload.requestID.includes("auth")){const i=ua[n];this.userConfigManager.setAPIKey(i,e),this.selectedModel===n&&this.userConfigManager.setPreferredLLM(n),this.toastMessage="Successfully added an API key",this.toastType="success",(r=this.toastComponent)==null||r.show()}break}case"error":{t.payload.originalCommand==="startTextGen"&&(console.error(t),this.toastMessage="Invalid API key. Try a different key.",this.toastType="error",(o=this.toastComponent)==null||o.show());break}default:{console.error("TextGen message handler: unknown message");break}}},this.selectedModel=Pe["gpt-3.5-free"]}get selectedModelFamily(){return ua[this.selectedModel]}willUpdate(n){if(n.has("userConfig")&&this.selectedModel!==this.userConfig.preferredLLM){this.selectedModel=this.userConfig.preferredLLM;const e=this.shadowRoot.querySelector(".model-mode-select");e.value=lo[this.selectedModel]}}firstUpdated(){this.popperElement&&(this.tooltipConfig={tooltipElement:this.popperElement,mouseenterTimer:null,mouseleaveTimer:null})}async initData(){}addButtonClicked(n){if(n.preventDefault(),this.userConfig.llmAPIKeys[this.selectedModelFamily]===this.apiInputValue||this.apiInputValue==="")return;if(this.shadowRoot===null)throw Error("shadowRoot is null");const e="auth-call",t="The color of sky is",r=.8,o=this.apiInputValue;switch(this.showModelLoader=!0,this.selectedModelFamily){case Lt.google:{mc(o,e,t,r,!1).then(i=>{this.showModelLoader=!1,this.textGenMessageHandler(this.selectedModel,o,i)});break}case Lt.openAI:{co(o,e,t,r,"gpt-3.5-turbo",!1).then(i=>{this.showModelLoader=!1,this.textGenMessageHandler(this.selectedModel,o,i)});break}default:console.error(`Unknown model ${this.selectedModelFamily}`)}}modelSelectChanged(n){const e=n.currentTarget;this.selectedModel=Pe[e.value],this.apiInputValue=this.userConfig.llmAPIKeys[this.selectedModelFamily],this.selectedModel===Pe["gpt-3.5-free"]?this.userConfigManager.setPreferredLLM(this.selectedModel):this.userConfig.llmAPIKeys[this.selectedModelFamily]!==""&&this.userConfigManager.setPreferredLLM(this.selectedModel)}infoIconMouseEntered(n,e){let t="";switch(e){case"model":{t="Preferred LLM model to run the prompts";break}case"api-key":{t="Enter the API key to call the LLM model";break}default:console.error(`Unknown type ${e}`)}const r=n.currentTarget.querySelector(".info-icon");ei(n,t,"top",this.tooltipConfig,200,r,10)}infoIconMouseLeft(){ti(this.tooltipConfig)}render(){let n=M``;for(const[e,t]of Object.entries(Pe))n=M`${n}
        <option value=${e}>${t}</option> `;return M`
      <div class="panel-setting">
        <div class="toast-container">
          <nightjar-toast
            message=${this.toastMessage}
            type=${this.toastType}
          ></nightjar-toast>
        </div>

        <div class="header">
          <span class="name">Settings</span>
        </div>

        <form class="setting-form">
          <div class="two-section-container">
            <section class="content-block content-block-title">
              <div class="name-row">
                <div
                  class="name-container"
                  @mouseenter=${e=>{this.infoIconMouseEntered(e,"model")}}
                  @mouseleave=${()=>{this.infoIconMouseLeft()}}
                >
                  <div class="name">Preferred Model</div>
                  <span class="svg-icon info-icon"
                    >${H(je)}</span
                  >
                </div>
              </div>

              <span class="model-button">
                <span class="model-mode-text">${this.selectedModel}</span>
                <select
                  class="model-mode-select"
                  value="${lo[this.selectedModel]}"
                  @change=${e=>this.modelSelectChanged(e)}
                >
                  ${n}
                </select>
              </span>
            </section>

            <section
              class="content-block content-block-api"
              ?no-show=${this.selectedModel===Pe["gpt-3.5-free"]}
            >
              <div class="name-row">
                <div
                  class="name-container"
                  @mouseenter=${e=>{this.infoIconMouseEntered(e,"api-key")}}
                  @mouseleave=${()=>{this.infoIconMouseLeft()}}
                >
                  <div class="name">
                    ${xv[this.selectedModel]} API Key
                  </div>
                  <span class="svg-icon info-icon"
                    >${H(je)}</span
                  >
                </div>
                <span class="name-info"
                  >${Cv[this.selectedModelFamily]}</span
                >
              </div>

              <div class="length-input-container">
                <div class="input-container">
                  <input
                    type="text"
                    class="content-text api-input"
                    id="text-input-api"
                    value="${this.userConfig.llmAPIKeys[this.selectedModelFamily]}"
                    placeholder=""
                    @input=${e=>{const t=e.currentTarget;this.apiInputValue=t.value}}
                  />
                  <div class="right-loader">
                    <div
                      class="prompt-loader"
                      ?is-hidden=${!this.showModelLoader}
                    >
                      <div class="loader-container">
                        <div class="circle-loader"></div>
                      </div>
                    </div>
                  </div>
                </div>
                <button
                  class="add-button"
                  ?has-set=${this.userConfig.llmAPIKeys[this.selectedModelFamily]===this.apiInputValue||this.apiInputValue===""}
                  @click=${e=>this.addButtonClicked(e)}
                >
                  ${this.userConfig.llmAPIKeys[this.selectedModelFamily]===""?"Add":"Update"}
                </button>
              </div>
            </section>
          </div>
        </form>

        <div
          id="popper-tooltip-setting"
          class="popper-tooltip hidden"
          role="tooltip"
        >
          <span class="popper-content"></span>
          <div class="popper-arrow"></div>
        </div>
      </div>
    `}};Qe.styles=[be`
      ${oe(vv)}
    `];vt([O({attribute:!1})],Qe.prototype,"userConfigManager",2);vt([O({attribute:!1})],Qe.prototype,"userConfig",2);vt([I()],Qe.prototype,"selectedModel",2);vt([I()],Qe.prototype,"apiInputValue",2);vt([I()],Qe.prototype,"showModelLoader",2);vt([I()],Qe.prototype,"toastMessage",2);vt([I()],Qe.prototype,"toastType",2);vt([Y("nightjar-toast")],Qe.prototype,"toastComponent",2);vt([Y("#popper-tooltip-setting")],Qe.prototype,"popperElement",2);Qe=vt([ve("wordflow-panel-setting")],Qe);const kv=`.setting-window{--padding-v: 12px;--padding-h: 24px;width:100%;height:100%;position:absolute;top:0;left:0;z-index:10;background-color:#0006;animation:fade-in .15s ease-in-out}.setting-window.displayed{display:flex}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.window{background-color:#fff;box-shadow:0 0 10px #0000001a;border-radius:8px;overflow:hidden;width:max-content;max-width:calc(100% - 40px);box-sizing:border-box;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.header{width:100%;padding:var(--padding-v) var(--padding-h);display:flex;justify-content:space-between;align-items:center;color:var(--gray-800);border-bottom:1px solid var(--gray-300);box-sizing:border-box}.header .name{font-weight:500}.header .svg-icon{width:23px;height:23px;padding:5px;box-sizing:border-box;position:relative;cursor:pointer;color:var(--gray-600);transition:color .1s}.header .svg-icon:before{z-index:-1;content:"";position:absolute;top:50%;left:50%;transform-origin:center;transform:translate(-50%,-50%) scale(0);border-radius:50%;background-color:var(--gray-100);width:100%;height:100%;transition:transform .1s}.header .svg-icon:hover{color:var(--gray-700)}.header .svg-icon:hover:before{transform:translate(-50%,-50%) scale(1.4)}.header .svg-icon:active:before{transform:translate(-50%,-50%) scale(1.6)}.content{display:flex;flex-flow:row;align-items:stretch}.content .menu{display:flex;flex-flow:column;font-size:var(--font-d1);border-right:1px solid var(--gray-300)}.content .menu .menu-item{--bold-weight: 600;display:inline-flex;flex-direction:column;align-items:flex-start;justify-content:space-between;position:relative;line-height:1;cursor:pointer;padding:15px var(--padding-h) 15px 20px;border-top-left-radius:5px;border-bottom-left-radius:5px}.content .menu .menu-item:after{content:attr(data-text);height:0;visibility:hidden;overflow:hidden;-webkit-user-select:none;user-select:none;pointer-events:none;font-weight:var(--bold-weight)}.content .menu .menu-item:first-child{padding-top:16px}.content .menu .menu-item:hover{background-color:color-mix(in lab,var(--gray-200),white 60%)}.content .menu .menu-item[selected]{font-weight:var(--bold-weight);background-color:color-mix(in lab,var(--gray-200),white 20%)}.content .menu .menu-item[selected]:before{content:"";height:80%;width:4px;border-radius:5px;background-color:var(--blue-600);position:absolute;top:50%;left:2px;transform:translateY(-50%)}.content .panel{display:flex;align-items:center;justify-content:center;width:700px;height:560px;box-sizing:border-box;position:relative}.content .panel *{width:100%;height:100%}.setting-panel{position:absolute;width:100%;height:100%;display:none}.setting-panel[is-shown]{display:flex}.toast-container{position:absolute;top:7px;z-index:1;width:100%;display:flex;justify-content:center;nightjar-toast {max-width: 300px;}}.slider-container{display:flex;flex-flow:row nowrap;align-items:center;width:100%;gap:10px;input[type="text"].content-text {width: 48px;} nightjar-slider {width: 250px;}}
`;var Ev=Object.defineProperty,Mv=Object.getOwnPropertyDescriptor,Ye=(n,e,t,r)=>{for(var o=r>1?void 0:r?Mv(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Ev(e,t,o),o};let $e=class extends Q{constructor(){super(),this.localPrompts=[],this.favPrompts=[null,null,null],this.remotePrompts=[],this.popularTags=[],this.activeMenuItemIndex=0,this.toastMessage="",this.toastType="success"}willUpdate(n){}firstUpdated(){this.remotePromptManager.getPromptsByTag("","popular"),this.remotePromptManager.getPopularTags()}async initData(){}menuItemClicked(n){this.activeMenuItemIndex=n}promptViewerAddClickHandler(n){if(!this.toastComponent)throw Error("Toast is undefined.");const t={...n.detail,key:mn()};let r=localStorage.getItem("user-id");r===null&&(console.warn("userID is not set."),r=mn(),localStorage.setItem("user-id",r)),t.created=new Date().toISOString(),t.userName="",t.userID=r,t.promptRunCount=0,this.promptManager.addPrompt(t),this.toastMessage="Added the prompt to My Prompts.",this.toastType="success",this.toastComponent.show(),this.activeMenuItemIndex=0}closeButtonClicked(){const n=new Event("close-button-clicked",{bubbles:!0,composed:!0});this.dispatchEvent(n)}backgroundClicked(n){n.target.classList.contains("setting-window")&&this.closeButtonClicked()}render(){const n=[{name:"My Prompts",component:M`<wordflow-panel-local
          class="setting-panel"
          ?is-shown=${this.activeMenuItemIndex===0}
          .promptManager=${this.promptManager}
          .localPrompts=${this.localPrompts}
          .favPrompts=${this.favPrompts}
        ></wordflow-panel-local>`},{name:"Community",component:M`<wordflow-panel-community
          class="setting-panel"
          ?is-shown=${this.activeMenuItemIndex===1}
          .remotePromptManager=${this.remotePromptManager}
          .remotePrompts=${this.remotePrompts}
          .popularTags=${this.popularTags}
          @add-clicked=${r=>this.promptViewerAddClickHandler(r)}
        ></wordflow-panel-community>`},{name:"Settings",component:M`<wordflow-panel-setting
          class="setting-panel"
          .userConfigManager=${this.userConfigManager}
          .userConfig=${this.userConfig}
          ?is-shown=${this.activeMenuItemIndex===2}
        ></wordflow-panel-setting>`}];let e=M``;for(const[r,o]of n.entries())e=M`${e}
        <div
          class="menu-item"
          data-text="${o.name}"
          ?selected=${this.activeMenuItemIndex===r}
          @click=${()=>this.menuItemClicked(r)}
        >
          ${o.name}
        </div> `;let t=M``;for(const r of n)t=M`${t} ${r.component} `;return M`
      <div
        class="setting-window"
        @click=${r=>this.backgroundClicked(r)}
      >
        <div class="window">
          <div class="toast-container">
            <nightjar-toast
              id="setting-toast"
              message=${this.toastMessage}
              type=${this.toastType}
            ></nightjar-toast>
          </div>

          <div class="header">
            <div class="name">Wordflow Settings</div>
            <div
              class="svg-icon close-button"
              @click=${()=>this.closeButtonClicked()}
            >
              ${H(ir)}
            </div>
          </div>
          <div class="content">
            <div class="menu">${e}</div>
            <div class="panel">${t}</div>
          </div>
        </div>
      </div>
    `}};$e.styles=[be`
      ${oe(kv)}
    `];Ye([O({attribute:!1})],$e.prototype,"promptManager",2);Ye([O({attribute:!1})],$e.prototype,"localPrompts",2);Ye([O({attribute:!1})],$e.prototype,"favPrompts",2);Ye([O({attribute:!1})],$e.prototype,"remotePromptManager",2);Ye([O({attribute:!1})],$e.prototype,"remotePrompts",2);Ye([O({attribute:!1})],$e.prototype,"popularTags",2);Ye([O({attribute:!1})],$e.prototype,"userConfigManager",2);Ye([O({attribute:!1})],$e.prototype,"userConfig",2);Ye([I()],$e.prototype,"activeMenuItemIndex",2);Ye([I()],$e.prototype,"toastMessage",2);Ye([I()],$e.prototype,"toastType",2);Ye([Y("nightjar-toast#setting-toast")],$e.prototype,"toastComponent",2);$e=Ye([ve("wordflow-setting-window")],$e);const Tv=M`<strong>Summary</strong>
Pursuant to EU and UK data protection laws, the Georgia Institute of Technology (“Georgia Tech”) must provide you with information relating to how it will process your personal data as a participant in the research project administered by the College of Computing, Principal Investigator Duen Horng Chau  (the “PI”), Research Title “Wordflow: Interactive System for Text Editing with Large Language Models”, Research Protocol No. H23511 (collectively, the “Research Project”). 
The purpose of the Research Project is to understand user interaction patterns and preferences when using large language models.
<strong>Data Controller</strong> 
Personal data is any information that identifies you directly or indirectly, such as your name, email address and phone number and your Research Project participant number.  Georgia Tech will be the controller of your personal data. This means that Georgia Tech will be responsible for decisions taken regarding how and why your personal data is processed. 
Georgia Tech is an institution of higher education involved in education, research, and community development.  In order for Georgia Tech to conduct human subjects research, it must collect, use and process personal data related to the participants in the Research Project.
<strong>Types of Personal Data Collected</strong>
In order for Georgia Tech and the PI to conduct the Research Project, the following categories of personal data may be collected:
•	The prompt you run or share (e.g., “Make the following text grammatically correct.”)
•	Timestamp (e.g., Dec 1 2023 08:00:00 GMT-0500)
•	AI model hyperparameters (e.g., temperature settings)
Some of the data we might process about you is considered ‘special category data’. Special category data includes biometric data, genetic data, information about your health and sex life or orientation and any information that reveals your racial or ethnic origin, religious, political or philosophical beliefs and trade union membership information. 
For example, we might process special category data about you if you complete a form, email us or otherwise share with us any information concerning your religious or political beliefs or information relating to your ethnicity. 
<strong>Purposes and Lawful Bases for Collecting and Processing of Personal Data</strong>
Facilitating the Research Project: Georgia Tech will mainly use your information to facilitate the running of the Research Project and your participation in the Research Project. 
As part of the Research Project, Georgia Tech might review and analyze your personal data and create profiles about you and other Research Project participants.  The information you provide during the Research Project, or any profiles created about you might be compared to information provided by and profiles created about other participants. We might make observations and deduce information from the personal data you provide to us. 
Our lawful basis for collecting and otherwise processing your personal data for you to enroll and take part in the Research Project would be the performance of steps prior to entering into a contract with you and for the purposes of administering the contract we have with you, namely, the Research Project participation terms you sign up to. 
We might also process your personal data as part of running the Research Project for our legitimate interests, such as brand recognition, including the reputational benefits of publishing the results of the Research Project.
Our lawful bases for the processing of your special category data in the course of running the Research project will be your consent and explicit consent. 
You can withdraw your consent at any time. Please note that the withdrawal of your consent will not, however, affect, the lawfulness of the processing of your data carried out up until the withdrawal of your consent. 
Safety Reporting and Inspection Compliance:  In addition, we may process your personal data to comply with our legal obligations related to safety reporting or an inspection by a competent authority, including such authorities listed in the table under the section entitled Sources of Data and Data Transfers to Third Parties.
<strong>Other purposes:</strong>
We might process your personal data in accordance with our legitimate interests in bringing and defending ourselves against legal claims. If your special category data is processed as part of establishing, exercising or defending legal claims, such establishment, exercise or defense of legal claims will also be the lawful basis for the processing. 
Georgia Tech may also disclose certain personal information connected to your participation in the Research Project under FERPA. The Family Educational Rights and Privacy Act (FERPA) provides that “Directory Information” is information not generally considered harmful or an invasion of privacy if disclosed. Directory Information is considered public information, but the categories of information that comprise Directory Information also comprise “personal data” under the GDPR (inter alia name, address, telephone number, date and place of birth). The lawful basis for this disclosure is our legitimate interest in increasing awareness on the activities carried out by Georgia Tech for brand recognition purposes.  Please review Georgia Tech's Annual Notice of Directory Information Contents for further information, including how to object to the release of Directory Information.
Refusal to Provide Personal Data 
If you refuse to provide personal data that is required by Georgia Tech in connection with one of Georgia Tech’s lawful bases to collect such personal data, such refusal might not allow you to take part or continued taking part in the Research Project. 
Sources of Data and Data Transfers to Third Parties
We will primarily receive personal data about you directly from you. For example, when you complete a form in which you provide details about you and as part of you taking part in the Research Project. 
We may also collect and share personal data with service providers who help us recruit participants and facilitate the Research Project such as Prolifics and Amazon and operating applications which help us run the Research Project such as Zoom, Microsoft (Microsoft Teams), Meta (WhatsApp) and Box. 
Additionally, the personal data collected for the Research Project might be shared with the (a) U.S.  Federal Food and Drug Administration; (b) U.S. Office of Human Research Protection and (c) Board of Regents of the University System of Georgia (the “BOR”) so they may exercise governance and oversight over Georgia Tech’s activities in compliance with U.S. federal and state law.
<strong>International Transfers of Personal Data</strong>
Some of the above service providers and institutions may be located in countries, such as the United States, that do not recognize a level of privacy protection equivalent to that in the EEA. Please do not take part in the Research Project if this is unacceptable to you.
<strong>Individual Data Subject Rights</strong>
You have the following rights with respect to your personal data, which apply differently in different circumstances: right of access, right to rectification, right to erasure, right to restriction of processing, right to data portability, and you also have the right to object to processing and to be informed. 
Please see below for a brief description of each of these rights.  
Access: Upon request, you are entitled to confirmation that we process your personal data and to receive a copy of your personal data. 
Rectification: If the personal data we hold about you is incorrect, you have the right for it to be rectified. 
Erasure: You can request us to erase your personal data including when there is no compelling reason for us to continue processing it, if (a) we rely on your consent for the processing of your personal data and you withdraw your consent; (b) we rely on legitimate interests for the processing and there are no overriding legitimate interests to continue the processing; (c) we have to erase the information to comply with a legal obligation; or (d) we have processed the information unlawfully. 
Restriction: You may request a restriction on the processing we undertake on your personal data.  This right will only apply if (a) you contest the accuracy of your personal data; (b) the data has been unlawfully processed and you oppose erasure and request restriction instead; or (c) we no longer need the personal data, but you need us to keep it in order to establish, exercise or defend a legal claim. 
Objection: You may object to our processing of your personal data if our processing is carried out on the basis of our legitimate interests. Please note, however, that should we determine that our interests are so compelling as to override your objection we may continue to process your personal data. 
Portability: You may have the right to receive some of your personal data in machine readable format.  This right allows you to request that such data be sent to a third-party controller.
Withdrawing consent: If the lawful basis we rely on to process your personal data is consent, you have the right to withdraw this consent. Please email the PI Duen Horng Chau at polo@gatech.edu to withdraw consent for the processing of your personal data.
To withdraw your consent for the processing of your personal data by a third party, please contact the relevant organization.
Your right to be informed: You can contact us to find out more or to ask any questions you may have about our use of your personal data. 
Note: Exercising of these rights is a guarantee to be afforded a process and not the guarantee of an outcome.  
Any data subject who wishes to exercise any of the above-mentioned rights may do so by filing such request with the PI Duen Horng Chau at polo@gatech.edu.
You also have the right to lodge a complaint with the competent local Data Protection Supervisory Authority. 
<strong>Security of Personal Data Subject to the GDPR</strong>
All personal data and special categories of personal data collected or processed by Georgia Tech must comply with the security controls and systems and process requirements and standards of NIST Special Publication 800-171 as set forth in the Georgia Tech Controlled Unclassified Information Policy.
<strong>Georgia Open Records Act</strong>
As a state university, Georgia Tech is subject to the provisions of the Georgia Open Records Act (ORA). Except for those records that are exempt from disclosure under the ORA, the ORA provides that all citizens are entitled to view the records of state agencies on request and to make copies for a fee. The ORA requires that Georgia Tech produce public documents within three business days. For more information on Georgia Tech’s ORA compliance, please visit the Open Records Act page on the Legal Affairs website.  
<strong>Data Retention</strong>
Personal data collected in this study will be held for 3 years.
If you have specific questions regarding the collection and use of your personal data, please contact the Principal Investigator Duen Horng Chau at polo@gatech.edu.
For more information regarding these EU and UK data protection regulations, please review Georgia Tech’s EU General Data Protection Regulation Compliance Policy and/or the ICO Guide to Data Protection Principles. 
`,Sv=M`1) Pursuant to the Personal Information Protection Law (PIPL) of the People’s Republic of China (the PRC), the Georgia Institute of Technology (“Georgia Tech”), in its capacity as a personal information handler under the PIPL,  must obtain your explicit, affirmative consent before it can collect or process any personal information (including sensitive personal information) for a lawful basis, including, but not limited to, employment, admission and enrollment, study abroad, internship abroad, online education, research, etc.  For information on how Georgia Tech uses data, please review Georgia Tech’s Privacy Notice at: http://www.gatech.edu/privacy
依据中华人民共和国（中国）《个人信息保护法》（“《个保法》”），佐治亚理工学院（“佐治亚理工”），作为《个保法》下的个人信息处理者，为合法之基础（包括但不限于雇佣、录取和注册、海外学习、海外实习、在线教育、研究等）收集或处理任何个人信息（包括敏感个人信息）之前，必须取得您明示且确定的同意。关于佐治亚理工如何使用数据的更多资讯，请参见：http://www.gatech.edu/privacy。

2) Personal information is all kinds of information, recorded by electronic or other means, related to identified or identifiable natural persons, excluding information after anonymization handling.   
个人信息是以电子或其他方式记录的与识别或者可识别的自然人有关的各种信息，不包括匿名化处理后的信息。

3) Sensitive personal information specially refers to information on biometric characteristics, religious beliefs, specially-designed status, medical health, financial accounts, individual location tracking, etc, as well as the personal information of minors under the age of 14.
敏感个人信息特指生物识别、宗教信仰、医疗健康、金融账户、行踪轨迹等信息，以及不满十四周岁未成年人的个人信息。

4) Any personal information that is collected from you will be for the sole purpose of participation in a research study H23511: “Wordflow: Interactive System for Text Editing with Large Language Models” and is necessary for that purpose.  This may include processing the personal information as required to execute contractual obligations in connection with the previously described purpose and compliance with applicable laws, to execute the obligations to you concerning your participation in a research study H23511: “Wordflow: Interactive System for Text Editing with Large Language Models”.
自您处收集的任何个人信息将仅为参与研究为目的H23511: “Wordflow: Interactive System for Text Editing with Large Language Models”，且为该目的所必须。这可能包括根据需要处理个人信息以履行与前述目的相关的合约义务、遵守适用的法律，以及履行与您参与研究相关的义务等。

Any personal information provided to Georgia Tech will be handled complying with the PIPL and any other applicable laws. 
所有提供给佐治亚理工的个人信息将按照《个保法》以及其他适用的法律进行处理。

5) Personal information will be handled and processed only by the persons who are responsible for the necessary activities for the purpose above, and will be transmitted from the PRC to the United States of America.  Georgia Tech is a unit of the Board of Regents of the University System of Georgia (the “BOR”), and personal information is shared with the BOR, its employees, the Office for Human Research Protections and other funding agencies or sponsors.
个人信息将仅有负责上述目的的必要活动的人员处理，且将自中国跨境提供至美国。佐治亚理工是佐治亚大学系统董事会（“董事会”）成员之一，个人信息将在董事会、董事会的员工、人类研究保护办公室以及其他资助机构或赞助人之间共享。

6) Refusal of consent may make it impossible for Georgia Tech to carry out its necessary activities for the purpose above, and may preclude Georgia Tech’s ability to provide requested participation in a research study. 
拒绝同意可能使得佐治亚理工无法为上述目的开展必要的活动，亦可能妨碍佐治亚理工提供参与研究的能力。

7)  You have the right to withdraw your consent to the collection and processing of your personal information.  If you would like to withdraw consent, please contact Duen Horng Chau at polo@gatech.edu.
您有权撤回收集并处理您个人信息的同意。若您想撤回同意，请联系 Duen Horng Chau (polo@gatech.edu)。

8) Georgia Tech is committed to ensuring the security of your personal information. We have put in place reasonable physical, technical, and administrative safeguards designed to prevent unauthorized access to your information. 
佐治亚理工承诺确保您个人信息的安全。我们已采取合理的物理、技术和行政措施，旨在防止任何未经授权访问您的个人信息。

9) Georgia Tech has a PIPL Privacy Notice which includes your individual rights concerning your personal information. Please see the PIPL Compliance Notice here: https://www.gatech.edu/privacy
佐治亚理工已制定《个保法》隐私声明，其涵盖了与您个人信息有关的所有个人权利。关于《个保法》隐私声明，请访问下述网址：https://www.gatech.edu/privacy
`,Fv=`@keyframes fade-in{0%{opacity:0}to{opacity:1}}.confirm-dialog{--padding-v: 18px;--padding-h: 20px;display:none;flex-direction:column;justify-content:flex-start;align-items:flex-start;max-width:720px;max-height:min(800px,95vh);box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f;padding:0;border:none}.confirm-dialog[open]{border-radius:8px;border:none;display:flex;flex-direction:column;align-items:center;gap:0;padding:0;pointer-events:all}.confirm-dialog[open]::backdrop{background-color:#0000008c;animation:fade-in .3s}.header{padding:var(--padding-v) var(--padding-h) 0px var(--padding-h);margin:0;line-height:1;font-size:var(--font-u3);width:100%;display:flex;flex-flow:row;align-items:center;box-sizing:border-box}.separator{display:flex;width:calc(100% - 40px);height:3px;border-radius:5px;background-color:var(--gray-200)}.content{display:flex;flex-flow:column;padding:16px var(--padding-h);flex:1 1 auto;min-height:0px}.content .message{margin-bottom:12px}.content .skip-bar{color:var(--gray-800)}.content p{margin:5px 0}.content p:first-child{margin-top:0}.content p:last-child{margin-bottom:0}.button-block{display:flex;flex-direction:row;justify-content:flex-end;box-sizing:border-box;gap:10px;width:100%;margin-top:10px;padding:0px var(--padding-h) var(--padding-v) var(--padding-h);a {color: currentColor; font-style: normal; text-decoration: none;}}.button-block button{all:unset;cursor:pointer;background-color:var(--gray-200);padding:3px 8px;border-radius:8px;display:flex;flex-grow:0;transition:background-color .15s ease-in-out}.button-block button:hover{background-color:var(--gray-300)}.button-block button:active{background-color:var(--gray-400)}.accordion-container{display:flex;flex-direction:column;--inner-padding: 5px;border-top:1px solid var(--gray-200);padding-top:5px;gap:5px;min-height:0px}.accordion-container .accordion-header{padding:3px var(--inner-padding);display:flex;flex-direction:row;justify-content:space-between;align-items:center;cursor:pointer;border-radius:5px;background-color:var(--gray-100)}.accordion-container .accordion-header:hover{background-color:var(--gray-200)}.accordion-container .accordion-header:active{background-color:var(--gray-300)}.accordion-container .accordion-header .arrow-icon{color:var(--gray-600);width:16px;height:16px;transform:rotate(180deg);transition:transform .1s}.accordion-container .accordion-content{border-radius:5px;border:1px solid var(--gray-200);padding-top:5px;font-size:12px;max-height:200px;padding:1px var(--inner-padding);white-space:pre-line;overflow-y:auto}.accordion-container[hide-content]{padding-bottom:8px}.accordion-container[hide-content] .accordion-header{background-color:#fff}.accordion-container[hide-content] .accordion-header:hover{background-color:var(--gray-200)}.accordion-container[hide-content] .accordion-header:active{background-color:var(--gray-300)}.accordion-container[hide-content] .accordion-content{display:none}.accordion-container[hide-content] .arrow-icon{transform:rotate(0)}
`;var Pv=Object.defineProperty,Av=Object.getOwnPropertyDescriptor,si=(n,e,t,r)=>{for(var o=r>1?void 0:r?Av(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&Pv(e,t,o),o};let rr=class extends Q{constructor(){super(),this.showGDPR=!1,this.showPRC=!1,this.initData=async()=>{},this.confirmAction=()=>{}}firstUpdated(){window.setTimeout(()=>{},1e3)}willUpdate(n){}show(n){this.confirmAction=n,this.dialogElement&&this.dialogElement.showModal()}dialogClicked(n){n.target===this.dialogElement&&this.dialogElement.close()}cancelClicked(n){n.stopPropagation(),this.dialogElement&&this.dialogElement.close()}confirmClicked(n){n.stopPropagation(),this.dialogElement&&(localStorage.setItem("has-confirmed-privacy","true"),this.confirmAction(),this.dialogElement.close())}render(){return M`
      <dialog
        class="confirm-dialog"
        @click=${n=>this.dialogClicked(n)}
      >
        <div class="header">
          <div class="header-name">Usage Data Collection Acknowledgement</div>
        </div>

        <div class="content">
          <div class="message">
            <p>
              You are being asked to be a volunteer in a research study. The
              purpose of this study is to understand user interaction patterns
              and preferences when using large language models.
            </p>
            <p>
              <strong
                >When you use this web app to run or share a prompt, the prompt
                prefix, timestamp, and AI model configurations (e.g.,
                temperature) will be collected. We <u>DO NOT</u> collect your
                input text or any sensitive data (e.g., username, email address,
                IP address, location). Please do not include personal
                information in the prompt prefix.</strong
              >
            </p>
            <p>
              The risks involved are no greater than those involved in daily
              activities. You will not benefit or be compensated for joining
              this study. We will comply with any applicable laws and
              regulations regarding confidentiality. To make sure that this
              research is being carried out in the proper way, the Georgia
              Institute of Technology IRB may review study records. The Office
              of Human Research Protections may also look at study records. If
              you have any questions about the study, you may contact the PI at
              email polo@gatech.edu. If you have any questions about your rights
              as a research subject, you may contact Georgia Institute of
              Technology Office of Research Integrity Assurance at
              IRB@gatech.edu. Thank you for participating in this study! By
              proceeding to use this web app, you indicate your consent to be in
              the study.
            </p>
          </div>

          <div class="accordion-container" ?hide-content=${!this.showGDPR}>
            <div
              class="accordion-header"
              @click=${()=>{this.showGDPR=!this.showGDPR,this.showGDPR&&(this.showPRC=!1)}}
            >
              <div class="name">
                General Data Protection Regulation (GDPR) Consent
              </div>
              <span class="svg-icon arrow-icon">${H(Io)}</span>
            </div>

            <div class="accordion-content">${Tv}</div>
          </div>

          <div class="accordion-container" ?hide-content=${!this.showPRC}>
            <div
              class="accordion-header"
              @click=${()=>{this.showPRC=!this.showPRC,this.showPRC&&(this.showGDPR=!1)}}
            >
              <div class="name">
                Republic of China (PRC) Personal Information Protection Law
                Consent
              </div>
              <span class="svg-icon arrow-icon">${H(Io)}</span>
            </div>

            <div class="accordion-content">${Sv}</div>
          </div>
        </div>

        <div class="button-block">
          <button
            class="cancel-button"
            @click=${n=>this.cancelClicked(n)}
          >
            Cancel
          </button>
          <button
            class="confirm-button"
            @click=${n=>this.confirmClicked(n)}
          >
            Agree
          </button>
        </div>
      </dialog>
    `}};rr.styles=[be`
      ${oe(Fv)}
    `];si([Y("dialog")],rr.prototype,"dialogElement",2);si([I()],rr.prototype,"showGDPR",2);si([I()],rr.prototype,"showPRC",2);rr=si([ve("wordflow-privacy-dialog")],rr);const Ov=`.wordflow{width:100%;min-height:100%;position:relative;display:flex;flex-direction:row;justify-content:center;align-items:stretch;display:grid;grid-template-columns:minmax(108px,1fr) minmax(300px,70ch) minmax(50px,1fr);grid-template-rows:auto;box-sizing:border-box;overscroll-behavior:none;background-color:var(--gray-100)}.svg-icon{display:flex;justify-content:center;align-items:center;width:1em;height:1em;color:currentColor;transition:transform 80ms linear;transform-origin:center}.svg-icon svg{fill:currentColor;width:100%;height:100%}.left-panel{display:flex;grid-row:1 / 2;grid-column:1 / 2;position:relative;z-index:1}.left-panel .left-padding{flex:1 1 auto;min-width:4px}.left-panel .right-padding{flex:0 1 12px;min-width:3px}.right-panel{display:flex;flex-flow:column;grid-row:1 / 2;grid-column:3 / 4;position:relative;z-index:1}.right-panel .top-padding{flex:1 1 auto}.center-panel{display:flex;grid-row:1 / 2;grid-column:2 / 3;width:100%;height:100%;border-left:1px solid var(--gray-300);background:white;border-right:1px solid var(--gray-300);position:relative;box-sizing:border-box}.footer-info{position:sticky;bottom:6px;margin-left:6px;box-sizing:border-box;display:flex;flex-flow:column;font-size:var(--font-d4);color:var(--gray-500);line-height:1.2}.footer-info a{color:currentColor;text-decoration:none}.footer-info .row{cursor:pointer}.footer-info .row:hover{text-decoration:underline}.logo-container{position:sticky;top:0;grid-row:1 / 2;grid-column:2 / 3;width:100%;height:max-content;background-color:#fff;z-index:2;box-sizing:border-box}.logo-container .center{display:flex;width:100%;height:100%;padding:8px 24px;border-left:1px solid var(--gray-300);border-right:1px solid var(--gray-300);position:relative;box-sizing:border-box}.logo-container a{color:unset;text-decoration:none}.logo-container .row{grid-row:1 / 2;grid-column:2 / 3;background-color:#fff;display:flex;flex-flow:row;align-items:center;font-size:var(--font-u3);gap:3px}.logo-container .row .svg-icon{opacity:.7;filter:grayscale(1);-webkit-transform:translateZ(0);transition:filter .1s,opacity .1s}.logo-container .row .name{color:var(--gray-500);font-weight:600;transition:color .1s}.logo-container .row:hover .svg-icon{opacity:1;filter:grayscale(0)}.logo-container .row:hover .name{color:#0c336a}.editor-content{display:flex;width:100%;height:100%}.editor-content wordflow-text-editor{width:100%;height:100%}.popper-box{flex:0 1 250px;height:max-content;z-index:3;box-shadow:0 0 1px #0009,0 0 3px #0000000d;border-radius:4px;font-size:$font-d3;display:flex;justify-content:center;box-sizing:border-box;transform:translateY(-50%);opacity:1;transition:opacity .15s,transform .15s}.popper-box.hidden{opacity:0;cursor:default}wordflow-sidebar-menu{width:100%}.floating-menu-box{z-index:2;grid-row:1 / 2;grid-column:2 / 3;display:flex;justify-content:center;box-sizing:border-box;width:max-content;height:max-content;margin-left:100%;transform:translate(-50%,-50%);opacity:1;transition:opacity .15s,transform .15s}.floating-menu-box.hidden{opacity:0}.popper-tooltip{position:absolute;width:max-content;left:0;top:0;z-index:20;background:var(--gray-800);color:#fff;box-shadow:0 0 1px #0009,0 0 3px #0000000d;padding:0 5px 3px;border-radius:4px;font-size:var(--font-d3);display:flex;justify-content:center;box-sizing:border-box;pointer-events:none;text-align:center;opacity:1;transform:scale(1);transform-origin:left center;transition:opacity .15s,transform .15s}.popper-tooltip.hidden{opacity:0;transform:scale(.8)}.popper-tooltip .popper-content{max-width:300px;max-height:200px;line-height:1.5;overflow:hidden;display:flex;user-select:none;-webkit-user-select:none}.popper-tooltip .popper-arrow{position:absolute;background:var(--gray-800);width:8px;height:8px;transform:rotate(45deg);opacity:1}.popper-tooltip .popper-arrow.hidden{opacity:0}wordflow-setting-window{display:flex;z-index:3;transition:opacity .1s;opacity:1}wordflow-setting-window[is-hidden]{opacity:0;pointer-events:none}.toast-container{position:absolute;top:7px;z-index:5;width:100%;display:flex;justify-content:center;nightjar-toast {max-width: 300px;}}
`,Iv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 114 90" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g id="wordflow-logo">
        <path d="M94.555,8.5L94.555,81.5C94.555,85.915 90.97,89.5 86.555,89.5L34.378,89.5C29.963,89.5 26.378,85.915 26.378,81.5L26.378,8.5C26.378,4.085 29.963,0.5 34.378,0.5L86.555,0.5C90.97,0.5 94.555,4.085 94.555,8.5Z" style="fill:url(#_Linear1);"/>
        <path d="M0.567,25.768C0.251,19.851 13.409,17.006 14.555,25.106C14.979,28.104 15.561,37.483 15.851,39.704C16.132,41.858 16.851,56.926 21.64,56.926C25.859,56.926 28.267,51.738 29.76,49.04C34.75,40.019 40.013,27.924 51.327,25.768C64.516,23.255 71.596,31.131 72,42.704C72.202,48.491 72,55.312 75.845,55.961C80.217,56.699 83.201,52.725 85.711,49.994C92.412,42.704 100.66,30.342 112.486,34.164C113.642,34.538 114.564,36.228 113.351,36.483C111.825,36.805 109.9,37.488 108.533,38.183C105.441,39.757 102.894,42.226 100.66,44.84C93.886,52.765 86.119,72.033 73.415,71.121C63.196,70.387 60.229,57.276 59.505,48.969C59.201,45.475 59.744,38.258 54.582,38.697C49.774,39.105 46.626,47.084 44.801,50.592C39.402,60.967 32.031,77.765 18.466,73.098C5.642,68.687 5.623,54.796 2.631,42.704C1.934,39.885 0.731,28.834 0.567,25.768Z" style="fill:rgb(14,48,100);fill-rule:nonzero;"/>
    </g>
    <defs>
        <linearGradient id="_Linear1" x1="0" y1="0" x2="1" y2="0" gradientUnits="userSpaceOnUse" gradientTransform="matrix(4.18393e-15,89,-68.3288,5.44968e-15,60.4668,0.5)"><stop offset="0" style="stop-color:rgb(44,223,251);stop-opacity:0.8"/><stop offset="0.13" style="stop-color:rgb(24,215,244);stop-opacity:0.7"/><stop offset="1" style="stop-color:rgb(114,167,214);stop-opacity:0.8"/></linearGradient>
    </defs>
</svg>
`,$v=[{prompt:"Generate a clever joke that playfully combines wordplay, a surprising twist, and relatable humor.",tags:[],temperature:.2,userID:"13e5deed-1f15-47fe-aea8-29da794be6fe",userName:"",description:"",icon:"😂",forkFrom:"",promptRunCount:0,created:"",title:"Joke Generator",outputParsingPattern:"",outputParsingReplacement:"",recommendedModels:[],injectionMode:"append",key:""},{prompt:`Translate the text in <input></input> from English to Japanese. Your output should be put in <output></output>.

<input>{{text}}</input>`,tags:[],temperature:.2,userID:"13e5deed-1f15-47fe-aea8-29da794be6fe",userName:"",description:"",icon:"🇯🇵",forkFrom:"",promptRunCount:0,created:"",title:"Translate English to Japanese",outputParsingPattern:".*<output>(.*)</output>.*",outputParsingReplacement:"$1",recommendedModels:[],injectionMode:"replace",key:""},{prompt:`You are an experienced writer and researcher. Please help me revise my draft of an academic paper. I will send you a paragraph of LaTeX text (in <input></input>), and please make the LaTeX text grammatically correct, easy to read, and formal.

The style should be appropriate for academic research papers. Please use active voice. Please do not add new content. Keep the text in a similar length. Please do not add new content.

Put the revised text in XML format in the <output></output> tag.

<input>{{text}}</input>`,tags:[],temperature:.2,userID:"13e5deed-1f15-47fe-aea8-29da794be6fe",userName:"",description:"",icon:"🎓",forkFrom:"",promptRunCount:0,created:"",title:"Improve Academic Writing",outputParsingPattern:".*<output>(.*)</output>.*",outputParsingReplacement:"$1",recommendedModels:[],injectionMode:"replace",key:""},{prompt:"You are a great writer. Improve the flow of the following text.",tags:[],temperature:.2,userID:"13e5deed-1f15-47fe-aea8-29da794be6fe",userName:"",description:"",icon:"✍️",forkFrom:"",promptRunCount:0,created:"",title:"Improve Text Flow",outputParsingPattern:"",outputParsingReplacement:"",recommendedModels:[],injectionMode:"replace",key:""}],Nv="wordflow",Lv="0.1.2",Rv="module",Bv={dev:"vite --port 3000",build:"tsc && vite build","build:github":"tsc && vite build --mode github","deploy:github":`pnpm run build:github && pnpm gh-pages -m "Deploy $(git log '--format=format:%H' main -1)" -d ./dist`,"deploy:vercel":"pnpm run build && cp -r .vercel ./dist/ && vercel ./dist",preview:"vite preview"},_v={lit:"^3.0.0"},zv={"@floating-ui/dom":"^1.5.3","@tiptap/core":"^2.1.12","@tiptap/extension-bubble-menu":"^2.1.12","@tiptap/extension-document":"^2.1.12","@tiptap/extension-highlight":"^2.1.12","@tiptap/extension-paragraph":"^2.1.12","@tiptap/extension-placeholder":"^2.1.13","@tiptap/extension-text":"^2.1.12","@tiptap/pm":"^2.1.12","@tiptap/starter-kit":"^2.1.12","@types/d3-format":"^3.0.4","@types/d3-time-format":"^4.0.3","@types/diff":"^5.0.7","@types/diff-match-patch":"^1.0.35","@types/emoji-regex":"^9.2.0","@types/uuid":"^9.0.7","@typescript-eslint/eslint-plugin":"^6.9.0","@xiaohk/utils":"^0.0.6","d3-format":"^3.1.0","d3-time-format":"^4.1.0",diff:"^5.1.0","diff-match-patch":"^1.0.5","emoji-regex":"^10.3.0",eslint:"^8.52.0","eslint-config-prettier":"^9.0.0","eslint-plugin-lit":"^1.10.1","eslint-plugin-prettier":"^5.0.1","eslint-plugin-wc":"^2.0.4","gh-pages":"^6.0.0","idb-keyval":"^6.2.1",prettier:"^3.0.3","tippy.js":"^6.3.7",typescript:"^5.2.2",uuid:"^9.0.1",vite:"^4.5.0","vite-plugin-dts":"^3.6.1","vite-plugin-web-components-hmr":"^0.1.3"},Hv={name:Nv,private:!1,version:Lv,type:Rv,scripts:Bv,dependencies:_v,devDependencies:zv};var jv=Object.defineProperty,Uv=Object.getOwnPropertyDescriptor,ee=(n,e,t,r)=>{for(var o=r>1?void 0:r?Uv(e,t):e,i=n.length-1,s;i>=0;i--)(s=n[i])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&jv(e,t,o),o};const tc=$v,nc=Ue.layout.sidebarMenuXOffset;let J=class extends Q{constructor(){super(),this.showSettingWindow=!1,this.loadingActionIndex=null,this.favPrompts=[null,null,null],this.localPrompts=[],this.remotePrompts=[],this.popularTags=[],this.toastMessage="",this.toastType="success",this.lastUpdateSidebarMenuProps=null,this.initData=async()=>{},this.updateSidebarMenu=async({anchor:i,boxPosition:s,editor:a,mode:l,oldText:c,newText:u,summaryCounter:d})=>{if(this.centerPanelElement===void 0||this.popperSidebarBox===void 0){console.error("centerPanelElement is undefined");return}const p=await this.popperSidebarBox,h=p.querySelector("wordflow-sidebar-menu");l&&(h.mode=l),c&&(h.oldText=c),u&&(h.newText=u),d?h.summaryCounter=d:h.summaryCounter=null,this.lastUpdateSidebarMenuProps={anchor:i,boxPosition:s,editor:a,mode:h.mode,oldText:h.oldText,newText:h.newText,summaryCounter:h.summaryCounter};const{view:f}=a,m=f.state.selection.$from,g=f.coordsAtPos(m.pos);await new Promise(z=>{setTimeout(z,0)});const y=p.getBoundingClientRect(),b=window.innerHeight,v=window.scrollY,k=parseInt(window.getComputedStyle(a.options.element).lineHeight),x=5,C=v+y.height/2+x,A=b+v-y.height/2-x,$=g.top+v+k/2,E=Math.min(A,Math.max(C,$));p.style.marginTop=`${E}px`},this.initUserID();const n=i=>{this.localPrompts=i},e=i=>{this.favPrompts=i};this.promptManager=new tp(n,e);const t=i=>{this.remotePrompts=i},r=i=>{this.popularTags=i};this.remotePromptManager=new rp(t,r),this.initDefaultPrompts();const o=i=>{this.userConfig=i};this.userConfigManager=new op(o)}firstUpdated(){if(this.workflowElement===void 0)throw Error("workflowElement undefined.")}willUpdate(n){}initUserID(){const n=localStorage.getItem("user-id");if(n===null){const e=mn();return localStorage.setItem("user-id",e),e}else return n}initDefaultPrompts(){let n=localStorage.getItem("user-id");if(n===null&&(console.warn("userID is null"),n=this.initUserID()),localStorage.getItem("has-added-default-prompts")===null){for(const[t,r]of tc.entries())r.key=mn(),r.userID=n,r.created=new Date().toISOString(),this.promptManager.addPrompt(r);for(const[t,r]of tc.reverse().slice(0,3).entries())this.promptManager.setFavPrompt(t,r);localStorage.setItem("has-added-default-prompts","true")}}async updateSidebarMenuXPos(n){if(this.centerPanelElement===void 0||this.popperSidebarBox===void 0){console.error("centerPanelElement is undefined");return}const e=await this.popperSidebarBox,t=this.centerPanelElement.getBoundingClientRect(),r=e.querySelector("wordflow-sidebar-menu");if(n==="left"){r.isOnLeft=!0;const o=e.offsetParent.getBoundingClientRect();e.style.left="unset",e.style.right=`${o.width-t.x+nc}px`}else r.isOnLeft=!1,e.style.right="unset",e.style.left=`${t.x+t.width+nc}px`}sidebarMenuFooterButtonClickedHandler(n){this.textEditorElement&&this.textEditorElement.sidebarMenuFooterButtonClickedHandler(n)}floatingMenuToolMouseEnterHandler(){this.textEditorElement&&this.textEditorElement.floatingMenuToolsMouseEnterHandler()}floatingMenuToolsMouseLeaveHandler(){this.textEditorElement&&this.textEditorElement.floatingMenuToolsMouseLeaveHandler()}floatingMenuToolButtonClickHandler(n){if(this.workflowElement===void 0)throw Error("workflowElement is undefined");const e=()=>{if(!this.textEditorElement)return;const[r,o]=n.detail;this.textEditorElement.floatingMenuToolButtonClickHandler(r),this.loadingActionIndex=o};if(localStorage.getItem("has-confirmed-privacy")==="true")e();else{if(!this.privacyDialogComponent)throw Error("privacyDialogComponent is null");this.privacyDialogComponent.show(e)}}textEditorLoadingFinishedHandler(){this.loadingActionIndex=null}promptEditorShareClicked(n){if(!this.toastComponent)throw Error("Toast is undefined.");const e=n.detail.data,t=n.detail.stopLoader,r=()=>{this.remotePromptManager.sharePrompt(e).then(i=>{t(i)})};if(localStorage.getItem("has-confirmed-privacy")==="true")r();else{if(!this.privacyDialogComponent)throw Error("privacyDialogComponent is null");this.privacyDialogComponent.show(r)}}render(){return M`
      <div class="wordflow">
        <div class="toast-container">
          <nightjar-toast
            id="toast-wordflow"
            message=${this.toastMessage}
            type=${this.toastType}
          ></nightjar-toast>
        </div>

        <div class="left-panel">
          <div class="left-padding"></div>
          <div
            class="popper-box popper-sidebar-menu hidden"
            id="popper-sidebar-box"
          >
            <wordflow-sidebar-menu
              id="right-sidebar-menu"
              @footer-button-clicked=${n=>this.sidebarMenuFooterButtonClickedHandler(n)}
            ></wordflow-sidebar-menu>
          </div>
          <div class="right-padding"></div>
        </div>

        <div class="logo-container">
          <div class="center">
            <a
              class="row"
              href="https://github.com/poloclub/wordflow"
              target="_blank"
            >
              <span class="svg-icon">${H(Iv)}</span>
              <span class="name">Wordflow</span>
            </a>
          </div>
        </div>

        <div class="center-panel">
          <div class="editor-content">
            <wordflow-text-editor
              .popperSidebarBox=${this.popperSidebarBox}
              .floatingMenuBox=${this.floatingMenuBox}
              .updateSidebarMenu=${this.updateSidebarMenu}
              .promptManager=${this.promptManager}
              .userConfig=${this.userConfig}
              @loading-finished=${()=>this.textEditorLoadingFinishedHandler()}
              @show-toast=${n=>{var e;this.toastMessage=n.detail.message,this.toastType=n.detail.type,(e=this.toastComponent)==null||e.show()}}
            ></wordflow-text-editor>
          </div>
        </div>

        <div class="right-panel">
          <div class="top-padding"></div>
          <div class="footer-info">
            <a
              class="row"
              href="https://github.com/poloclub/wordflow"
              target="_blank"
              >Version (${Hv.version})</a
            >
            <div
              class="row"
              @click=${()=>{var n;(n=this.privacyDialogComponent)==null||n.show(()=>{})}}
            >
              Privacy
            </div>
            <a
              class="row"
              href="https://github.com/poloclub/wordflow/issues/new"
              target="_blank"
              >Report an issue</a
            >
          </div>
        </div>

        <div class="floating-menu-box hidden" id="floating-menu-box">
          <wordflow-floating-menu
            .popperTooltip=${this.popperTooltip}
            .loadingActionIndex=${this.loadingActionIndex}
            .favPrompts=${this.favPrompts}
            @mouse-enter-tools=${()=>this.floatingMenuToolMouseEnterHandler()}
            @mouse-leave-tools=${()=>this.floatingMenuToolsMouseLeaveHandler()}
            @tool-button-clicked=${n=>this.floatingMenuToolButtonClickHandler(n)}
            @setting-button-clicked=${()=>{this.showSettingWindow=!0}}
          ></wordflow-floating-menu>
        </div>

        <wordflow-setting-window
          ?is-hidden=${!this.showSettingWindow}
          .promptManager=${this.promptManager}
          .localPrompts=${this.localPrompts}
          .favPrompts=${this.favPrompts}
          .remotePromptManager=${this.remotePromptManager}
          .remotePrompts=${this.remotePrompts}
          .popularTags=${this.popularTags}
          .userConfigManager=${this.userConfigManager}
          .userConfig=${this.userConfig}
          @close-button-clicked=${()=>{this.showSettingWindow=!1}}
          @share-clicked=${n=>this.promptEditorShareClicked(n)}
        ></wordflow-setting-window>

        <wordflow-privacy-dialog></wordflow-privacy-dialog>

        <div id="popper-tooltip" class="popper-tooltip hidden" role="tooltip">
          <span class="popper-content"></span>
          <div class="popper-arrow"></div>
        </div>
      </div>
    `}};J.styles=[be`
      ${oe(Ov)}
    `];ee([Lo("#popper-sidebar-box")],J.prototype,"popperSidebarBox",2);ee([Lo("#floating-menu-box")],J.prototype,"floatingMenuBox",2);ee([Lo("#popper-tooltip")],J.prototype,"popperTooltip",2);ee([Y("wordflow-text-editor")],J.prototype,"textEditorElement",2);ee([Y(".center-panel")],J.prototype,"centerPanelElement",2);ee([Y(".wordflow")],J.prototype,"workflowElement",2);ee([I()],J.prototype,"showSettingWindow",2);ee([I()],J.prototype,"loadingActionIndex",2);ee([I()],J.prototype,"promptManager",2);ee([I()],J.prototype,"favPrompts",2);ee([I()],J.prototype,"localPrompts",2);ee([I()],J.prototype,"remotePromptManager",2);ee([I()],J.prototype,"remotePrompts",2);ee([I()],J.prototype,"popularTags",2);ee([I()],J.prototype,"userConfigManager",2);ee([I()],J.prototype,"userConfig",2);ee([I()],J.prototype,"toastMessage",2);ee([I()],J.prototype,"toastType",2);ee([Y("nightjar-toast#toast-wordflow")],J.prototype,"toastComponent",2);ee([Y("wordflow-privacy-dialog")],J.prototype,"privacyDialogComponent",2);J=ee([ve("wordflow-wordflow")],J);
